{"ast":null,"code":"import React, { createContext, memo, useEffect, useLayoutEffect, useState, useCallback, useMemo, isValidElement, cloneElement, useContext, forwardRef, useRef, useImperativeHandle, Fragment as Fragment$1 } from 'react';\nimport { jsx, jsxs, Fragment } from 'react/jsx-runtime';\n\n/**\n * Create the React Context\n */\n\nconst DndContext = /*#__PURE__*/createContext({\n  dragDropManager: undefined\n});\n\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\n\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n} // Inlined version of the `symbol-observable` polyfill\n\nvar $$observable = function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\n\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\n\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n  return Object.getPrototypeOf(obj) === proto;\n} // Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\n\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n  return typeOfVal;\n}\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n    var listeners = currentListeners = nextListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n  function observable() {\n    var _ref;\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\n\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n}\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\nfunction invariant(condition, format, ...args) {\n  if (isProduction()) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n  if (!condition) {\n    let error;\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      let argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n    error.framesToPop = 1 // we don't care about invariant's own frame\n    ;\n    throw error;\n  }\n}\nfunction isProduction() {\n  return typeof process !== 'undefined' && process.env['NODE_ENV'] === 'production';\n}\n\n// cheap lodash replacements\n\n/**\n * drop-in replacement for _.get\n * @param obj\n * @param path\n * @param defaultValue\n */\nfunction get(obj, path, defaultValue) {\n  return path.split('.').reduce((a, c) => a && a[c] ? a[c] : defaultValue || null, obj);\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without$1(items, item) {\n  return items.filter(i => i !== item);\n}\n/**\n * drop-in replacement for _.isString\n * @param input\n */\n\nfunction isObject(input) {\n  return typeof input === 'object';\n}\n/**\n * replacement for _.xor\n * @param itemsA\n * @param itemsB\n */\n\nfunction xor(itemsA, itemsB) {\n  const map = new Map();\n  const insertItem = item => {\n    map.set(item, map.has(item) ? map.get(item) + 1 : 1);\n  };\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  map.forEach((count, key) => {\n    if (count === 1) {\n      result.push(key);\n    }\n  });\n  return result;\n}\n/**\n * replacement for _.intersection\n * @param itemsA\n * @param itemsB\n */\n\nfunction intersection(itemsA, itemsB) {\n  return itemsA.filter(t => itemsB.indexOf(t) > -1);\n}\nconst INIT_COORDS = 'dnd-core/INIT_COORDS';\nconst BEGIN_DRAG = 'dnd-core/BEGIN_DRAG';\nconst PUBLISH_DRAG_SOURCE = 'dnd-core/PUBLISH_DRAG_SOURCE';\nconst HOVER = 'dnd-core/HOVER';\nconst DROP = 'dnd-core/DROP';\nconst END_DRAG = 'dnd-core/END_DRAG';\nfunction setClientOffset(clientOffset, sourceClientOffset) {\n  return {\n    type: INIT_COORDS,\n    payload: {\n      sourceClientOffset: sourceClientOffset || null,\n      clientOffset: clientOffset || null\n    }\n  };\n}\nconst ResetCoordinatesAction = {\n  type: INIT_COORDS,\n  payload: {\n    clientOffset: null,\n    sourceClientOffset: null\n  }\n};\nfunction createBeginDrag(manager) {\n  return function beginDrag(sourceIds = [], options = {\n    publishSource: true\n  }) {\n    const {\n      publishSource = true,\n      clientOffset,\n      getSourceClientOffset\n    } = options;\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry(); // Initialize the coordinates using the client offset\n\n    manager.dispatch(setClientOffset(clientOffset));\n    verifyInvariants$1(sourceIds, monitor, registry); // Get the draggable source\n\n    const sourceId = getDraggableSource(sourceIds, monitor);\n    if (sourceId == null) {\n      manager.dispatch(ResetCoordinatesAction);\n      return;\n    } // Get the source client offset\n\n    let sourceClientOffset = null;\n    if (clientOffset) {\n      if (!getSourceClientOffset) {\n        throw new Error('getSourceClientOffset must be defined');\n      }\n      verifyGetSourceClientOffsetIsFunction(getSourceClientOffset);\n      sourceClientOffset = getSourceClientOffset(sourceId);\n    } // Initialize the full coordinates\n\n    manager.dispatch(setClientOffset(clientOffset, sourceClientOffset));\n    const source = registry.getSource(sourceId);\n    const item = source.beginDrag(monitor, sourceId); // If source.beginDrag returns null, this is an indicator to cancel the drag\n\n    if (item == null) {\n      return undefined;\n    }\n    verifyItemIsObject(item);\n    registry.pinSource(sourceId);\n    const itemType = registry.getSourceType(sourceId);\n    return {\n      type: BEGIN_DRAG,\n      payload: {\n        itemType,\n        item,\n        sourceId,\n        clientOffset: clientOffset || null,\n        sourceClientOffset: sourceClientOffset || null,\n        isSourcePublic: !!publishSource\n      }\n    };\n  };\n}\nfunction verifyInvariants$1(sourceIds, monitor, registry) {\n  invariant(!monitor.isDragging(), 'Cannot call beginDrag while dragging.');\n  sourceIds.forEach(function (sourceId) {\n    invariant(registry.getSource(sourceId), 'Expected sourceIds to be registered.');\n  });\n}\nfunction verifyGetSourceClientOffsetIsFunction(getSourceClientOffset) {\n  invariant(typeof getSourceClientOffset === 'function', 'When clientOffset is provided, getSourceClientOffset must be a function.');\n}\nfunction verifyItemIsObject(item) {\n  invariant(isObject(item), 'Item must be an object.');\n}\nfunction getDraggableSource(sourceIds, monitor) {\n  let sourceId = null;\n  for (let i = sourceIds.length - 1; i >= 0; i--) {\n    if (monitor.canDragSource(sourceIds[i])) {\n      sourceId = sourceIds[i];\n      break;\n    }\n  }\n  return sourceId;\n}\nfunction _defineProperty$4(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _objectSpread$4(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty$4(target, key, source[key]);\n    });\n  }\n  return target;\n}\nfunction createDrop(manager) {\n  return function drop(options = {}) {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyInvariants(monitor);\n    const targetIds = getDroppableTargets(monitor); // Multiple actions are dispatched here, which is why this doesn't return an action\n\n    targetIds.forEach((targetId, index) => {\n      const dropResult = determineDropResult(targetId, index, registry, monitor);\n      const action = {\n        type: DROP,\n        payload: {\n          dropResult: _objectSpread$4({}, options, dropResult)\n        }\n      };\n      manager.dispatch(action);\n    });\n  };\n}\nfunction verifyInvariants(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call drop while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call drop twice during one drag operation.');\n}\nfunction determineDropResult(targetId, index, registry, monitor) {\n  const target = registry.getTarget(targetId);\n  let dropResult = target ? target.drop(monitor, targetId) : undefined;\n  verifyDropResultType(dropResult);\n  if (typeof dropResult === 'undefined') {\n    dropResult = index === 0 ? {} : monitor.getDropResult();\n  }\n  return dropResult;\n}\nfunction verifyDropResultType(dropResult) {\n  invariant(typeof dropResult === 'undefined' || isObject(dropResult), 'Drop result must either be an object or undefined.');\n}\nfunction getDroppableTargets(monitor) {\n  const targetIds = monitor.getTargetIds().filter(monitor.canDropOnTarget, monitor);\n  targetIds.reverse();\n  return targetIds;\n}\nfunction createEndDrag(manager) {\n  return function endDrag() {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyIsDragging(monitor);\n    const sourceId = monitor.getSourceId();\n    if (sourceId != null) {\n      const source = registry.getSource(sourceId, true);\n      source.endDrag(monitor, sourceId);\n      registry.unpinSource();\n    }\n    return {\n      type: END_DRAG\n    };\n  };\n}\nfunction verifyIsDragging(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call endDrag while not dragging.');\n}\nfunction matchesType(targetType, draggedItemType) {\n  if (draggedItemType === null) {\n    return targetType === null;\n  }\n  return Array.isArray(targetType) ? targetType.some(t => t === draggedItemType) : targetType === draggedItemType;\n}\nfunction createHover(manager) {\n  return function hover(targetIdsArg, {\n    clientOffset\n  } = {}) {\n    verifyTargetIdsIsArray(targetIdsArg);\n    const targetIds = targetIdsArg.slice(0);\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    const draggedItemType = monitor.getItemType();\n    removeNonMatchingTargetIds(targetIds, registry, draggedItemType);\n    checkInvariants(targetIds, monitor, registry);\n    hoverAllTargets(targetIds, monitor, registry);\n    return {\n      type: HOVER,\n      payload: {\n        targetIds,\n        clientOffset: clientOffset || null\n      }\n    };\n  };\n}\nfunction verifyTargetIdsIsArray(targetIdsArg) {\n  invariant(Array.isArray(targetIdsArg), 'Expected targetIds to be an array.');\n}\nfunction checkInvariants(targetIds, monitor, registry) {\n  invariant(monitor.isDragging(), 'Cannot call hover while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call hover after drop.');\n  for (let i = 0; i < targetIds.length; i++) {\n    const targetId = targetIds[i];\n    invariant(targetIds.lastIndexOf(targetId) === i, 'Expected targetIds to be unique in the passed array.');\n    const target = registry.getTarget(targetId);\n    invariant(target, 'Expected targetIds to be registered.');\n  }\n}\nfunction removeNonMatchingTargetIds(targetIds, registry, draggedItemType) {\n  // Remove those targetIds that don't match the targetType.  This\n  // fixes shallow isOver which would only be non-shallow because of\n  // non-matching targets.\n  for (let i = targetIds.length - 1; i >= 0; i--) {\n    const targetId = targetIds[i];\n    const targetType = registry.getTargetType(targetId);\n    if (!matchesType(targetType, draggedItemType)) {\n      targetIds.splice(i, 1);\n    }\n  }\n}\nfunction hoverAllTargets(targetIds, monitor, registry) {\n  // Finally call hover on all matching targets.\n  targetIds.forEach(function (targetId) {\n    const target = registry.getTarget(targetId);\n    target.hover(monitor, targetId);\n  });\n}\nfunction createPublishDragSource(manager) {\n  return function publishDragSource() {\n    const monitor = manager.getMonitor();\n    if (monitor.isDragging()) {\n      return {\n        type: PUBLISH_DRAG_SOURCE\n      };\n    }\n    return;\n  };\n}\nfunction createDragDropActions(manager) {\n  return {\n    beginDrag: createBeginDrag(manager),\n    publishDragSource: createPublishDragSource(manager),\n    hover: createHover(manager),\n    drop: createDrop(manager),\n    endDrag: createEndDrag(manager)\n  };\n}\nclass DragDropManagerImpl {\n  receiveBackend(backend) {\n    this.backend = backend;\n  }\n  getMonitor() {\n    return this.monitor;\n  }\n  getBackend() {\n    return this.backend;\n  }\n  getRegistry() {\n    return this.monitor.registry;\n  }\n  getActions() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    const manager = this;\n    const {\n      dispatch\n    } = this.store;\n    function bindActionCreator(actionCreator) {\n      return (...args) => {\n        const action = actionCreator.apply(manager, args);\n        if (typeof action !== 'undefined') {\n          dispatch(action);\n        }\n      };\n    }\n    const actions = createDragDropActions(this);\n    return Object.keys(actions).reduce((boundActions, key) => {\n      const action = actions[key];\n      boundActions[key] = bindActionCreator(action);\n      return boundActions;\n    }, {});\n  }\n  dispatch(action) {\n    this.store.dispatch(action);\n  }\n  constructor(store, monitor) {\n    this.isSetUp = false;\n    this.handleRefCountChange = () => {\n      const shouldSetUp = this.store.getState().refCount > 0;\n      if (this.backend) {\n        if (shouldSetUp && !this.isSetUp) {\n          this.backend.setup();\n          this.isSetUp = true;\n        } else if (!shouldSetUp && this.isSetUp) {\n          this.backend.teardown();\n          this.isSetUp = false;\n        }\n      }\n    };\n    this.store = store;\n    this.monitor = monitor;\n    store.subscribe(this.handleRefCountChange);\n  }\n}\n\n/**\n * Coordinate addition\n * @param a The first coordinate\n * @param b The second coordinate\n */\nfunction add(a, b) {\n  return {\n    x: a.x + b.x,\n    y: a.y + b.y\n  };\n}\n/**\n * Coordinate subtraction\n * @param a The first coordinate\n * @param b The second coordinate\n */\n\nfunction subtract(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n/**\n * Returns the cartesian distance of the drag source component's position, based on its position\n * at the time when the current drag operation has started, and the movement difference.\n *\n * Returns null if no item is being dragged.\n *\n * @param state The offset state to compute from\n */\n\nfunction getSourceClientOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset,\n    initialSourceClientOffset\n  } = state;\n  if (!clientOffset || !initialClientOffset || !initialSourceClientOffset) {\n    return null;\n  }\n  return subtract(add(clientOffset, initialSourceClientOffset), initialClientOffset);\n}\n/**\n * Determines the x,y offset between the client offset and the initial client offset\n *\n * @param state The offset state to compute from\n */\n\nfunction getDifferenceFromInitialOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset\n  } = state;\n  if (!clientOffset || !initialClientOffset) {\n    return null;\n  }\n  return subtract(clientOffset, initialClientOffset);\n}\nconst NONE = [];\nconst ALL = [];\nNONE.__IS_NONE__ = true;\nALL.__IS_ALL__ = true;\n/**\n * Determines if the given handler IDs are dirty or not.\n *\n * @param dirtyIds The set of dirty handler ids\n * @param handlerIds The set of handler ids to check\n */\n\nfunction areDirty(dirtyIds, handlerIds) {\n  if (dirtyIds === NONE) {\n    return false;\n  }\n  if (dirtyIds === ALL || typeof handlerIds === 'undefined') {\n    return true;\n  }\n  const commonIds = intersection(handlerIds, dirtyIds);\n  return commonIds.length > 0;\n}\nclass DragDropMonitorImpl {\n  subscribeToStateChange(listener, options = {}) {\n    const {\n      handlerIds\n    } = options;\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    invariant(typeof handlerIds === 'undefined' || Array.isArray(handlerIds), 'handlerIds, when specified, must be an array of strings.');\n    let prevStateId = this.store.getState().stateId;\n    const handleChange = () => {\n      const state = this.store.getState();\n      const currentStateId = state.stateId;\n      try {\n        const canSkipListener = currentStateId === prevStateId || currentStateId === prevStateId + 1 && !areDirty(state.dirtyHandlerIds, handlerIds);\n        if (!canSkipListener) {\n          listener();\n        }\n      } finally {\n        prevStateId = currentStateId;\n      }\n    };\n    return this.store.subscribe(handleChange);\n  }\n  subscribeToOffsetChange(listener) {\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    let previousState = this.store.getState().dragOffset;\n    const handleChange = () => {\n      const nextState = this.store.getState().dragOffset;\n      if (nextState === previousState) {\n        return;\n      }\n      previousState = nextState;\n      listener();\n    };\n    return this.store.subscribe(handleChange);\n  }\n  canDragSource(sourceId) {\n    if (!sourceId) {\n      return false;\n    }\n    const source = this.registry.getSource(sourceId);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n    if (this.isDragging()) {\n      return false;\n    }\n    return source.canDrag(this, sourceId);\n  }\n  canDropOnTarget(targetId) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n    const target = this.registry.getTarget(targetId);\n    invariant(target, `Expected to find a valid target. targetId=${targetId}`);\n    if (!this.isDragging() || this.didDrop()) {\n      return false;\n    }\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n    return matchesType(targetType, draggedItemType) && target.canDrop(this, targetId);\n  }\n  isDragging() {\n    return Boolean(this.getItemType());\n  }\n  isDraggingSource(sourceId) {\n    // undefined on initial render\n    if (!sourceId) {\n      return false;\n    }\n    const source = this.registry.getSource(sourceId, true);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n    if (!this.isDragging() || !this.isSourcePublic()) {\n      return false;\n    }\n    const sourceType = this.registry.getSourceType(sourceId);\n    const draggedItemType = this.getItemType();\n    if (sourceType !== draggedItemType) {\n      return false;\n    }\n    return source.isDragging(this, sourceId);\n  }\n  isOverTarget(targetId, options = {\n    shallow: false\n  }) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n    const {\n      shallow\n    } = options;\n    if (!this.isDragging()) {\n      return false;\n    }\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n    if (draggedItemType && !matchesType(targetType, draggedItemType)) {\n      return false;\n    }\n    const targetIds = this.getTargetIds();\n    if (!targetIds.length) {\n      return false;\n    }\n    const index = targetIds.indexOf(targetId);\n    if (shallow) {\n      return index === targetIds.length - 1;\n    } else {\n      return index > -1;\n    }\n  }\n  getItemType() {\n    return this.store.getState().dragOperation.itemType;\n  }\n  getItem() {\n    return this.store.getState().dragOperation.item;\n  }\n  getSourceId() {\n    return this.store.getState().dragOperation.sourceId;\n  }\n  getTargetIds() {\n    return this.store.getState().dragOperation.targetIds;\n  }\n  getDropResult() {\n    return this.store.getState().dragOperation.dropResult;\n  }\n  didDrop() {\n    return this.store.getState().dragOperation.didDrop;\n  }\n  isSourcePublic() {\n    return Boolean(this.store.getState().dragOperation.isSourcePublic);\n  }\n  getInitialClientOffset() {\n    return this.store.getState().dragOffset.initialClientOffset;\n  }\n  getInitialSourceClientOffset() {\n    return this.store.getState().dragOffset.initialSourceClientOffset;\n  }\n  getClientOffset() {\n    return this.store.getState().dragOffset.clientOffset;\n  }\n  getSourceClientOffset() {\n    return getSourceClientOffset(this.store.getState().dragOffset);\n  }\n  getDifferenceFromInitialOffset() {\n    return getDifferenceFromInitialOffset(this.store.getState().dragOffset);\n  }\n  constructor(store, registry) {\n    this.store = store;\n    this.registry = registry;\n  }\n}\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nconst scope = typeof global !== 'undefined' ? global : self;\nconst BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\nfunction makeRequestCallFromTimer(callback) {\n  return function requestCall() {\n    // We dispatch a timeout with a specified delay of 0 for engines that\n    // can reliably accommodate that request. This will usually be snapped\n    // to a 4 milisecond delay, but once we're flushing, there's no delay\n    // between events.\n    const timeoutHandle = setTimeout(handleTimer, 0); // However, since this timer gets frequently dropped in Firefox\n    // workers, we enlist an interval handle that will try to fire\n    // an event 20 times per second until it succeeds.\n\n    const intervalHandle = setInterval(handleTimer, 50);\n    function handleTimer() {\n      // Whichever timer succeeds will cancel both timers and\n      // execute the callback.\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      callback();\n    }\n  };\n} // To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\n\nfunction makeRequestCallFromMutationObserver(callback) {\n  let toggle = 1;\n  const observer = new BrowserMutationObserver(callback);\n  const node = document.createTextNode('');\n  observer.observe(node, {\n    characterData: true\n  });\n  return function requestCall() {\n    toggle = -toggle;\n    node.data = toggle;\n  };\n}\nconst makeRequestCall = typeof BrowserMutationObserver === 'function' ?\n// reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nmakeRequestCallFromMutationObserver :\n// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\nmakeRequestCallFromTimer;\n\n/* eslint-disable no-restricted-globals, @typescript-eslint/ban-ts-comment, @typescript-eslint/no-unused-vars, @typescript-eslint/no-non-null-assertion */\nclass AsapQueue {\n  // Use the fastest means possible to execute a task in its own turn, with\n  // priority over other events including IO, animation, reflow, and redraw\n  // events in browsers.\n  //\n  // An exception thrown by a task will permanently interrupt the processing of\n  // subsequent tasks. The higher level `asap` function ensures that if an\n  // exception is thrown by a task, that the task queue will continue flushing as\n  // soon as possible, but if you use `rawAsap` directly, you are responsible to\n  // either ensure that no exceptions are thrown from your task, or to manually\n  // call `rawAsap.requestFlush` if an exception is thrown.\n  enqueueTask(task) {\n    const {\n      queue: q,\n      requestFlush\n    } = this;\n    if (!q.length) {\n      requestFlush();\n      this.flushing = true;\n    } // Equivalent to push, but avoids a function call.\n\n    q[q.length] = task;\n  }\n  constructor() {\n    this.queue = []; // We queue errors to ensure they are thrown in right order (FIFO).\n    // Array-as-queue is good enough here, since we are just dealing with exceptions.\n\n    this.pendingErrors = []; // Once a flush has been requested, no further calls to `requestFlush` are\n    // necessary until the next `flush` completes.\n    // @ts-ignore\n\n    this.flushing = false; // The position of the next task to execute in the task queue. This is\n    // preserved between calls to `flush` so that it can be resumed if\n    // a task throws an exception.\n\n    this.index = 0; // If a task schedules additional tasks recursively, the task queue can grow\n    // unbounded. To prevent memory exhaustion, the task queue will periodically\n    // truncate already-completed tasks.\n\n    this.capacity = 1024; // The flush function processes all tasks that have been scheduled with\n    // `rawAsap` unless and until one of those tasks throws an exception.\n    // If a task throws an exception, `flush` ensures that its state will remain\n    // consistent and will resume where it left off when called again.\n    // However, `flush` does not make any arrangements to be called again if an\n    // exception is thrown.\n\n    this.flush = () => {\n      const {\n        queue: q\n      } = this;\n      while (this.index < q.length) {\n        const currentIndex = this.index; // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n\n        this.index++;\n        q[currentIndex].call(); // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n\n        if (this.index > this.capacity) {\n          // Manually shift all values starting at the index back to the\n          // beginning of the queue.\n          for (let scan = 0, newLength = q.length - this.index; scan < newLength; scan++) {\n            q[scan] = q[scan + this.index];\n          }\n          q.length -= this.index;\n          this.index = 0;\n        }\n      }\n      q.length = 0;\n      this.index = 0;\n      this.flushing = false;\n    }; // In a web browser, exceptions are not fatal. However, to avoid\n    // slowing down the queue of pending tasks, we rethrow the error in a\n    // lower priority turn.\n\n    this.registerPendingError = err => {\n      this.pendingErrors.push(err);\n      this.requestErrorThrow();\n    }; // `requestFlush` requests that the high priority event queue be flushed as\n    // soon as possible.\n    // This is useful to prevent an error thrown in a task from stalling the event\n    // queue if the exception handled by Node.js’s\n    // `process.on(\"uncaughtException\")` or by a domain.\n    // `requestFlush` is implemented using a strategy based on data collected from\n    // every available SauceLabs Selenium web driver worker at time of writing.\n    // https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n    this.requestFlush = makeRequestCall(this.flush);\n    this.requestErrorThrow = makeRequestCallFromTimer(() => {\n      // Throw first error\n      if (this.pendingErrors.length) {\n        throw this.pendingErrors.shift();\n      }\n    });\n  }\n} // The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// // its existence.\n// rawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n\n// `call`, just like a function.\nclass RawTask {\n  call() {\n    try {\n      this.task && this.task();\n    } catch (error) {\n      this.onError(error);\n    } finally {\n      this.task = null;\n      this.release(this);\n    }\n  }\n  constructor(onError, release) {\n    this.onError = onError;\n    this.release = release;\n    this.task = null;\n  }\n}\nclass TaskFactory {\n  create(task) {\n    const tasks = this.freeTasks;\n    const t1 = tasks.length ? tasks.pop() : new RawTask(this.onError, t => tasks[tasks.length] = t);\n    t1.task = task;\n    return t1;\n  }\n  constructor(onError) {\n    this.onError = onError;\n    this.freeTasks = [];\n  }\n}\nconst asapQueue = new AsapQueue();\nconst taskFactory = new TaskFactory(asapQueue.registerPendingError);\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\n\nfunction asap(task) {\n  asapQueue.enqueueTask(taskFactory.create(task));\n}\nconst ADD_SOURCE = 'dnd-core/ADD_SOURCE';\nconst ADD_TARGET = 'dnd-core/ADD_TARGET';\nconst REMOVE_SOURCE = 'dnd-core/REMOVE_SOURCE';\nconst REMOVE_TARGET = 'dnd-core/REMOVE_TARGET';\nfunction addSource(sourceId) {\n  return {\n    type: ADD_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction addTarget(targetId) {\n  return {\n    type: ADD_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\nfunction removeSource(sourceId) {\n  return {\n    type: REMOVE_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction removeTarget(targetId) {\n  return {\n    type: REMOVE_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\nfunction validateSourceContract(source) {\n  invariant(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n  invariant(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n  invariant(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\nfunction validateTargetContract(target) {\n  invariant(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n  invariant(typeof target.hover === 'function', 'Expected hover to be a function.');\n  invariant(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\nfunction validateType(type, allowArray) {\n  if (allowArray && Array.isArray(type)) {\n    type.forEach(t => validateType(t, false));\n    return;\n  }\n  invariant(typeof type === 'string' || typeof type === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\nvar HandlerRole;\n(function (HandlerRole) {\n  HandlerRole[\"SOURCE\"] = \"SOURCE\";\n  HandlerRole[\"TARGET\"] = \"TARGET\";\n})(HandlerRole || (HandlerRole = {}));\nlet nextUniqueId = 0;\nfunction getNextUniqueId() {\n  return nextUniqueId++;\n}\nfunction getNextHandlerId(role) {\n  const id = getNextUniqueId().toString();\n  switch (role) {\n    case HandlerRole.SOURCE:\n      return `S${id}`;\n    case HandlerRole.TARGET:\n      return `T${id}`;\n    default:\n      throw new Error(`Unknown Handler Role: ${role}`);\n  }\n}\nfunction parseRoleFromHandlerId(handlerId) {\n  switch (handlerId[0]) {\n    case 'S':\n      return HandlerRole.SOURCE;\n    case 'T':\n      return HandlerRole.TARGET;\n    default:\n      throw new Error(`Cannot parse handler ID: ${handlerId}`);\n  }\n}\nfunction mapContainsValue(map, searchValue) {\n  const entries = map.entries();\n  let isDone = false;\n  do {\n    const {\n      done,\n      value: [, value]\n    } = entries.next();\n    if (value === searchValue) {\n      return true;\n    }\n    isDone = !!done;\n  } while (!isDone);\n  return false;\n}\nclass HandlerRegistryImpl {\n  addSource(type, source) {\n    validateType(type);\n    validateSourceContract(source);\n    const sourceId = this.addHandler(HandlerRole.SOURCE, type, source);\n    this.store.dispatch(addSource(sourceId));\n    return sourceId;\n  }\n  addTarget(type, target) {\n    validateType(type, true);\n    validateTargetContract(target);\n    const targetId = this.addHandler(HandlerRole.TARGET, type, target);\n    this.store.dispatch(addTarget(targetId));\n    return targetId;\n  }\n  containsHandler(handler) {\n    return mapContainsValue(this.dragSources, handler) || mapContainsValue(this.dropTargets, handler);\n  }\n  getSource(sourceId, includePinned = false) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    const isPinned = includePinned && sourceId === this.pinnedSourceId;\n    const source = isPinned ? this.pinnedSource : this.dragSources.get(sourceId);\n    return source;\n  }\n  getTarget(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.dropTargets.get(targetId);\n  }\n  getSourceType(sourceId) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    return this.types.get(sourceId);\n  }\n  getTargetType(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.types.get(targetId);\n  }\n  isSourceId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.SOURCE;\n  }\n  isTargetId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.TARGET;\n  }\n  removeSource(sourceId) {\n    invariant(this.getSource(sourceId), 'Expected an existing source.');\n    this.store.dispatch(removeSource(sourceId));\n    asap(() => {\n      this.dragSources.delete(sourceId);\n      this.types.delete(sourceId);\n    });\n  }\n  removeTarget(targetId) {\n    invariant(this.getTarget(targetId), 'Expected an existing target.');\n    this.store.dispatch(removeTarget(targetId));\n    this.dropTargets.delete(targetId);\n    this.types.delete(targetId);\n  }\n  pinSource(sourceId) {\n    const source = this.getSource(sourceId);\n    invariant(source, 'Expected an existing source.');\n    this.pinnedSourceId = sourceId;\n    this.pinnedSource = source;\n  }\n  unpinSource() {\n    invariant(this.pinnedSource, 'No source is pinned at the time.');\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n  }\n  addHandler(role, type, handler) {\n    const id = getNextHandlerId(role);\n    this.types.set(id, type);\n    if (role === HandlerRole.SOURCE) {\n      this.dragSources.set(id, handler);\n    } else if (role === HandlerRole.TARGET) {\n      this.dropTargets.set(id, handler);\n    }\n    return id;\n  }\n  constructor(store) {\n    this.types = new Map();\n    this.dragSources = new Map();\n    this.dropTargets = new Map();\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n    this.store = store;\n  }\n}\nconst strictEquality = (a, b) => a === b;\n/**\n * Determine if two cartesian coordinate offsets are equal\n * @param offsetA\n * @param offsetB\n */\n\nfunction areCoordsEqual(offsetA, offsetB) {\n  if (!offsetA && !offsetB) {\n    return true;\n  } else if (!offsetA || !offsetB) {\n    return false;\n  } else {\n    return offsetA.x === offsetB.x && offsetA.y === offsetB.y;\n  }\n}\n/**\n * Determines if two arrays of items are equal\n * @param a The first array of items\n * @param b The second array of items\n */\n\nfunction areArraysEqual(a, b, isEqual = strictEquality) {\n  if (a.length !== b.length) {\n    return false;\n  }\n  for (let i = 0; i < a.length; ++i) {\n    if (!isEqual(a[i], b[i])) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction reduce$5(\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n_state = NONE, action) {\n  switch (action.type) {\n    case HOVER:\n      break;\n    case ADD_SOURCE:\n    case ADD_TARGET:\n    case REMOVE_TARGET:\n    case REMOVE_SOURCE:\n      return NONE;\n    case BEGIN_DRAG:\n    case PUBLISH_DRAG_SOURCE:\n    case END_DRAG:\n    case DROP:\n    default:\n      return ALL;\n  }\n  const {\n    targetIds = [],\n    prevTargetIds = []\n  } = action.payload;\n  const result = xor(targetIds, prevTargetIds);\n  const didChange = result.length > 0 || !areArraysEqual(targetIds, prevTargetIds);\n  if (!didChange) {\n    return NONE;\n  } // Check the target ids at the innermost position. If they are valid, add them\n  // to the result\n\n  const prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1];\n  const innermostTargetId = targetIds[targetIds.length - 1];\n  if (prevInnermostTargetId !== innermostTargetId) {\n    if (prevInnermostTargetId) {\n      result.push(prevInnermostTargetId);\n    }\n    if (innermostTargetId) {\n      result.push(innermostTargetId);\n    }\n  }\n  return result;\n}\nfunction _defineProperty$3(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty$3(target, key, source[key]);\n    });\n  }\n  return target;\n}\nconst initialState$1 = {\n  initialSourceClientOffset: null,\n  initialClientOffset: null,\n  clientOffset: null\n};\nfunction reduce$4(state = initialState$1, action) {\n  const {\n    payload\n  } = action;\n  switch (action.type) {\n    case INIT_COORDS:\n    case BEGIN_DRAG:\n      return {\n        initialSourceClientOffset: payload.sourceClientOffset,\n        initialClientOffset: payload.clientOffset,\n        clientOffset: payload.clientOffset\n      };\n    case HOVER:\n      if (areCoordsEqual(state.clientOffset, payload.clientOffset)) {\n        return state;\n      }\n      return _objectSpread$3({}, state, {\n        clientOffset: payload.clientOffset\n      });\n    case END_DRAG:\n    case DROP:\n      return initialState$1;\n    default:\n      return state;\n  }\n}\nfunction _defineProperty$2(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty$2(target, key, source[key]);\n    });\n  }\n  return target;\n}\nconst initialState = {\n  itemType: null,\n  item: null,\n  sourceId: null,\n  targetIds: [],\n  dropResult: null,\n  didDrop: false,\n  isSourcePublic: null\n};\nfunction reduce$3(state = initialState, action) {\n  const {\n    payload\n  } = action;\n  switch (action.type) {\n    case BEGIN_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: payload.itemType,\n        item: payload.item,\n        sourceId: payload.sourceId,\n        isSourcePublic: payload.isSourcePublic,\n        dropResult: null,\n        didDrop: false\n      });\n    case PUBLISH_DRAG_SOURCE:\n      return _objectSpread$2({}, state, {\n        isSourcePublic: true\n      });\n    case HOVER:\n      return _objectSpread$2({}, state, {\n        targetIds: payload.targetIds\n      });\n    case REMOVE_TARGET:\n      if (state.targetIds.indexOf(payload.targetId) === -1) {\n        return state;\n      }\n      return _objectSpread$2({}, state, {\n        targetIds: without$1(state.targetIds, payload.targetId)\n      });\n    case DROP:\n      return _objectSpread$2({}, state, {\n        dropResult: payload.dropResult,\n        didDrop: true,\n        targetIds: []\n      });\n    case END_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: null,\n        item: null,\n        sourceId: null,\n        dropResult: null,\n        didDrop: false,\n        isSourcePublic: null,\n        targetIds: []\n      });\n    default:\n      return state;\n  }\n}\nfunction reduce$2(state = 0, action) {\n  switch (action.type) {\n    case ADD_SOURCE:\n    case ADD_TARGET:\n      return state + 1;\n    case REMOVE_SOURCE:\n    case REMOVE_TARGET:\n      return state - 1;\n    default:\n      return state;\n  }\n}\nfunction reduce$1(state = 0) {\n  return state + 1;\n}\nfunction _defineProperty$1(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty$1(target, key, source[key]);\n    });\n  }\n  return target;\n}\nfunction reduce(state = {}, action) {\n  return {\n    dirtyHandlerIds: reduce$5(state.dirtyHandlerIds, {\n      type: action.type,\n      payload: _objectSpread$1({}, action.payload, {\n        prevTargetIds: get(state, 'dragOperation.targetIds', [])\n      })\n    }),\n    dragOffset: reduce$4(state.dragOffset, action),\n    refCount: reduce$2(state.refCount, action),\n    dragOperation: reduce$3(state.dragOperation, action),\n    stateId: reduce$1(state.stateId)\n  };\n}\nfunction createDragDropManager(backendFactory, globalContext = undefined, backendOptions = {}, debugMode = false) {\n  const store = makeStoreInstance(debugMode);\n  const monitor = new DragDropMonitorImpl(store, new HandlerRegistryImpl(store));\n  const manager = new DragDropManagerImpl(store, monitor);\n  const backend = backendFactory(manager, globalContext, backendOptions);\n  manager.receiveBackend(backend);\n  return manager;\n}\nfunction makeStoreInstance(debugMode) {\n  // TODO: if we ever make a react-native version of this,\n  // we'll need to consider how to pull off dev-tooling\n  const reduxDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n  return createStore(reduce, debugMode && reduxDevTools && reduxDevTools({\n    name: 'dnd-core',\n    instanceId: 'dnd-core'\n  }));\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nlet refCount = 0;\nconst INSTANCE_SYM = Symbol.for('__REACT_DND_CONTEXT_INSTANCE__');\nvar DndProvider = /*#__PURE__*/memo(function DndProvider(_param) {\n  var {\n      children\n    } = _param,\n    props = _objectWithoutProperties(_param, [\"children\"]);\n  const [manager, isGlobalInstance] = getDndContextValue(props) // memoized from props\n  ;\n  /**\n  * If the global context was used to store the DND context\n  * then where theres no more references to it we should\n  * clean it up to avoid memory leaks\n  */\n\n  useEffect(() => {\n    if (isGlobalInstance) {\n      const context = getGlobalContext();\n      ++refCount;\n      return () => {\n        if (--refCount === 0) {\n          context[INSTANCE_SYM] = null;\n        }\n      };\n    }\n    return;\n  }, []);\n  return /*#__PURE__*/jsx(DndContext.Provider, {\n    value: manager,\n    children: children\n  });\n});\nfunction getDndContextValue(props) {\n  if ('manager' in props) {\n    const manager = {\n      dragDropManager: props.manager\n    };\n    return [manager, false];\n  }\n  const manager = createSingletonDndContext(props.backend, props.context, props.options, props.debugMode);\n  const isGlobalInstance = !props.context;\n  return [manager, isGlobalInstance];\n}\nfunction createSingletonDndContext(backend, context = getGlobalContext(), options, debugMode) {\n  const ctx = context;\n  if (!ctx[INSTANCE_SYM]) {\n    ctx[INSTANCE_SYM] = {\n      dragDropManager: createDragDropManager(backend, context, options, debugMode)\n    };\n  }\n  return ctx[INSTANCE_SYM];\n}\nfunction getGlobalContext() {\n  return typeof global !== 'undefined' ? global : window;\n}\nvar fastDeepEqual = function equal(a, b) {\n  if (a === b) return true;\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;) if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n    for (i = length; i-- !== 0;) if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n    return true;\n  } // true if both NaN, false otherwise\n\n  return a !== a && b !== b;\n};\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\n/**\n *\n * @param monitor The monitor to collect state from\n * @param collect The collecting function\n * @param onUpdate A method to invoke when updates occur\n */\n\nfunction useCollector(monitor, collect, onUpdate) {\n  const [collected, setCollected] = useState(() => collect(monitor));\n  const updateCollected = useCallback(() => {\n    const nextValue = collect(monitor); // This needs to be a deep-equality check because some monitor-collected values\n    // include XYCoord objects that may be equivalent, but do not have instance equality.\n\n    if (!fastDeepEqual(collected, nextValue)) {\n      setCollected(nextValue);\n      if (onUpdate) {\n        onUpdate();\n      }\n    }\n  }, [collected, monitor, onUpdate]); // update the collected properties after react renders.\n  // Note that the \"Dustbin Stress Test\" fails if this is not\n  // done when the component updates\n\n  useIsomorphicLayoutEffect(updateCollected);\n  return [collected, updateCollected];\n}\nfunction useMonitorOutput(monitor, collect, onCollect) {\n  const [collected, updateCollected] = useCollector(monitor, collect, onCollect);\n  useIsomorphicLayoutEffect(function subscribeToMonitorStateChange() {\n    const handlerId = monitor.getHandlerId();\n    if (handlerId == null) {\n      return;\n    }\n    return monitor.subscribeToStateChange(updateCollected, {\n      handlerIds: [handlerId]\n    });\n  }, [monitor, updateCollected]);\n  return collected;\n}\nfunction useCollectedProps(collector, monitor, connector) {\n  return useMonitorOutput(monitor, collector || (() => ({})), () => connector.reconnect());\n}\nfunction useOptionalFactory(arg, deps) {\n  const memoDeps = [...(deps || [])];\n  if (deps == null && typeof arg !== 'function') {\n    memoDeps.push(arg);\n  }\n  return useMemo(() => {\n    return typeof arg === 'function' ? arg() : arg;\n  }, memoDeps);\n}\nfunction useConnectDragSource(connector) {\n  return useMemo(() => connector.hooks.dragSource(), [connector]);\n}\nfunction useConnectDragPreview(connector) {\n  return useMemo(() => connector.hooks.dragPreview(), [connector]);\n}\nlet isCallingCanDrag = false;\nlet isCallingIsDragging = false;\nclass DragSourceMonitorImpl {\n  receiveHandlerId(sourceId) {\n    this.sourceId = sourceId;\n  }\n  getHandlerId() {\n    return this.sourceId;\n  }\n  canDrag() {\n    invariant(!isCallingCanDrag, 'You may not call monitor.canDrag() inside your canDrag() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n    try {\n      isCallingCanDrag = true;\n      return this.internalMonitor.canDragSource(this.sourceId);\n    } finally {\n      isCallingCanDrag = false;\n    }\n  }\n  isDragging() {\n    if (!this.sourceId) {\n      return false;\n    }\n    invariant(!isCallingIsDragging, 'You may not call monitor.isDragging() inside your isDragging() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n    try {\n      isCallingIsDragging = true;\n      return this.internalMonitor.isDraggingSource(this.sourceId);\n    } finally {\n      isCallingIsDragging = false;\n    }\n  }\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n  isDraggingSource(sourceId) {\n    return this.internalMonitor.isDraggingSource(sourceId);\n  }\n  isOverTarget(targetId, options) {\n    return this.internalMonitor.isOverTarget(targetId, options);\n  }\n  getTargetIds() {\n    return this.internalMonitor.getTargetIds();\n  }\n  isSourcePublic() {\n    return this.internalMonitor.isSourcePublic();\n  }\n  getSourceId() {\n    return this.internalMonitor.getSourceId();\n  }\n  subscribeToOffsetChange(listener) {\n    return this.internalMonitor.subscribeToOffsetChange(listener);\n  }\n  canDragSource(sourceId) {\n    return this.internalMonitor.canDragSource(sourceId);\n  }\n  canDropOnTarget(targetId) {\n    return this.internalMonitor.canDropOnTarget(targetId);\n  }\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n  constructor(manager) {\n    this.sourceId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n}\nlet isCallingCanDrop = false;\nclass DropTargetMonitorImpl {\n  receiveHandlerId(targetId) {\n    this.targetId = targetId;\n  }\n  getHandlerId() {\n    return this.targetId;\n  }\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n  canDrop() {\n    // Cut out early if the target id has not been set. This should prevent errors\n    // where the user has an older version of dnd-core like in\n    // https://github.com/react-dnd/react-dnd/issues/1310\n    if (!this.targetId) {\n      return false;\n    }\n    invariant(!isCallingCanDrop, 'You may not call monitor.canDrop() inside your canDrop() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor');\n    try {\n      isCallingCanDrop = true;\n      return this.internalMonitor.canDropOnTarget(this.targetId);\n    } finally {\n      isCallingCanDrop = false;\n    }\n  }\n  isOver(options) {\n    if (!this.targetId) {\n      return false;\n    }\n    return this.internalMonitor.isOverTarget(this.targetId, options);\n  }\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n  constructor(manager) {\n    this.targetId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n}\nfunction registerTarget(type, target, manager) {\n  const registry = manager.getRegistry();\n  const targetId = registry.addTarget(type, target);\n  return [targetId, () => registry.removeTarget(targetId)];\n}\nfunction registerSource(type, source, manager) {\n  const registry = manager.getRegistry();\n  const sourceId = registry.addSource(type, source);\n  return [sourceId, () => registry.removeSource(sourceId)];\n}\nfunction shallowEqual(objA, objB, compare, compareContext) {\n  let compareResult = compare ? compare.call(compareContext, objA, objB) : void 0;\n  if (compareResult !== void 0) {\n    return !!compareResult;\n  }\n  if (objA === objB) {\n    return true;\n  }\n  if (typeof objA !== 'object' || !objA || typeof objB !== 'object' || !objB) {\n    return false;\n  }\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n  const bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB); // Test for A's keys different from B.\n\n  for (let idx = 0; idx < keysA.length; idx++) {\n    const key = keysA[idx];\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n    const valueA = objA[key];\n    const valueB = objB[key];\n    compareResult = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n    if (compareResult === false || compareResult === void 0 && valueA !== valueB) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction isRef(obj) {\n  return (\n    // eslint-disable-next-line no-prototype-builtins\n    obj !== null && typeof obj === 'object' && Object.prototype.hasOwnProperty.call(obj, 'current')\n  );\n}\nfunction throwIfCompositeComponentElement(element) {\n  // Custom components can no longer be wrapped directly in React DnD 2.0\n  // so that we don't need to depend on findDOMNode() from react-dom.\n  if (typeof element.type === 'string') {\n    return;\n  }\n  const displayName = element.type.displayName || element.type.name || 'the component';\n  throw new Error('Only native element nodes can now be passed to React DnD connectors.' + `You can either wrap ${displayName} into a <div>, or turn it into a ` + 'drag source or a drop target itself.');\n}\nfunction wrapHookToRecognizeElement(hook) {\n  return (elementOrNode = null, options = null) => {\n    // When passed a node, call the hook straight away.\n    if (! /*#__PURE__*/isValidElement(elementOrNode)) {\n      const node = elementOrNode;\n      hook(node, options); // return the node so it can be chained (e.g. when within callback refs\n      // <div ref={node => connectDragSource(connectDropTarget(node))}/>\n\n      return node;\n    } // If passed a ReactElement, clone it and attach this function as a ref.\n    // This helps us achieve a neat API where user doesn't even know that refs\n    // are being used under the hood.\n\n    const element = elementOrNode;\n    throwIfCompositeComponentElement(element); // When no options are passed, use the hook directly\n\n    const ref = options ? node => hook(node, options) : hook;\n    return cloneWithRef(element, ref);\n  };\n}\nfunction wrapConnectorHooks(hooks) {\n  const wrappedHooks = {};\n  Object.keys(hooks).forEach(key => {\n    const hook = hooks[key]; // ref objects should be passed straight through without wrapping\n\n    if (key.endsWith('Ref')) {\n      wrappedHooks[key] = hooks[key];\n    } else {\n      const wrappedHook = wrapHookToRecognizeElement(hook);\n      wrappedHooks[key] = () => wrappedHook;\n    }\n  });\n  return wrappedHooks;\n}\nfunction setRef(ref, node) {\n  if (typeof ref === 'function') {\n    ref(node);\n  } else {\n    ref.current = node;\n  }\n}\nfunction cloneWithRef(element, newRef) {\n  const previousRef = element.ref;\n  invariant(typeof previousRef !== 'string', 'Cannot connect React DnD to an element with an existing string ref. ' + 'Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. ' + 'Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs');\n  if (!previousRef) {\n    // When there is no ref on the element, use the new ref directly\n    return /*#__PURE__*/cloneElement(element, {\n      ref: newRef\n    });\n  } else {\n    return /*#__PURE__*/cloneElement(element, {\n      ref: node => {\n        setRef(previousRef, node);\n        setRef(newRef, node);\n      }\n    });\n  }\n}\nclass SourceConnector {\n  receiveHandlerId(newHandlerId) {\n    if (this.handlerId === newHandlerId) {\n      return;\n    }\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n  get connectTarget() {\n    return this.dragSource;\n  }\n  get dragSourceOptions() {\n    return this.dragSourceOptionsInternal;\n  }\n  set dragSourceOptions(options) {\n    this.dragSourceOptionsInternal = options;\n  }\n  get dragPreviewOptions() {\n    return this.dragPreviewOptionsInternal;\n  }\n  set dragPreviewOptions(options) {\n    this.dragPreviewOptionsInternal = options;\n  }\n  reconnect() {\n    const didChange = this.reconnectDragSource();\n    this.reconnectDragPreview(didChange);\n  }\n  reconnectDragSource() {\n    const dragSource = this.dragSource; // if nothing has changed then don't resubscribe\n\n    const didChange = this.didHandlerIdChange() || this.didConnectedDragSourceChange() || this.didDragSourceOptionsChange();\n    if (didChange) {\n      this.disconnectDragSource();\n    }\n    if (!this.handlerId) {\n      return didChange;\n    }\n    if (!dragSource) {\n      this.lastConnectedDragSource = dragSource;\n      return didChange;\n    }\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragSource = dragSource;\n      this.lastConnectedDragSourceOptions = this.dragSourceOptions;\n      this.dragSourceUnsubscribe = this.backend.connectDragSource(this.handlerId, dragSource, this.dragSourceOptions);\n    }\n    return didChange;\n  }\n  reconnectDragPreview(forceDidChange = false) {\n    const dragPreview = this.dragPreview; // if nothing has changed then don't resubscribe\n\n    const didChange = forceDidChange || this.didHandlerIdChange() || this.didConnectedDragPreviewChange() || this.didDragPreviewOptionsChange();\n    if (didChange) {\n      this.disconnectDragPreview();\n    }\n    if (!this.handlerId) {\n      return;\n    }\n    if (!dragPreview) {\n      this.lastConnectedDragPreview = dragPreview;\n      return;\n    }\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragPreview = dragPreview;\n      this.lastConnectedDragPreviewOptions = this.dragPreviewOptions;\n      this.dragPreviewUnsubscribe = this.backend.connectDragPreview(this.handlerId, dragPreview, this.dragPreviewOptions);\n    }\n  }\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n  didConnectedDragSourceChange() {\n    return this.lastConnectedDragSource !== this.dragSource;\n  }\n  didConnectedDragPreviewChange() {\n    return this.lastConnectedDragPreview !== this.dragPreview;\n  }\n  didDragSourceOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragSourceOptions, this.dragSourceOptions);\n  }\n  didDragPreviewOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragPreviewOptions, this.dragPreviewOptions);\n  }\n  disconnectDragSource() {\n    if (this.dragSourceUnsubscribe) {\n      this.dragSourceUnsubscribe();\n      this.dragSourceUnsubscribe = undefined;\n    }\n  }\n  disconnectDragPreview() {\n    if (this.dragPreviewUnsubscribe) {\n      this.dragPreviewUnsubscribe();\n      this.dragPreviewUnsubscribe = undefined;\n      this.dragPreviewNode = null;\n      this.dragPreviewRef = null;\n    }\n  }\n  get dragSource() {\n    return this.dragSourceNode || this.dragSourceRef && this.dragSourceRef.current;\n  }\n  get dragPreview() {\n    return this.dragPreviewNode || this.dragPreviewRef && this.dragPreviewRef.current;\n  }\n  clearDragSource() {\n    this.dragSourceNode = null;\n    this.dragSourceRef = null;\n  }\n  clearDragPreview() {\n    this.dragPreviewNode = null;\n    this.dragPreviewRef = null;\n  }\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dragSource: (node, options) => {\n        this.clearDragSource();\n        this.dragSourceOptions = options || null;\n        if (isRef(node)) {\n          this.dragSourceRef = node;\n        } else {\n          this.dragSourceNode = node;\n        }\n        this.reconnectDragSource();\n      },\n      dragPreview: (node, options) => {\n        this.clearDragPreview();\n        this.dragPreviewOptions = options || null;\n        if (isRef(node)) {\n          this.dragPreviewRef = node;\n        } else {\n          this.dragPreviewNode = node;\n        }\n        this.reconnectDragPreview();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dragSourceRef = null;\n    this.dragSourceOptionsInternal = null; // The drag preview may either be attached via ref or connect function\n\n    this.dragPreviewRef = null;\n    this.dragPreviewOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDragSource = null;\n    this.lastConnectedDragSourceOptions = null;\n    this.lastConnectedDragPreview = null;\n    this.lastConnectedDragPreviewOptions = null;\n    this.backend = backend;\n  }\n}\nclass TargetConnector {\n  get connectTarget() {\n    return this.dropTarget;\n  }\n  reconnect() {\n    // if nothing has changed then don't resubscribe\n    const didChange = this.didHandlerIdChange() || this.didDropTargetChange() || this.didOptionsChange();\n    if (didChange) {\n      this.disconnectDropTarget();\n    }\n    const dropTarget = this.dropTarget;\n    if (!this.handlerId) {\n      return;\n    }\n    if (!dropTarget) {\n      this.lastConnectedDropTarget = dropTarget;\n      return;\n    }\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDropTarget = dropTarget;\n      this.lastConnectedDropTargetOptions = this.dropTargetOptions;\n      this.unsubscribeDropTarget = this.backend.connectDropTarget(this.handlerId, dropTarget, this.dropTargetOptions);\n    }\n  }\n  receiveHandlerId(newHandlerId) {\n    if (newHandlerId === this.handlerId) {\n      return;\n    }\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n  get dropTargetOptions() {\n    return this.dropTargetOptionsInternal;\n  }\n  set dropTargetOptions(options) {\n    this.dropTargetOptionsInternal = options;\n  }\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n  didDropTargetChange() {\n    return this.lastConnectedDropTarget !== this.dropTarget;\n  }\n  didOptionsChange() {\n    return !shallowEqual(this.lastConnectedDropTargetOptions, this.dropTargetOptions);\n  }\n  disconnectDropTarget() {\n    if (this.unsubscribeDropTarget) {\n      this.unsubscribeDropTarget();\n      this.unsubscribeDropTarget = undefined;\n    }\n  }\n  get dropTarget() {\n    return this.dropTargetNode || this.dropTargetRef && this.dropTargetRef.current;\n  }\n  clearDropTarget() {\n    this.dropTargetRef = null;\n    this.dropTargetNode = null;\n  }\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dropTarget: (node, options) => {\n        this.clearDropTarget();\n        this.dropTargetOptions = options;\n        if (isRef(node)) {\n          this.dropTargetRef = node;\n        } else {\n          this.dropTargetNode = node;\n        }\n        this.reconnect();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dropTargetRef = null;\n    this.dropTargetOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDropTarget = null;\n    this.lastConnectedDropTargetOptions = null;\n    this.backend = backend;\n  }\n}\n\n/**\n * A hook to retrieve the DragDropManager from Context\n */\n\nfunction useDragDropManager() {\n  const {\n    dragDropManager\n  } = useContext(DndContext);\n  invariant(dragDropManager != null, 'Expected drag drop context');\n  return dragDropManager;\n}\nfunction useDragSourceConnector(dragSourceOptions, dragPreviewOptions) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new SourceConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragSourceOptions = dragSourceOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragSource();\n  }, [connector, dragSourceOptions]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragPreviewOptions = dragPreviewOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragPreview();\n  }, [connector, dragPreviewOptions]);\n  return connector;\n}\nfunction useDragSourceMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DragSourceMonitorImpl(manager), [manager]);\n}\nclass DragSourceImpl {\n  beginDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    let result = null;\n    if (typeof spec.item === 'object') {\n      result = spec.item;\n    } else if (typeof spec.item === 'function') {\n      result = spec.item(monitor);\n    } else {\n      result = {};\n    }\n    return result !== null && result !== void 0 ? result : null;\n  }\n  canDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    if (typeof spec.canDrag === 'boolean') {\n      return spec.canDrag;\n    } else if (typeof spec.canDrag === 'function') {\n      return spec.canDrag(monitor);\n    } else {\n      return true;\n    }\n  }\n  isDragging(globalMonitor, target) {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const {\n      isDragging\n    } = spec;\n    return isDragging ? isDragging(monitor) : target === globalMonitor.getSourceId();\n  }\n  endDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const connector = this.connector;\n    const {\n      end\n    } = spec;\n    if (end) {\n      end(monitor.getItem(), monitor);\n    }\n    connector.reconnect();\n  }\n  constructor(spec, monitor, connector) {\n    this.spec = spec;\n    this.monitor = monitor;\n    this.connector = connector;\n  }\n}\nfunction useDragSource(spec, monitor, connector) {\n  const handler = useMemo(() => new DragSourceImpl(spec, monitor, connector), [monitor, connector]);\n  useEffect(() => {\n    handler.spec = spec;\n  }, [spec]);\n  return handler;\n}\nfunction useDragType(spec) {\n  return useMemo(() => {\n    const result = spec.type;\n    invariant(result != null, 'spec.type must be defined');\n    return result;\n  }, [spec]);\n}\nfunction useRegisteredDragSource(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const handler = useDragSource(spec, monitor, connector);\n  const itemType = useDragType(spec);\n  useIsomorphicLayoutEffect(function registerDragSource() {\n    if (itemType != null) {\n      const [handlerId, unregister] = registerSource(itemType, handler, manager);\n      monitor.receiveHandlerId(handlerId);\n      connector.receiveHandlerId(handlerId);\n      return unregister;\n    }\n    return;\n  }, [manager, monitor, connector, handler, itemType]);\n}\n\n/**\n * useDragSource hook\n * @param sourceSpec The drag source specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrag(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  invariant(!spec.begin, `useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)`);\n  const monitor = useDragSourceMonitor();\n  const connector = useDragSourceConnector(spec.options, spec.previewOptions);\n  useRegisteredDragSource(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDragSource(connector), useConnectDragPreview(connector)];\n}\n\n/**\n * useDragLayer Hook\n * @param collector The property collector\n */\n\nfunction useDragLayer(collect) {\n  const dragDropManager = useDragDropManager();\n  const monitor = dragDropManager.getMonitor();\n  const [collected, updateCollected] = useCollector(monitor, collect);\n  useEffect(() => monitor.subscribeToOffsetChange(updateCollected));\n  useEffect(() => monitor.subscribeToStateChange(updateCollected));\n  return collected;\n}\nfunction useConnectDropTarget(connector) {\n  return useMemo(() => connector.hooks.dropTarget(), [connector]);\n}\nfunction useDropTargetConnector(options) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new TargetConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dropTargetOptions = options || null;\n    connector.reconnect();\n    return () => connector.disconnectDropTarget();\n  }, [options]);\n  return connector;\n}\nfunction useDropTargetMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DropTargetMonitorImpl(manager), [manager]);\n}\n\n/**\n * Internal utility hook to get an array-version of spec.accept.\n * The main utility here is that we aren't creating a new array on every render if a non-array spec.accept is passed in.\n * @param spec\n */\n\nfunction useAccept(spec) {\n  const {\n    accept\n  } = spec;\n  return useMemo(() => {\n    invariant(spec.accept != null, 'accept must be defined');\n    return Array.isArray(accept) ? accept : [accept];\n  }, [accept]);\n}\nclass DropTargetImpl {\n  canDrop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    return spec.canDrop ? spec.canDrop(monitor.getItem(), monitor) : true;\n  }\n  hover() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    if (spec.hover) {\n      spec.hover(monitor.getItem(), monitor);\n    }\n  }\n  drop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    if (spec.drop) {\n      return spec.drop(monitor.getItem(), monitor);\n    }\n    return;\n  }\n  constructor(spec, monitor) {\n    this.spec = spec;\n    this.monitor = monitor;\n  }\n}\nfunction useDropTarget(spec, monitor) {\n  const dropTarget = useMemo(() => new DropTargetImpl(spec, monitor), [monitor]);\n  useEffect(() => {\n    dropTarget.spec = spec;\n  }, [spec]);\n  return dropTarget;\n}\nfunction useRegisteredDropTarget(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const dropTarget = useDropTarget(spec, monitor);\n  const accept = useAccept(spec);\n  useIsomorphicLayoutEffect(function registerDropTarget() {\n    const [handlerId, unregister] = registerTarget(accept, dropTarget, manager);\n    monitor.receiveHandlerId(handlerId);\n    connector.receiveHandlerId(handlerId);\n    return unregister;\n  }, [manager, monitor, dropTarget, connector, accept.map(a => a.toString()).join('|')]);\n}\n\n/**\n * useDropTarget Hook\n * @param spec The drop target specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrop(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  const monitor = useDropTargetMonitor();\n  const connector = useDropTargetConnector(spec.options);\n  useRegisteredDropTarget(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDropTarget(connector)];\n}\n\n// cheap lodash replacements\nfunction memoize(fn) {\n  let result = null;\n  const memoized = () => {\n    if (result == null) {\n      result = fn();\n    }\n    return result;\n  };\n  return memoized;\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without(items, item) {\n  return items.filter(i => i !== item);\n}\nfunction union(itemsA, itemsB) {\n  const set = new Set();\n  const insertItem = item => set.add(item);\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  set.forEach(key => result.push(key));\n  return result;\n}\nclass EnterLeaveCounter {\n  enter(enteringNode) {\n    const previousLength = this.entered.length;\n    const isNodeEntered = node => this.isNodeInDocument(node) && (!node.contains || node.contains(enteringNode));\n    this.entered = union(this.entered.filter(isNodeEntered), [enteringNode]);\n    return previousLength === 0 && this.entered.length > 0;\n  }\n  leave(leavingNode) {\n    const previousLength = this.entered.length;\n    this.entered = without(this.entered.filter(this.isNodeInDocument), leavingNode);\n    return previousLength > 0 && this.entered.length === 0;\n  }\n  reset() {\n    this.entered = [];\n  }\n  constructor(isNodeInDocument) {\n    this.entered = [];\n    this.isNodeInDocument = isNodeInDocument;\n  }\n}\nclass NativeDragSource {\n  initializeExposedProperties() {\n    Object.keys(this.config.exposeProperties).forEach(property => {\n      Object.defineProperty(this.item, property, {\n        configurable: true,\n        enumerable: true,\n        get() {\n          // eslint-disable-next-line no-console\n          console.warn(`Browser doesn't allow reading \"${property}\" until the drop event.`);\n          return null;\n        }\n      });\n    });\n  }\n  loadDataTransfer(dataTransfer) {\n    if (dataTransfer) {\n      const newProperties = {};\n      Object.keys(this.config.exposeProperties).forEach(property => {\n        const propertyFn = this.config.exposeProperties[property];\n        if (propertyFn != null) {\n          newProperties[property] = {\n            value: propertyFn(dataTransfer, this.config.matchesTypes),\n            configurable: true,\n            enumerable: true\n          };\n        }\n      });\n      Object.defineProperties(this.item, newProperties);\n    }\n  }\n  canDrag() {\n    return true;\n  }\n  beginDrag() {\n    return this.item;\n  }\n  isDragging(monitor, handle) {\n    return handle === monitor.getSourceId();\n  }\n  endDrag() {// empty\n  }\n  constructor(config) {\n    this.config = config;\n    this.item = {};\n    this.initializeExposedProperties();\n  }\n}\nconst FILE = '__NATIVE_FILE__';\nconst URL = '__NATIVE_URL__';\nconst TEXT = '__NATIVE_TEXT__';\nconst HTML = '__NATIVE_HTML__';\nvar NativeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  FILE: FILE,\n  URL: URL,\n  TEXT: TEXT,\n  HTML: HTML\n});\nfunction getDataFromDataTransfer(dataTransfer, typesToTry, defaultValue) {\n  const result = typesToTry.reduce((resultSoFar, typeToTry) => resultSoFar || dataTransfer.getData(typeToTry), '');\n  return result != null ? result : defaultValue;\n}\nconst nativeTypesConfig = {\n  [FILE]: {\n    exposeProperties: {\n      files: dataTransfer => Array.prototype.slice.call(dataTransfer.files),\n      items: dataTransfer => dataTransfer.items,\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Files']\n  },\n  [HTML]: {\n    exposeProperties: {\n      html: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Html', 'text/html']\n  },\n  [URL]: {\n    exposeProperties: {\n      urls: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, '').split('\\n'),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Url', 'text/uri-list']\n  },\n  [TEXT]: {\n    exposeProperties: {\n      text: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Text', 'text/plain']\n  }\n};\nfunction createNativeDragSource(type, dataTransfer) {\n  const config = nativeTypesConfig[type];\n  if (!config) {\n    throw new Error(`native type ${type} has no configuration`);\n  }\n  const result = new NativeDragSource(config);\n  result.loadDataTransfer(dataTransfer);\n  return result;\n}\nfunction matchNativeItemType(dataTransfer) {\n  if (!dataTransfer) {\n    return null;\n  }\n  const dataTransferTypes = Array.prototype.slice.call(dataTransfer.types || []);\n  return Object.keys(nativeTypesConfig).filter(nativeItemType => {\n    const typeConfig = nativeTypesConfig[nativeItemType];\n    if (!(typeConfig === null || typeConfig === void 0 ? void 0 : typeConfig.matchesTypes)) {\n      return false;\n    }\n    return typeConfig.matchesTypes.some(t => dataTransferTypes.indexOf(t) > -1);\n  })[0] || null;\n}\nconst isFirefox = memoize(() => /firefox/i.test(navigator.userAgent));\nconst isSafari = memoize(() => Boolean(window.safari));\nclass MonotonicInterpolant {\n  interpolate(x) {\n    const {\n      xs,\n      ys,\n      c1s,\n      c2s,\n      c3s\n    } = this; // The rightmost point in the dataset should give an exact result\n\n    let i = xs.length - 1;\n    if (x === xs[i]) {\n      return ys[i];\n    } // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n\n    let low = 0;\n    let high = c3s.length - 1;\n    let mid;\n    while (low <= high) {\n      mid = Math.floor(0.5 * (low + high));\n      const xHere = xs[mid];\n      if (xHere < x) {\n        low = mid + 1;\n      } else if (xHere > x) {\n        high = mid - 1;\n      } else {\n        return ys[mid];\n      }\n    }\n    i = Math.max(0, high); // Interpolate\n\n    const diff = x - xs[i];\n    const diffSq = diff * diff;\n    return ys[i] + c1s[i] * diff + c2s[i] * diffSq + c3s[i] * diff * diffSq;\n  }\n  constructor(xs, ys) {\n    const {\n      length\n    } = xs; // Rearrange xs and ys so that xs is sorted\n\n    const indexes = [];\n    for (let i = 0; i < length; i++) {\n      indexes.push(i);\n    }\n    indexes.sort((a, b) => xs[a] < xs[b] ? -1 : 1); // Get consecutive differences and slopes\n    const dxs = [];\n    const ms = [];\n    let dx;\n    let dy;\n    for (let i1 = 0; i1 < length - 1; i1++) {\n      dx = xs[i1 + 1] - xs[i1];\n      dy = ys[i1 + 1] - ys[i1];\n      dxs.push(dx);\n      ms.push(dy / dx);\n    } // Get degree-1 coefficients\n\n    const c1s = [ms[0]];\n    for (let i2 = 0; i2 < dxs.length - 1; i2++) {\n      const m2 = ms[i2];\n      const mNext = ms[i2 + 1];\n      if (m2 * mNext <= 0) {\n        c1s.push(0);\n      } else {\n        dx = dxs[i2];\n        const dxNext = dxs[i2 + 1];\n        const common = dx + dxNext;\n        c1s.push(3 * common / ((common + dxNext) / m2 + (common + dx) / mNext));\n      }\n    }\n    c1s.push(ms[ms.length - 1]); // Get degree-2 and degree-3 coefficients\n\n    const c2s = [];\n    const c3s = [];\n    let m;\n    for (let i3 = 0; i3 < c1s.length - 1; i3++) {\n      m = ms[i3];\n      const c1 = c1s[i3];\n      const invDx = 1 / dxs[i3];\n      const common = c1 + c1s[i3 + 1] - m - m;\n      c2s.push((m - c1 - common) * invDx);\n      c3s.push(common * invDx * invDx);\n    }\n    this.xs = xs;\n    this.ys = ys;\n    this.c1s = c1s;\n    this.c2s = c2s;\n    this.c3s = c3s;\n  }\n}\nconst ELEMENT_NODE$1 = 1;\nfunction getNodeClientOffset$1(node) {\n  const el = node.nodeType === ELEMENT_NODE$1 ? node : node.parentElement;\n  if (!el) {\n    return null;\n  }\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientOffset$1(e) {\n  return {\n    x: e.clientX,\n    y: e.clientY\n  };\n}\nfunction isImageNode(node) {\n  var ref;\n  return node.nodeName === 'IMG' && (isFirefox() || !((ref = document.documentElement) === null || ref === void 0 ? void 0 : ref.contains(node)));\n}\nfunction getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight) {\n  let dragPreviewWidth = isImage ? dragPreview.width : sourceWidth;\n  let dragPreviewHeight = isImage ? dragPreview.height : sourceHeight; // Work around @2x coordinate discrepancies in browsers\n\n  if (isSafari() && isImage) {\n    dragPreviewHeight /= window.devicePixelRatio;\n    dragPreviewWidth /= window.devicePixelRatio;\n  }\n  return {\n    dragPreviewWidth,\n    dragPreviewHeight\n  };\n}\nfunction getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint) {\n  // The browsers will use the image intrinsic size under different conditions.\n  // Firefox only cares if it's an image, but WebKit also wants it to be detached.\n  const isImage = isImageNode(dragPreview);\n  const dragPreviewNode = isImage ? sourceNode : dragPreview;\n  const dragPreviewNodeOffsetFromClient = getNodeClientOffset$1(dragPreviewNode);\n  const offsetFromDragPreview = {\n    x: clientOffset.x - dragPreviewNodeOffsetFromClient.x,\n    y: clientOffset.y - dragPreviewNodeOffsetFromClient.y\n  };\n  const {\n    offsetWidth: sourceWidth,\n    offsetHeight: sourceHeight\n  } = sourceNode;\n  const {\n    anchorX,\n    anchorY\n  } = anchorPoint;\n  const {\n    dragPreviewWidth,\n    dragPreviewHeight\n  } = getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight);\n  const calculateYOffset = () => {\n    const interpolantY = new MonotonicInterpolant([0, 0.5, 1], [\n    // Dock to the top\n    offsetFromDragPreview.y,\n    // Align at the center\n    offsetFromDragPreview.y / sourceHeight * dragPreviewHeight,\n    // Dock to the bottom\n    offsetFromDragPreview.y + dragPreviewHeight - sourceHeight]);\n    let y = interpolantY.interpolate(anchorY); // Work around Safari 8 positioning bug\n\n    if (isSafari() && isImage) {\n      // We'll have to wait for @3x to see if this is entirely correct\n      y += (window.devicePixelRatio - 1) * dragPreviewHeight;\n    }\n    return y;\n  };\n  const calculateXOffset = () => {\n    // Interpolate coordinates depending on anchor point\n    // If you know a simpler way to do this, let me know\n    const interpolantX = new MonotonicInterpolant([0, 0.5, 1], [\n    // Dock to the left\n    offsetFromDragPreview.x,\n    // Align at the center\n    offsetFromDragPreview.x / sourceWidth * dragPreviewWidth,\n    // Dock to the right\n    offsetFromDragPreview.x + dragPreviewWidth - sourceWidth]);\n    return interpolantX.interpolate(anchorX);\n  }; // Force offsets if specified in the options.\n\n  const {\n    offsetX,\n    offsetY\n  } = offsetPoint;\n  const isManualOffsetX = offsetX === 0 || offsetX;\n  const isManualOffsetY = offsetY === 0 || offsetY;\n  return {\n    x: isManualOffsetX ? offsetX : calculateXOffset(),\n    y: isManualOffsetY ? offsetY : calculateYOffset()\n  };\n}\nclass OptionsReader$1 {\n  get window() {\n    if (this.globalContext) {\n      return this.globalContext;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n    return undefined;\n  }\n  get document() {\n    var ref;\n    if ((ref = this.globalContext) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.globalContext.document;\n    } else if (this.window) {\n      return this.window.document;\n    } else {\n      return undefined;\n    }\n  }\n  get rootElement() {\n    var ref;\n    return ((ref = this.optionsArgs) === null || ref === void 0 ? void 0 : ref.rootElement) || this.window;\n  }\n  constructor(globalContext, options) {\n    this.ownerDocument = null;\n    this.globalContext = globalContext;\n    this.optionsArgs = options;\n  }\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n  return target;\n}\nclass HTML5BackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref, ref1;\n    return {\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      sourceNodeOptions: this.sourceNodeOptions.size,\n      sourceNodes: this.sourceNodes.size,\n      dragStartSourceIds: ((ref = this.dragStartSourceIds) === null || ref === void 0 ? void 0 : ref.length) || 0,\n      dropTargetIds: this.dropTargetIds.length,\n      dragEnterTargetIds: this.dragEnterTargetIds.length,\n      dragOverTargetIds: ((ref1 = this.dragOverTargetIds) === null || ref1 === void 0 ? void 0 : ref1.length) || 0\n    };\n  } // public for test\n\n  get window() {\n    return this.options.window;\n  }\n  get document() {\n    return this.options.document;\n  }\n  /**\n  * Get the root element to use for event subscriptions\n  */\n\n  get rootElement() {\n    return this.options.rootElement;\n  }\n  setup() {\n    const root = this.rootElement;\n    if (root === undefined) {\n      return;\n    }\n    if (root.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n    root.__isReactDndBackendSetUp = true;\n    this.addEventListeners(root);\n  }\n  teardown() {\n    const root = this.rootElement;\n    if (root === undefined) {\n      return;\n    }\n    root.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.rootElement);\n    this.clearCurrentDragSourceNode();\n    if (this.asyncEndDragFrameId) {\n      var ref;\n      (ref = this.window) === null || ref === void 0 ? void 0 : ref.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  }\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n  connectDragSource(sourceId, node, options) {\n    this.sourceNodes.set(sourceId, node);\n    this.sourceNodeOptions.set(sourceId, options);\n    const handleDragStart = e => this.handleDragStart(e, sourceId);\n    const handleSelectStart = e => this.handleSelectStart(e);\n    node.setAttribute('draggable', 'true');\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.sourceNodeOptions.delete(sourceId);\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', 'false');\n    };\n  }\n  connectDropTarget(targetId, node) {\n    const handleDragEnter = e => this.handleDragEnter(e, targetId);\n    const handleDragOver = e => this.handleDragOver(e, targetId);\n    const handleDrop = e => this.handleDrop(e, targetId);\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return () => {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  }\n  addEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  }\n  removeEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  }\n  getCurrentSourceNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n    return _objectSpread({\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    }, sourceNodeOptions || {});\n  }\n  getCurrentDropEffect() {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  }\n  getCurrentSourcePreviewNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n    return _objectSpread({\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    }, sourcePreviewNodeOptions || {});\n  }\n  isDraggingNativeItem() {\n    const itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(key => NativeTypes[key] === itemType);\n  }\n  beginDragNativeItem(type, dataTransfer) {\n    this.clearCurrentDragSourceNode();\n    this.currentNativeSource = createNativeDragSource(type, dataTransfer);\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  }\n  setCurrentDragSourceNode(node) {\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n\n    const MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n\n    this.mouseMoveTimeoutTimer = setTimeout(() => {\n      var ref;\n      return (ref = this.rootElement) === null || ref === void 0 ? void 0 : ref.addEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  }\n  clearCurrentDragSourceNode() {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n      if (this.rootElement) {\n        var ref;\n        (ref = this.window) === null || ref === void 0 ? void 0 : ref.clearTimeout(this.mouseMoveTimeoutTimer || undefined);\n        this.rootElement.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n    return false;\n  }\n  handleDragStart(e, sourceId) {\n    if (e.defaultPrevented) {\n      return;\n    }\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n    this.dragStartSourceIds.unshift(sourceId);\n  }\n  handleDragEnter(_e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  }\n  handleDragOver(_e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n    this.dragOverTargetIds.unshift(targetId);\n  }\n  handleDrop(_e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  }\n  constructor(manager, globalContext, options) {\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.lastClientOffset = null;\n    this.hoverRafId = null;\n    this.getSourceClientOffset = sourceId => {\n      const source = this.sourceNodes.get(sourceId);\n      return source && getNodeClientOffset$1(source) || null;\n    };\n    this.endDragNativeItem = () => {\n      if (!this.isDraggingNativeItem()) {\n        return;\n      }\n      this.actions.endDrag();\n      if (this.currentNativeHandle) {\n        this.registry.removeSource(this.currentNativeHandle);\n      }\n      this.currentNativeHandle = null;\n      this.currentNativeSource = null;\n    };\n    this.isNodeInDocument = node => {\n      // Check the node either in the main document or in the current context\n      return Boolean(node && this.document && this.document.body && this.document.body.contains(node));\n    };\n    this.endDragIfSourceWasRemovedFromDOM = () => {\n      const node = this.currentDragSourceNode;\n      if (node == null || this.isNodeInDocument(node)) {\n        return;\n      }\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n      this.cancelHover();\n    };\n    this.scheduleHover = dragOverTargetIds => {\n      if (this.hoverRafId === null && typeof requestAnimationFrame !== 'undefined') {\n        this.hoverRafId = requestAnimationFrame(() => {\n          if (this.monitor.isDragging()) {\n            this.actions.hover(dragOverTargetIds || [], {\n              clientOffset: this.lastClientOffset\n            });\n          }\n          this.hoverRafId = null;\n        });\n      }\n    };\n    this.cancelHover = () => {\n      if (this.hoverRafId !== null && typeof cancelAnimationFrame !== 'undefined') {\n        cancelAnimationFrame(this.hoverRafId);\n        this.hoverRafId = null;\n      }\n    };\n    this.handleTopDragStartCapture = () => {\n      this.clearCurrentDragSourceNode();\n      this.dragStartSourceIds = [];\n    };\n    this.handleTopDragStart = e => {\n      if (e.defaultPrevented) {\n        return;\n      }\n      const {\n        dragStartSourceIds\n      } = this;\n      this.dragStartSourceIds = null;\n      const clientOffset = getEventClientOffset$1(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n        this.cancelHover();\n      } // Don't publish the source just yet (see why below)\n\n      this.actions.beginDrag(dragStartSourceIds || [], {\n        publishSource: false,\n        getSourceClientOffset: this.getSourceClientOffset,\n        clientOffset\n      });\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n      if (this.monitor.isDragging()) {\n        if (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          const sourceId = this.monitor.getSourceId();\n          const sourceNode = this.sourceNodes.get(sourceId);\n          const dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n          if (dragPreview) {\n            const {\n              anchorX,\n              anchorY,\n              offsetX,\n              offsetY\n            } = this.getCurrentSourcePreviewNodeOptions();\n            const anchorPoint = {\n              anchorX,\n              anchorY\n            };\n            const offsetPoint = {\n              offsetX,\n              offsetY\n            };\n            const dragPreviewOffset = getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n            dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n          }\n        }\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer === null || dataTransfer === void 0 ? void 0 : dataTransfer.setData('application/json', {});\n        } catch (err) {// IE doesn't support MIME types in setData\n        } // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n        this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n        const {\n          captureDraggingState\n        } = this.getCurrentSourcePreviewNodeOptions();\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(() => this.actions.publishDragSource(), 0);\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        this.beginDragNativeItem(nativeType);\n      } else if (dataTransfer && !dataTransfer.types && (e.target && !e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return;\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    };\n    this.handleTopDragEndCapture = () => {\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        this.actions.endDrag();\n      }\n      this.cancelHover();\n    };\n    this.handleTopDragEnterCapture = e => {\n      this.dragEnterTargetIds = [];\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n      const isFirstEnter = this.enterLeaveCounter.enter(e.target);\n      if (!isFirstEnter || this.monitor.isDragging()) {\n        return;\n      }\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        this.beginDragNativeItem(nativeType, dataTransfer);\n      }\n    };\n    this.handleTopDragEnter = e => {\n      const {\n        dragEnterTargetIds\n      } = this;\n      this.dragEnterTargetIds = [];\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n      this.altKeyPressed = e.altKey; // If the target changes position as the result of `dragenter`, `dragover` might still\n      // get dispatched despite target being no longer there. The easy solution is to check\n      // whether there actually is a target before firing `hover`.\n\n      if (dragEnterTargetIds.length > 0) {\n        this.actions.hover(dragEnterTargetIds, {\n          clientOffset: getEventClientOffset$1(e)\n        });\n      }\n      const canDrop = dragEnterTargetIds.some(targetId => this.monitor.canDropOnTarget(targetId));\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      }\n    };\n    this.handleTopDragOverCapture = e => {\n      this.dragOverTargetIds = [];\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n    };\n    this.handleTopDragOver = e => {\n      const {\n        dragOverTargetIds\n      } = this;\n      this.dragOverTargetIds = [];\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n        return;\n      }\n      this.altKeyPressed = e.altKey;\n      this.lastClientOffset = getEventClientOffset$1(e);\n      this.scheduleHover(dragOverTargetIds);\n      const canDrop = (dragOverTargetIds || []).some(targetId => this.monitor.canDropOnTarget(targetId));\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      } else if (this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n      }\n    };\n    this.handleTopDragLeaveCapture = e => {\n      if (this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n      const isLastLeave = this.enterLeaveCounter.leave(e.target);\n      if (!isLastLeave) {\n        return;\n      }\n      if (this.isDraggingNativeItem()) {\n        setTimeout(() => this.endDragNativeItem(), 0);\n      }\n      this.cancelHover();\n    };\n    this.handleTopDropCapture = e => {\n      this.dropTargetIds = [];\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        e.preventDefault();\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      } else if (matchNativeItemType(e.dataTransfer)) {\n        // Dragging some elements, like <a> and <img> may still behave like a native drag event,\n        // even if the current drag event matches a user-defined type.\n        // Stop the default behavior when we're not expecting a native item to be dropped.\n        e.preventDefault();\n      }\n      this.enterLeaveCounter.reset();\n    };\n    this.handleTopDrop = e => {\n      const {\n        dropTargetIds\n      } = this;\n      this.dropTargetIds = [];\n      this.actions.hover(dropTargetIds, {\n        clientOffset: getEventClientOffset$1(e)\n      });\n      this.actions.drop({\n        dropEffect: this.getCurrentDropEffect()\n      });\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      } else if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n      this.cancelHover();\n    };\n    this.handleSelectStart = e => {\n      const target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n      e.preventDefault();\n      target.dragDrop();\n    };\n    this.options = new OptionsReader$1(globalContext, options);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.enterLeaveCounter = new EnterLeaveCounter(this.isNodeInDocument);\n  }\n}\nlet emptyImage;\nfunction getEmptyImage() {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    emptyImage.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n  return emptyImage;\n}\nconst HTML5Backend = function createBackend(manager, context, options) {\n  return new HTML5BackendImpl(manager, context, options);\n};\nvar ListenerType;\n(function (ListenerType) {\n  ListenerType[\"mouse\"] = \"mouse\";\n  ListenerType[\"touch\"] = \"touch\";\n  ListenerType[\"keyboard\"] = \"keyboard\";\n})(ListenerType || (ListenerType = {}));\nclass OptionsReader {\n  get delay() {\n    var _delay;\n    return (_delay = this.args.delay) !== null && _delay !== void 0 ? _delay : 0;\n  }\n  get scrollAngleRanges() {\n    return this.args.scrollAngleRanges;\n  }\n  get getDropTargetElementsAtPoint() {\n    return this.args.getDropTargetElementsAtPoint;\n  }\n  get ignoreContextMenu() {\n    var _ignoreContextMenu;\n    return (_ignoreContextMenu = this.args.ignoreContextMenu) !== null && _ignoreContextMenu !== void 0 ? _ignoreContextMenu : false;\n  }\n  get enableHoverOutsideTarget() {\n    var _enableHoverOutsideTarget;\n    return (_enableHoverOutsideTarget = this.args.enableHoverOutsideTarget) !== null && _enableHoverOutsideTarget !== void 0 ? _enableHoverOutsideTarget : false;\n  }\n  get enableKeyboardEvents() {\n    var _enableKeyboardEvents;\n    return (_enableKeyboardEvents = this.args.enableKeyboardEvents) !== null && _enableKeyboardEvents !== void 0 ? _enableKeyboardEvents : false;\n  }\n  get enableMouseEvents() {\n    var _enableMouseEvents;\n    return (_enableMouseEvents = this.args.enableMouseEvents) !== null && _enableMouseEvents !== void 0 ? _enableMouseEvents : false;\n  }\n  get enableTouchEvents() {\n    var _enableTouchEvents;\n    return (_enableTouchEvents = this.args.enableTouchEvents) !== null && _enableTouchEvents !== void 0 ? _enableTouchEvents : true;\n  }\n  get touchSlop() {\n    return this.args.touchSlop || 0;\n  }\n  get delayTouchStart() {\n    var ref, ref1;\n    var ref2, ref3;\n    return (ref3 = (ref2 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayTouchStart) !== null && ref2 !== void 0 ? ref2 : (ref1 = this.args) === null || ref1 === void 0 ? void 0 : ref1.delay) !== null && ref3 !== void 0 ? ref3 : 0;\n  }\n  get delayMouseStart() {\n    var ref, ref4;\n    var ref5, ref6;\n    return (ref6 = (ref5 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayMouseStart) !== null && ref5 !== void 0 ? ref5 : (ref4 = this.args) === null || ref4 === void 0 ? void 0 : ref4.delay) !== null && ref6 !== void 0 ? ref6 : 0;\n  }\n  get window() {\n    if (this.context && this.context.window) {\n      return this.context.window;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n    return undefined;\n  }\n  get document() {\n    var ref;\n    if ((ref = this.context) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.context.document;\n    }\n    if (this.window) {\n      return this.window.document;\n    }\n    return undefined;\n  }\n  get rootElement() {\n    var ref;\n    return ((ref = this.args) === null || ref === void 0 ? void 0 : ref.rootElement) || this.document;\n  }\n  constructor(args, context) {\n    this.args = args;\n    this.context = context;\n  }\n}\nfunction distance(x1, y1, x2, y2) {\n  return Math.sqrt(Math.pow(Math.abs(x2 - x1), 2) + Math.pow(Math.abs(y2 - y1), 2));\n}\nfunction inAngleRanges(x1, y1, x2, y2, angleRanges) {\n  if (!angleRanges) {\n    return false;\n  }\n  const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI + 180;\n  for (let i = 0; i < angleRanges.length; ++i) {\n    const ar = angleRanges[i];\n    if (ar && (ar.start == null || angle >= ar.start) && (ar.end == null || angle <= ar.end)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// Used for MouseEvent.buttons (note the s on the end).\nconst MouseButtons = {\n  Left: 1,\n  Right: 2,\n  Center: 4\n}; // Used for e.button (note the lack of an s on the end).\n\nconst MouseButton = {\n  Left: 0,\n  Center: 1,\n  Right: 2\n};\n/**\n * Only touch events and mouse events where the left button is pressed should initiate a drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldStartDrag(e) {\n  // For touch events, button will be undefined. If e.button is defined,\n  // then it should be MouseButton.Left.\n  return e.button === undefined || e.button === MouseButton.Left;\n}\n/**\n * Only touch events and mouse events where the left mouse button is no longer held should end a drag.\n * It's possible the user mouse downs with the left mouse button, then mouse down and ups with the right mouse button.\n * We don't want releasing the right mouse button to end the drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldEndDrag(e) {\n  // Touch events will have buttons be undefined, while mouse events will have e.buttons's left button\n  // bit field unset if the left mouse button has been released\n  return e.buttons === undefined || (e.buttons & MouseButtons.Left) === 0;\n}\nfunction isTouchEvent(e) {\n  return !!e.targetTouches;\n}\nconst ELEMENT_NODE = 1;\nfunction getNodeClientOffset(node) {\n  const el = node.nodeType === ELEMENT_NODE ? node : node.parentElement;\n  if (!el) {\n    return undefined;\n  }\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientTouchOffset(e, lastTargetTouchFallback) {\n  if (e.targetTouches.length === 1) {\n    return getEventClientOffset(e.targetTouches[0]);\n  } else if (lastTargetTouchFallback && e.touches.length === 1) {\n    if (e.touches[0].target === lastTargetTouchFallback.target) {\n      return getEventClientOffset(e.touches[0]);\n    }\n  }\n  return;\n}\nfunction getEventClientOffset(e, lastTargetTouchFallback) {\n  if (isTouchEvent(e)) {\n    return getEventClientTouchOffset(e, lastTargetTouchFallback);\n  } else {\n    return {\n      x: e.clientX,\n      y: e.clientY\n    };\n  }\n}\nconst supportsPassive = (() => {\n  // simular to jQuery's test\n  let supported = false;\n  try {\n    addEventListener('test', () => {// do nothing\n    }, Object.defineProperty({}, 'passive', {\n      get() {\n        supported = true;\n        return true;\n      }\n    }));\n  } catch (e) {// do nothing\n  }\n  return supported;\n})();\nconst eventNames = {\n  [ListenerType.mouse]: {\n    start: 'mousedown',\n    move: 'mousemove',\n    end: 'mouseup',\n    contextmenu: 'contextmenu'\n  },\n  [ListenerType.touch]: {\n    start: 'touchstart',\n    move: 'touchmove',\n    end: 'touchend'\n  },\n  [ListenerType.keyboard]: {\n    keydown: 'keydown'\n  }\n};\nclass TouchBackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref;\n    return {\n      sourceNodes: this.sourceNodes.size,\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      targetNodes: this.targetNodes.size,\n      dragOverTargetIds: ((ref = this.dragOverTargetIds) === null || ref === void 0 ? void 0 : ref.length) || 0\n    };\n  } // public for test\n\n  get document() {\n    return this.options.document;\n  }\n  setup() {\n    const root = this.options.rootElement;\n    if (!root) {\n      return;\n    }\n    invariant(!TouchBackendImpl.isSetUp, 'Cannot have two Touch backends at the same time.');\n    TouchBackendImpl.isSetUp = true;\n    this.addEventListener(root, 'start', this.getTopMoveStartHandler());\n    this.addEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.addEventListener(root, 'move', this.handleTopMove);\n    this.addEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.addEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.addEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n    if (this.options.enableKeyboardEvents) {\n      this.addEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n  }\n  teardown() {\n    const root = this.options.rootElement;\n    if (!root) {\n      return;\n    }\n    TouchBackendImpl.isSetUp = false;\n    this._mouseClientOffset = {};\n    this.removeEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.removeEventListener(root, 'start', this.handleTopMoveStart);\n    this.removeEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.removeEventListener(root, 'move', this.handleTopMove);\n    this.removeEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.removeEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n    if (this.options.enableKeyboardEvents) {\n      this.removeEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n    this.uninstallSourceNodeRemovalObserver();\n  }\n  addEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n      if (evt) {\n        subject.addEventListener(evt, handler, options);\n      }\n    });\n  }\n  removeEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n      if (evt) {\n        subject.removeEventListener(evt, handler, options);\n      }\n    });\n  }\n  connectDragSource(sourceId, node) {\n    const handleMoveStart = this.handleMoveStart.bind(this, sourceId);\n    this.sourceNodes.set(sourceId, node);\n    this.addEventListener(node, 'start', handleMoveStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.removeEventListener(node, 'start', handleMoveStart);\n    };\n  }\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n  connectDropTarget(targetId, node) {\n    const root = this.options.rootElement;\n    if (!this.document || !root) {\n      return () => {\n        /* noop */\n      };\n    }\n    const handleMove = e => {\n      if (!this.document || !root || !this.monitor.isDragging()) {\n        return;\n      }\n      let coords;\n      /**\n      * Grab the coordinates for the current mouse/touch position\n      */\n\n      switch (e.type) {\n        case eventNames.mouse.move:\n          coords = {\n            x: e.clientX,\n            y: e.clientY\n          };\n          break;\n        case eventNames.touch.move:\n          var ref, ref1;\n          coords = {\n            x: ((ref = e.touches[0]) === null || ref === void 0 ? void 0 : ref.clientX) || 0,\n            y: ((ref1 = e.touches[0]) === null || ref1 === void 0 ? void 0 : ref1.clientY) || 0\n          };\n          break;\n      }\n      /**\n      * Use the coordinates to grab the element the drag ended on.\n      * If the element is the same as the target node (or any of it's children) then we have hit a drop target and can handle the move.\n      */\n\n      const droppedOn = coords != null ? this.document.elementFromPoint(coords.x, coords.y) : undefined;\n      const childMatch = droppedOn && node.contains(droppedOn);\n      if (droppedOn === node || childMatch) {\n        return this.handleMove(e, targetId);\n      }\n    };\n    /**\n    * Attaching the event listener to the body so that touchmove will work while dragging over multiple target elements.\n    */\n\n    this.addEventListener(this.document.body, 'move', handleMove);\n    this.targetNodes.set(targetId, node);\n    return () => {\n      if (this.document) {\n        this.targetNodes.delete(targetId);\n        this.removeEventListener(this.document.body, 'move', handleMove);\n      }\n    };\n  }\n  getTopMoveStartHandler() {\n    if (!this.options.delayTouchStart && !this.options.delayMouseStart) {\n      return this.handleTopMoveStart;\n    }\n    return this.handleTopMoveStartDelay;\n  }\n  installSourceNodeRemovalObserver(node) {\n    this.uninstallSourceNodeRemovalObserver();\n    this.draggedSourceNode = node;\n    this.draggedSourceNodeRemovalObserver = new MutationObserver(() => {\n      if (node && !node.parentElement) {\n        this.resurrectSourceNode();\n        this.uninstallSourceNodeRemovalObserver();\n      }\n    });\n    if (!node || !node.parentElement) {\n      return;\n    }\n    this.draggedSourceNodeRemovalObserver.observe(node.parentElement, {\n      childList: true\n    });\n  }\n  resurrectSourceNode() {\n    if (this.document && this.draggedSourceNode) {\n      this.draggedSourceNode.style.display = 'none';\n      this.draggedSourceNode.removeAttribute('data-reactid');\n      this.document.body.appendChild(this.draggedSourceNode);\n    }\n  }\n  uninstallSourceNodeRemovalObserver() {\n    if (this.draggedSourceNodeRemovalObserver) {\n      this.draggedSourceNodeRemovalObserver.disconnect();\n    }\n    this.draggedSourceNodeRemovalObserver = undefined;\n    this.draggedSourceNode = undefined;\n  }\n  constructor(manager, context, options) {\n    this.getSourceClientOffset = sourceId => {\n      const element = this.sourceNodes.get(sourceId);\n      return element && getNodeClientOffset(element);\n    };\n    this.handleTopMoveStartCapture = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n      this.moveStartSourceIds = [];\n    };\n    this.handleMoveStart = sourceId => {\n      // Just because we received an event doesn't necessarily mean we need to collect drag sources.\n      // We only collect start collecting drag sources on touch and left mouse events.\n      if (Array.isArray(this.moveStartSourceIds)) {\n        this.moveStartSourceIds.unshift(sourceId);\n      }\n    };\n    this.handleTopMoveStart = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      } // Don't prematurely preventDefault() here since it might:\n      // 1. Mess up scrolling\n      // 2. Mess up long tap (which brings up context menu)\n      // 3. If there's an anchor link as a child, tap won't be triggered on link\n\n      const clientOffset = getEventClientOffset(e);\n      if (clientOffset) {\n        if (isTouchEvent(e)) {\n          this.lastTargetTouchFallback = e.targetTouches[0];\n        }\n        this._mouseClientOffset = clientOffset;\n      }\n      this.waitingForDelay = false;\n    };\n    this.handleTopMoveStartDelay = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n      const delay = e.type === eventNames.touch.start ? this.options.delayTouchStart : this.options.delayMouseStart;\n      this.timeout = setTimeout(this.handleTopMoveStart.bind(this, e), delay);\n      this.waitingForDelay = true;\n    };\n    this.handleTopMoveCapture = () => {\n      this.dragOverTargetIds = [];\n    };\n    this.handleMove = (_evt, targetId) => {\n      if (this.dragOverTargetIds) {\n        this.dragOverTargetIds.unshift(targetId);\n      }\n    };\n    this.handleTopMove = e1 => {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n      if (!this.document || this.waitingForDelay) {\n        return;\n      }\n      const {\n        moveStartSourceIds,\n        dragOverTargetIds\n      } = this;\n      const enableHoverOutsideTarget = this.options.enableHoverOutsideTarget;\n      const clientOffset = getEventClientOffset(e1, this.lastTargetTouchFallback);\n      if (!clientOffset) {\n        return;\n      } // If the touch move started as a scroll, or is is between the scroll angles\n\n      if (this._isScrolling || !this.monitor.isDragging() && inAngleRanges(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y, this.options.scrollAngleRanges)) {\n        this._isScrolling = true;\n        return;\n      } // If we're not dragging and we've moved a little, that counts as a drag start\n\n      if (!this.monitor.isDragging() &&\n      // eslint-disable-next-line no-prototype-builtins\n      this._mouseClientOffset.hasOwnProperty('x') && moveStartSourceIds && distance(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y) > (this.options.touchSlop ? this.options.touchSlop : 0)) {\n        this.moveStartSourceIds = undefined;\n        this.actions.beginDrag(moveStartSourceIds, {\n          clientOffset: this._mouseClientOffset,\n          getSourceClientOffset: this.getSourceClientOffset,\n          publishSource: false\n        });\n      }\n      if (!this.monitor.isDragging()) {\n        return;\n      }\n      const sourceNode = this.sourceNodes.get(this.monitor.getSourceId());\n      this.installSourceNodeRemovalObserver(sourceNode);\n      this.actions.publishDragSource();\n      if (e1.cancelable) e1.preventDefault(); // Get the node elements of the hovered DropTargets\n\n      const dragOverTargetNodes = (dragOverTargetIds || []).map(key => this.targetNodes.get(key)).filter(e => !!e); // Get the a ordered list of nodes that are touched by\n\n      const elementsAtPoint = this.options.getDropTargetElementsAtPoint ? this.options.getDropTargetElementsAtPoint(clientOffset.x, clientOffset.y, dragOverTargetNodes) : this.document.elementsFromPoint(clientOffset.x, clientOffset.y); // Extend list with parents that are not receiving elementsFromPoint events (size 0 elements and svg groups)\n\n      const elementsAtPointExtended = [];\n      for (const nodeId in elementsAtPoint) {\n        // eslint-disable-next-line no-prototype-builtins\n        if (!elementsAtPoint.hasOwnProperty(nodeId)) {\n          continue;\n        }\n        let currentNode = elementsAtPoint[nodeId];\n        if (currentNode != null) {\n          elementsAtPointExtended.push(currentNode);\n        }\n        while (currentNode) {\n          currentNode = currentNode.parentElement;\n          if (currentNode && elementsAtPointExtended.indexOf(currentNode) === -1) {\n            elementsAtPointExtended.push(currentNode);\n          }\n        }\n      }\n      const orderedDragOverTargetIds = elementsAtPointExtended // Filter off nodes that arent a hovered DropTargets nodes\n      .filter(node => dragOverTargetNodes.indexOf(node) > -1) // Map back the nodes elements to targetIds\n      .map(node => this._getDropTargetId(node)) // Filter off possible null rows\n      .filter(node => !!node).filter((id, index, ids) => ids.indexOf(id) === index); // Invoke hover for drop targets when source node is still over and pointer is outside\n\n      if (enableHoverOutsideTarget) {\n        for (const targetId in this.targetNodes) {\n          const targetNode = this.targetNodes.get(targetId);\n          if (sourceNode && targetNode && targetNode.contains(sourceNode) && orderedDragOverTargetIds.indexOf(targetId) === -1) {\n            orderedDragOverTargetIds.unshift(targetId);\n            break;\n          }\n        }\n      } // Reverse order because dnd-core reverse it before calling the DropTarget drop methods\n\n      orderedDragOverTargetIds.reverse();\n      this.actions.hover(orderedDragOverTargetIds, {\n        clientOffset: clientOffset\n      });\n    };\n    /**\n    *\n    * visible for testing\n    */\n\n    this._getDropTargetId = node => {\n      const keys = this.targetNodes.keys();\n      let next = keys.next();\n      while (next.done === false) {\n        const targetId = next.value;\n        if (node === this.targetNodes.get(targetId)) {\n          return targetId;\n        } else {\n          next = keys.next();\n        }\n      }\n      return undefined;\n    };\n    this.handleTopMoveEndCapture = e => {\n      this._isScrolling = false;\n      this.lastTargetTouchFallback = undefined;\n      if (!eventShouldEndDrag(e)) {\n        return;\n      }\n      if (!this.monitor.isDragging() || this.monitor.didDrop()) {\n        this.moveStartSourceIds = undefined;\n        return;\n      }\n      if (e.cancelable) e.preventDefault();\n      this._mouseClientOffset = {};\n      this.uninstallSourceNodeRemovalObserver();\n      this.actions.drop();\n      this.actions.endDrag();\n    };\n    this.handleCancelOnEscape = e => {\n      if (e.key === 'Escape' && this.monitor.isDragging()) {\n        this._mouseClientOffset = {};\n        this.uninstallSourceNodeRemovalObserver();\n        this.actions.endDrag();\n      }\n    };\n    this.options = new OptionsReader(options, context);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.sourceNodes = new Map();\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.targetNodes = new Map();\n    this.listenerTypes = [];\n    this._mouseClientOffset = {};\n    this._isScrolling = false;\n    if (this.options.enableMouseEvents) {\n      this.listenerTypes.push(ListenerType.mouse);\n    }\n    if (this.options.enableTouchEvents) {\n      this.listenerTypes.push(ListenerType.touch);\n    }\n    if (this.options.enableKeyboardEvents) {\n      this.listenerTypes.push(ListenerType.keyboard);\n    }\n  }\n}\nconst TouchBackend = function createBackend(manager, context = {}, options = {}) {\n  return new TouchBackendImpl(manager, context, options);\n};\nconst COLUMNS = 'abcdefgh'.split('');\nconst chessboardDefaultProps = {\n  animationDuration: 300,\n  areArrowsAllowed: true,\n  arePiecesDraggable: true,\n  arePremovesAllowed: false,\n  boardOrientation: 'white',\n  boardWidth: 560,\n  clearPremovesOnRightClick: true,\n  customArrows: [],\n  customArrowColor: 'rgb(255,170,0)',\n  customBoardStyle: {},\n  customDarkSquareStyle: {\n    backgroundColor: '#B58863'\n  },\n  customDndBackend: undefined,\n  customDndBackendOptions: undefined,\n  customDropSquareStyle: {\n    boxShadow: 'inset 0 0 1px 6px rgba(255,255,255,0.75)'\n  },\n  customLightSquareStyle: {\n    backgroundColor: '#F0D9B5'\n  },\n  customPieces: {},\n  customPremoveDarkSquareStyle: {\n    backgroundColor: '#A42323'\n  },\n  customPremoveLightSquareStyle: {\n    backgroundColor: '#BD2828'\n  },\n  customSquareStyles: {},\n  dropOffBoardAction: 'snapback',\n  id: 0,\n  isDraggablePiece: () => true,\n  getPositionObject: () => {},\n  onArrowsChange: () => {},\n  onDragOverSquare: () => {},\n  onMouseOutSquare: () => {},\n  onMouseOverSquare: () => {},\n  onPieceClick: () => {},\n  onPieceDragBegin: () => {},\n  onPieceDragEnd: () => {},\n  onPieceDrop: () => true,\n  onSquareClick: () => {},\n  onSquareRightClick: () => {},\n  position: 'start',\n  showBoardNotation: true,\n  // showSparePieces: false,\n  snapToCursor: true\n};\nconst startPositionObject = {\n  a8: 'bR',\n  b8: 'bN',\n  c8: 'bB',\n  d8: 'bQ',\n  e8: 'bK',\n  f8: 'bB',\n  g8: 'bN',\n  h8: 'bR',\n  a7: 'bP',\n  b7: 'bP',\n  c7: 'bP',\n  d7: 'bP',\n  e7: 'bP',\n  f7: 'bP',\n  g7: 'bP',\n  h7: 'bP',\n  a2: 'wP',\n  b2: 'wP',\n  c2: 'wP',\n  d2: 'wP',\n  e2: 'wP',\n  f2: 'wP',\n  g2: 'wP',\n  h2: 'wP',\n  a1: 'wR',\n  b1: 'wN',\n  c1: 'wB',\n  d1: 'wQ',\n  e1: 'wK',\n  f1: 'wB',\n  g1: 'wN',\n  h1: 'wR'\n};\nconst whiteColumnValues = {\n  a: 0,\n  b: 1,\n  c: 2,\n  d: 3,\n  e: 4,\n  f: 5,\n  g: 6,\n  h: 7\n};\nconst blackColumnValues = {\n  a: 7,\n  b: 6,\n  c: 5,\n  d: 4,\n  e: 3,\n  f: 2,\n  g: 1,\n  h: 0\n};\nconst whiteRows = [7, 6, 5, 4, 3, 2, 1, 0];\nconst blackRows = [0, 1, 2, 3, 4, 5, 6, 7];\nconst getRelativeCoords = (boardOrientation, boardWidth, square) => {\n  const squareWidth = boardWidth / 8;\n  const columns = boardOrientation === 'white' ? whiteColumnValues : blackColumnValues;\n  const rows = boardOrientation === 'white' ? whiteRows : blackRows;\n  const x = columns[square[0]] * squareWidth + squareWidth / 2;\n  const y = rows[square[1] - 1] * squareWidth + squareWidth / 2;\n  return {\n    x,\n    y\n  };\n};\nconst isDifferentFromStart = newPosition => {\n  let isDifferent = false;\n  Object.keys(startPositionObject).forEach(square => {\n    if (newPosition[square] !== startPositionObject[square]) isDifferent = true;\n  });\n  Object.keys(newPosition).forEach(square => {\n    if (startPositionObject[square] !== newPosition[square]) isDifferent = true;\n  });\n  return isDifferent;\n};\nconst getPositionDifferences = (currentPosition, newPosition) => {\n  const difference = {\n    removed: {},\n    added: {}\n  }; // removed from current\n\n  Object.keys(currentPosition).forEach(square => {\n    if (newPosition[square] !== currentPosition[square]) difference.removed[square] = currentPosition[square];\n  }); // added from new\n\n  Object.keys(newPosition).forEach(square => {\n    if (currentPosition[square] !== newPosition[square]) difference.added[square] = newPosition[square];\n  });\n  return difference;\n};\nfunction isString(s) {\n  return typeof s === 'string';\n}\nfunction convertPositionToObject(position) {\n  if (position === 'start') return fenToObj('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR');\n  if (validFen(position)) return fenToObj(position);\n  if (validPositionObject(position)) return position;\n  return {};\n}\nfunction fenToObj(fen) {\n  if (!validFen(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, '');\n  const rows = fen.split('/');\n  const position = {};\n  let currentRow = 8;\n  for (let i = 0; i < 8; i++) {\n    const row = rows[i].split('');\n    let colIdx = 0; // loop through each character in the FEN section\n\n    for (let j = 0; j < row.length; j++) {\n      // number / empty squares\n      if (row[j].search(/[1-8]/) !== -1) {\n        const numEmptySquares = parseInt(row[j], 10);\n        colIdx = colIdx + numEmptySquares;\n      } else {\n        // piece\n        const square = COLUMNS[colIdx] + currentRow;\n        position[square] = fenToPieceCode(row[j]);\n        colIdx = colIdx + 1;\n      }\n    }\n    currentRow = currentRow - 1;\n  }\n  return position;\n}\nfunction expandFenEmptySquares(fen) {\n  return fen.replace(/8/g, '11111111').replace(/7/g, '1111111').replace(/6/g, '111111').replace(/5/g, '11111').replace(/4/g, '1111').replace(/3/g, '111').replace(/2/g, '11');\n}\nfunction validFen(fen) {\n  if (!isString(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, ''); // expand the empty square numbers to just 1s\n\n  fen = expandFenEmptySquares(fen); // FEN should be 8 sections separated by slashes\n\n  const chunks = fen.split('/');\n  if (chunks.length !== 8) return false; // check each section\n\n  for (let i = 0; i < 8; i++) {\n    if (chunks[i].length !== 8 || chunks[i].search(/[^kqrnbpKQRNBP1]/) !== -1) {\n      return false;\n    }\n  }\n  return true;\n} // convert FEN piece code to bP, wK, etc\n\nfunction fenToPieceCode(piece) {\n  // black piece\n  if (piece.toLowerCase() === piece) {\n    return 'b' + piece.toUpperCase();\n  } // white piece\n\n  return 'w' + piece.toUpperCase();\n}\nfunction validSquare(square) {\n  return isString(square) && square.search(/^[a-h][1-8]$/) !== -1;\n}\nfunction validPieceCode(code) {\n  return isString(code) && code.search(/^[bw][KQRNBP]$/) !== -1;\n}\nfunction validPositionObject(pos) {\n  if (pos === null || typeof pos !== 'object') return false;\n  for (const i in pos) {\n    if (!pos[i]) continue;\n    if (!validSquare(i) || !validPieceCode(pos[i])) {\n      return false;\n    }\n  }\n  return true;\n}\nconst defaultPieces = {\n  wP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  wR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 34,14 L 31,17 L 14,17 L 11,14\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,17 L 31,29.5 L 14,29.5 L 14,17\",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  wB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#ffffff',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,33.5 C 18,32.5 27,32.5 33,33.5\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      })]\n    })\n  }),\n  wK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  bP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  bR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,35.5 L 33,35.5 L 33,35.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 13,31.5 L 32,31.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 31,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 31,16.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \",\n        style: {\n          fill: '#ffffff',\n          stroke: 'none'\n        }\n      })]\n    })\n  }),\n  bB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#000000',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#000000',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\",\n        style: {\n          strokeLinecap: 'butt',\n          fill: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 12,33.5 c 6,-1 15,-1 21,0\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,38.5 A 35,35 1 0 0 34,38.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 11,29 A 35,35 1 0 1 34,29\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 12.5,31.5 L 32.5,31.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"\n        })]\n      })]\n    })\n  }),\n  bK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        },\n        id: \"path6570\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#000000',\n          fillOpacity: '1',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      })]\n    })\n  })\n};\nconst ChessboardContext = /*#__PURE__*/React.createContext();\nconst useChessboard = () => useContext(ChessboardContext);\nconst ChessboardProvider = /*#__PURE__*/forwardRef(({\n  animationDuration,\n  areArrowsAllowed,\n  arePiecesDraggable,\n  arePremovesAllowed,\n  boardOrientation,\n  boardWidth,\n  clearPremovesOnRightClick,\n  customArrows,\n  customArrowColor,\n  customBoardStyle,\n  customDarkSquareStyle,\n  customDropSquareStyle,\n  customLightSquareStyle,\n  customPieces,\n  customPremoveDarkSquareStyle,\n  customPremoveLightSquareStyle,\n  customSquareStyles,\n  dropOffBoardAction,\n  id,\n  isDraggablePiece,\n  getPositionObject,\n  onArrowsChange,\n  onDragOverSquare,\n  onMouseOutSquare,\n  onMouseOverSquare,\n  onPieceClick,\n  onPieceDragBegin,\n  onPieceDragEnd,\n  onPieceDrop,\n  onSquareClick,\n  onSquareRightClick,\n  position,\n  showBoardNotation,\n  showSparePieces,\n  snapToCursor,\n  children\n}, ref) => {\n  // position stored and displayed on board\n  const [currentPosition, setCurrentPosition] = useState(convertPositionToObject(position)); // calculated differences between current and incoming positions\n\n  const [positionDifferences, setPositionDifferences] = useState({}); // colour of last piece moved to determine if premoving\n\n  const [lastPieceColour, setLastPieceColour] = useState(undefined); // current premoves\n\n  const [premoves, setPremoves] = useState([]); // ref used to access current value during timeouts (closures)\n\n  const premovesRef = useRef(premoves); // current right mouse down square\n\n  const [currentRightClickDown, setCurrentRightClickDown] = useState(); // current arrows\n\n  const [arrows, setArrows] = useState([]); // chess pieces/styling\n\n  const [chessPieces, setChessPieces] = useState({\n    ...defaultPieces,\n    ...customPieces\n  }); // whether the last move was a manual drop or not\n\n  const [manualDrop, setManualDrop] = useState(false); // the most recent timeout whilst waiting for animation to complete\n\n  const [previousTimeout, setPreviousTimeout] = useState(undefined); // if currently waiting for an animation to finish\n\n  const [waitingForAnimation, setWaitingForAnimation] = useState(false); // open clearPremoves() to allow user to call on undo/reset/whenever\n\n  useImperativeHandle(ref, () => ({\n    clearPremoves(clearLastPieceColour = true) {\n      clearPremoves(clearLastPieceColour);\n    }\n  })); // handle custom pieces change\n\n  useEffect(() => {\n    setChessPieces({\n      ...defaultPieces,\n      ...customPieces\n    });\n  }, [customPieces]); // handle external position change\n\n  useEffect(() => {\n    var _Object$keys, _Object$entries, _Object$entries$;\n    const newPosition = convertPositionToObject(position);\n    const differences = getPositionDifferences(currentPosition, newPosition);\n    const newPieceColour = ((_Object$keys = Object.keys(differences.added)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.length) <= 2 ? (_Object$entries = Object.entries(differences.added)) === null || _Object$entries === void 0 ? void 0 : (_Object$entries$ = _Object$entries[0]) === null || _Object$entries$ === void 0 ? void 0 : _Object$entries$[1][0] : undefined; // external move has come in before animation is over\n    // cancel animation and immediately update position\n\n    if (waitingForAnimation) {\n      setCurrentPosition(newPosition);\n      setWaitingForAnimation(false);\n      arePremovesAllowed && attemptPremove(newPieceColour);\n      if (previousTimeout) {\n        clearTimeout(previousTimeout);\n      }\n    } else {\n      // move was made using drag and drop\n      if (manualDrop) {\n        setCurrentPosition(newPosition);\n        setWaitingForAnimation(false);\n        arePremovesAllowed && attemptPremove(newPieceColour);\n      } else {\n        // move was made by external position change\n        // if position === start then don't override newPieceColour\n        // needs isDifferentFromStart in scenario where premoves have been cleared upon board reset but first move is made by computer, the last move colour would need to be updated\n        if (isDifferentFromStart(newPosition) && lastPieceColour !== undefined) {\n          setLastPieceColour(newPieceColour);\n        } else {\n          // position === start, likely a board reset\n          setLastPieceColour(undefined);\n        }\n        setPositionDifferences(differences); // animate external move\n\n        setWaitingForAnimation(true);\n        const newTimeout = setTimeout(() => {\n          setCurrentPosition(newPosition);\n          setWaitingForAnimation(false);\n          arePremovesAllowed && attemptPremove(newPieceColour);\n        }, animationDuration);\n        setPreviousTimeout(newTimeout);\n      }\n    } // reset manual drop, ready for next move to be made by user or external\n\n    setManualDrop(false); // inform latest position information\n\n    getPositionObject(newPosition); // clear arrows\n\n    clearArrows(); // clear timeout on unmount\n\n    return () => {\n      clearTimeout(previousTimeout);\n    };\n  }, [position]); // handle external arrows change\n\n  useEffect(() => {\n    setArrows(customArrows);\n  }, [customArrows]); // callback when new arrows are set\n\n  useEffect(() => {\n    onArrowsChange(arrows);\n  }, [arrows]); // handle drop position change\n\n  function handleSetPosition(sourceSq, targetSq, piece) {\n    // if dropped back down, don't do anything\n    if (sourceSq === targetSq) {\n      return;\n    }\n    clearArrows(); // if second move is made for same colour, or there are still premoves queued, then this move needs to be added to premove queue instead of played\n    // premoves length check for colour is added in because white could make 3 premoves, and then black responds to the first move (changing the last piece colour) and then white pre-moves again\n\n    if (arePremovesAllowed && waitingForAnimation || arePremovesAllowed && (lastPieceColour === piece[0] || premovesRef.current.filter(p => p.piece[0] === piece[0]).length > 0)) {\n      const oldPremoves = [...premovesRef.current];\n      oldPremoves.push({\n        sourceSq,\n        targetSq,\n        piece\n      });\n      premovesRef.current = oldPremoves;\n      setPremoves([...oldPremoves]);\n      return;\n    } // if transitioning, don't allow new drop\n\n    if (!arePremovesAllowed && waitingForAnimation) return;\n    const newOnDropPosition = {\n      ...currentPosition\n    };\n    setManualDrop(true);\n    setLastPieceColour(piece[0]); // if onPieceDrop function provided, execute it, position must be updated externally and captured by useEffect above for this move to show on board\n\n    if (onPieceDrop.length) {\n      const isValidMove = onPieceDrop(sourceSq, targetSq, piece);\n      if (!isValidMove) clearPremoves();\n    } else {\n      // delete if dropping off board\n      if (dropOffBoardAction === 'trash' && !targetSq) {\n        delete newOnDropPosition[sourceSq];\n      } // delete source piece if not dropping from spare piece\n\n      if (sourceSq !== 'spare') {\n        delete newOnDropPosition[sourceSq];\n      } // add piece in new position\n\n      newOnDropPosition[targetSq] = piece;\n      setCurrentPosition(newOnDropPosition);\n    } // inform latest position information\n\n    getPositionObject(newOnDropPosition);\n  }\n  function attemptPremove(newPieceColour) {\n    if (premovesRef.current.length === 0) return; // get current value of premove as this is called in a timeout so value may have changed since timeout was set\n\n    const premove = premovesRef.current[0]; // if premove is a differing colour to last move made, then this move can be made\n\n    if (premove.piece[0] !== undefined && premove.piece[0] !== newPieceColour && onPieceDrop.length) {\n      setLastPieceColour(premove.piece[0]);\n      setManualDrop(true); // pre-move doesn't need animation\n\n      const isValidMove = onPieceDrop(premove.sourceSq, premove.targetSq, premove.piece); // premove was successful and can be removed from queue\n\n      if (isValidMove) {\n        const oldPremoves = [...premovesRef.current];\n        oldPremoves.shift();\n        premovesRef.current = oldPremoves;\n        setPremoves([...oldPremoves]);\n      } else {\n        // premove wasn't successful, clear premove queue\n        clearPremoves();\n      }\n    }\n  }\n  function clearPremoves(clearLastPieceColour = true) {\n    // don't clear when right clicking to clear, otherwise you won't be able to premove again before next go\n    if (clearLastPieceColour) setLastPieceColour(undefined);\n    premovesRef.current = [];\n    setPremoves([]);\n  }\n  function onRightClickDown(square) {\n    setCurrentRightClickDown(square);\n  }\n  function onRightClickUp(square) {\n    if (!areArrowsAllowed) return;\n    if (currentRightClickDown) {\n      // same square, don't draw an arrow, but do clear premoves and run onSquareRightClick\n      if (currentRightClickDown === square) {\n        setCurrentRightClickDown(null);\n        clearPremovesOnRightClick && clearPremoves(false);\n        onSquareRightClick(square);\n        return;\n      } // if arrow already exists then it needs to be removed\n\n      for (const i in arrows) {\n        if (arrows[i][0] === currentRightClickDown && arrows[i][1] === square) {\n          setArrows(oldArrows => {\n            const newArrows = [...oldArrows];\n            newArrows.splice(i, 1);\n            return newArrows;\n          });\n          return;\n        }\n      } // different square, draw an arrow\n\n      setArrows(oldArrows => [...oldArrows, [currentRightClickDown, square]]);\n    } else setCurrentRightClickDown(null);\n  }\n  function clearCurrentRightClickDown() {\n    setCurrentRightClickDown(null);\n  }\n  function clearArrows() {\n    setArrows([]);\n  }\n  return /*#__PURE__*/jsx(ChessboardContext.Provider, {\n    value: {\n      animationDuration,\n      arePiecesDraggable,\n      arePremovesAllowed,\n      boardOrientation,\n      boardWidth,\n      customArrowColor,\n      customBoardStyle,\n      customDarkSquareStyle,\n      customDropSquareStyle,\n      customLightSquareStyle,\n      customPremoveDarkSquareStyle,\n      customPremoveLightSquareStyle,\n      customSquareStyles,\n      dropOffBoardAction,\n      id,\n      isDraggablePiece,\n      getPositionObject,\n      onDragOverSquare,\n      onMouseOutSquare,\n      onMouseOverSquare,\n      onPieceClick,\n      onPieceDragBegin,\n      onPieceDragEnd,\n      onPieceDrop,\n      onSquareClick,\n      onSquareRightClick,\n      showBoardNotation,\n      showSparePieces,\n      snapToCursor,\n      arrows,\n      chessPieces,\n      clearArrows,\n      clearCurrentRightClickDown,\n      clearPremoves,\n      currentPosition,\n      handleSetPosition,\n      lastPieceColour,\n      manualDrop,\n      onRightClickDown,\n      onRightClickUp,\n      positionDifferences,\n      premoves,\n      setChessPieces,\n      setCurrentPosition,\n      setManualDrop,\n      waitingForAnimation\n    },\n    children: children\n  });\n});\nfunction Notation({\n  row,\n  col\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customDarkSquareStyle,\n    customLightSquareStyle\n  } = useChessboard();\n  const whiteColor = customLightSquareStyle.backgroundColor;\n  const blackColor = customDarkSquareStyle.backgroundColor;\n  const isRow = col === 0;\n  const isColumn = row === 7;\n  const isBottomLeftSquare = isRow && isColumn;\n  function getRow() {\n    return boardOrientation === 'white' ? 8 - row : row + 1;\n  }\n  function getColumn() {\n    return boardOrientation === 'black' ? COLUMNS[7 - col] : COLUMNS[col];\n  }\n  function renderBottomLeft() {\n    return /*#__PURE__*/jsxs(Fragment, {\n      children: [/*#__PURE__*/jsx(\"div\", {\n        style: {\n          ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...numericStyle(boardWidth)\n        },\n        children: getRow()\n      }), /*#__PURE__*/jsx(\"div\", {\n        style: {\n          ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...alphaStyle(boardWidth)\n        },\n        children: getColumn()\n      })]\n    });\n  }\n  function renderLetters() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: {\n        ...notationStyle,\n        ...{\n          color: col % 2 !== 0 ? blackColor : whiteColor\n        },\n        ...alphaStyle(boardWidth)\n      },\n      children: getColumn()\n    });\n  }\n  function renderNumbers() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: {\n        ...notationStyle,\n        ...(boardOrientation === 'black' ? {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        } : {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        }),\n        ...numericStyle(boardWidth)\n      },\n      children: getRow()\n    });\n  }\n  if (isBottomLeftSquare) {\n    return renderBottomLeft();\n  }\n  if (isColumn) {\n    return renderLetters();\n  }\n  if (isRow) {\n    return renderNumbers();\n  }\n  return null;\n}\nconst alphaStyle = width => ({\n  alignSelf: 'flex-end',\n  paddingLeft: width / 8 - width / 48,\n  fontSize: width / 48\n});\nconst numericStyle = width => ({\n  alignSelf: 'flex-start',\n  paddingRight: width / 8 - width / 48,\n  fontSize: width / 48\n});\nconst notationStyle = {\n  zIndex: 3,\n  position: 'absolute'\n};\nfunction Piece({\n  piece,\n  square,\n  squares,\n  isPremovedPiece = false\n}) {\n  const {\n    animationDuration,\n    arePiecesDraggable,\n    arePremovesAllowed,\n    boardWidth,\n    id,\n    isDraggablePiece,\n    onPieceClick,\n    onPieceDragBegin,\n    onPieceDragEnd,\n    premoves,\n    chessPieces,\n    dropTarget,\n    positionDifferences,\n    waitingForAnimation,\n    currentPosition\n  } = useChessboard();\n  const [pieceStyle, setPieceStyle] = useState({\n    opacity: 1,\n    zIndex: 5,\n    touchAction: 'none',\n    cursor: arePiecesDraggable && isDraggablePiece({\n      piece,\n      sourceSquare: square\n    }) ? '-webkit-grab' : 'default'\n  });\n  const [{\n    canDrag,\n    isDragging\n  }, drag, dragPreview] = useDrag(() => ({\n    type: 'piece',\n    item: () => {\n      onPieceDragBegin(piece, square);\n      return {\n        piece,\n        square,\n        id\n      };\n    },\n    end: () => onPieceDragEnd(piece, square),\n    collect: monitor => ({\n      canDrag: isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }),\n      isDragging: !!monitor.isDragging()\n    })\n  }), [piece, square, currentPosition, id]); // hide the default preview\n\n  dragPreview(getEmptyImage(), {\n    captureDraggingState: true\n  }); // hide piece on drag\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({\n      ...oldPieceStyle,\n      opacity: isDragging ? 0 : 1\n    }));\n  }, [isDragging]); // hide piece on matching premoves\n\n  useEffect(() => {\n    // if premoves aren't allowed, don't waste time on calculations\n    if (!arePremovesAllowed) return;\n    let hidePiece = false; // side effect: if piece moves into pre-moved square, its hidden\n    // if there are any premove targets on this square, hide the piece underneath\n\n    if (!isPremovedPiece && premoves.find(p => p.targetSq === square)) hidePiece = true; // if sourceSq === sq and piece matches then this piece has been pre-moved elsewhere?\n\n    if (premoves.find(p => p.sourceSq === square && p.piece === piece)) hidePiece = true; // TODO: If a premoved piece returns to a premoved square, it will hide (e1, e2, e1)\n\n    setPieceStyle(oldPieceStyle => ({\n      ...oldPieceStyle,\n      display: hidePiece ? 'none' : 'unset'\n    }));\n  }, [currentPosition, premoves]); // new move has come in\n  // if waiting for animation, then animation has started and we can perform animation\n  // we need to head towards where we need to go, we are the source, we are heading towards the target\n\n  useEffect(() => {\n    var _positionDifferences$;\n    const removedPiece = (_positionDifferences$ = positionDifferences.removed) === null || _positionDifferences$ === void 0 ? void 0 : _positionDifferences$[square]; // return as null and not loaded yet\n\n    if (!positionDifferences.added) return; // check if piece matches or if removed piece was a pawn and new square is on 1st or 8th rank (promotion)\n\n    const newSquare = Object.entries(positionDifferences.added).find(([s, p]) => p === removedPiece || (removedPiece === null || removedPiece === void 0 ? void 0 : removedPiece[1]) === 'P' && (s[1] === '1' || s[1] === '8')); // we can perform animation if our square was in removed, AND the matching piece is in added AND this isn't a premoved piece\n\n    if (waitingForAnimation && removedPiece && newSquare && !isPremovedPiece) {\n      const {\n        sourceSq,\n        targetSq\n      } = getSquareCoordinates(square, newSquare[0]);\n      if (sourceSq && targetSq) {\n        setPieceStyle(oldPieceStyle => ({\n          ...oldPieceStyle,\n          transform: `translate(${targetSq.x - sourceSq.x}px, ${targetSq.y - sourceSq.y}px)`,\n          transition: `transform ${animationDuration}ms`,\n          zIndex: 6\n        }));\n      }\n    }\n  }, [positionDifferences]); // translate to their own positions (repaint on undo)\n\n  useEffect(() => {\n    const {\n      sourceSq\n    } = getSingleSquareCoordinates(square);\n    if (sourceSq) {\n      setPieceStyle(oldPieceStyle => ({\n        ...oldPieceStyle,\n        transform: `translate(${0}px, ${0}px)`,\n        transition: `transform ${0}ms`\n      }));\n    }\n  }, [currentPosition]); // update is piece draggable\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({\n      ...oldPieceStyle,\n      cursor: arePiecesDraggable && isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }) ? '-webkit-grab' : 'default'\n    }));\n  }, [square, currentPosition, arePiecesDraggable]);\n  function getSingleSquareCoordinates(square) {\n    return {\n      sourceSq: squares[square]\n    };\n  }\n  function getSquareCoordinates(sourceSquare, targetSquare) {\n    return {\n      sourceSq: squares[sourceSquare],\n      targetSq: squares[targetSquare]\n    };\n  }\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: arePiecesDraggable ? canDrag ? drag : null : null,\n    onClick: () => onPieceClick(piece),\n    style: pieceStyle,\n    children: typeof chessPieces[piece] === 'function' ? chessPieces[piece]({\n      squareWidth: boardWidth / 8,\n      isDragging,\n      droppedPiece: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.piece,\n      targetSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.target,\n      sourceSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.source\n    }) : /*#__PURE__*/jsx(\"svg\", {\n      viewBox: '1 1 43 43',\n      width: boardWidth / 8,\n      height: boardWidth / 8,\n      children: /*#__PURE__*/jsx(\"g\", {\n        children: chessPieces[piece]\n      })\n    })\n  });\n}\nfunction Square({\n  square,\n  squareColor,\n  setSquares,\n  squareHasPremove,\n  children\n}) {\n  const squareRef = useRef();\n  const {\n    boardWidth,\n    boardOrientation,\n    clearArrows,\n    currentPosition,\n    customBoardStyle,\n    customDarkSquareStyle,\n    customDropSquareStyle,\n    customLightSquareStyle,\n    customPremoveDarkSquareStyle,\n    customPremoveLightSquareStyle,\n    customSquareStyles,\n    handleSetPosition,\n    lastPieceColour,\n    onDragOverSquare,\n    onMouseOutSquare,\n    onMouseOverSquare,\n    onPieceDrop,\n    onRightClickDown,\n    onRightClickUp,\n    onSquareClick,\n    waitingForAnimation\n  } = useChessboard();\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: 'piece',\n    drop: item => handleSetPosition(item.square, square, item.piece),\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }), [square, currentPosition, onPieceDrop, waitingForAnimation, lastPieceColour]);\n  useEffect(() => {\n    const {\n      x,\n      y\n    } = squareRef.current.getBoundingClientRect();\n    setSquares(oldSquares => ({\n      ...oldSquares,\n      [square]: {\n        x,\n        y\n      }\n    }));\n  }, [boardWidth, boardOrientation]);\n  const defaultSquareStyle = {\n    ...borderRadius(customBoardStyle, square, boardOrientation),\n    ...(squareColor === 'black' ? customDarkSquareStyle : customLightSquareStyle),\n    ...(squareHasPremove && (squareColor === 'black' ? customPremoveDarkSquareStyle : customPremoveLightSquareStyle)),\n    ...(isOver && customDropSquareStyle)\n  };\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: drop,\n    style: defaultSquareStyle,\n    \"data-square-color\": squareColor,\n    \"data-square\": square,\n    onMouseOver: e => {\n      // noop if moving from child of square into square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOverSquare(square);\n    },\n    onMouseOut: e => {\n      // noop if moving from square into a child of square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOutSquare(square);\n    },\n    onMouseDown: e => {\n      if (e.button === 2) onRightClickDown(square);\n    },\n    onMouseUp: e => {\n      if (e.button === 2) onRightClickUp(square);\n    },\n    onDragEnter: () => onDragOverSquare(square),\n    onClick: () => {\n      onSquareClick(square);\n      clearArrows();\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n    },\n    children: /*#__PURE__*/jsx(\"div\", {\n      ref: squareRef,\n      style: {\n        ...size(boardWidth),\n        ...center,\n        ...(!squareHasPremove && (customSquareStyles === null || customSquareStyles === void 0 ? void 0 : customSquareStyles[square]))\n      },\n      children: children\n    })\n  });\n}\nconst center = {\n  display: 'flex',\n  justifyContent: 'center'\n};\nconst size = width => ({\n  width: width / 8,\n  height: width / 8\n});\nconst borderRadius = (customBoardStyle, square, boardOrientation) => {\n  if (!customBoardStyle.borderRadius) return {};\n  if (square === 'a1') {\n    return boardOrientation === 'white' ? {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    };\n  }\n  if (square === 'a8') {\n    return boardOrientation === 'white' ? {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    };\n  }\n  if (square === 'h1') {\n    return boardOrientation === 'white' ? {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n  if (square === 'h8') {\n    return boardOrientation === 'white' ? {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n  return {};\n};\nfunction Squares({\n  children\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customBoardStyle,\n    id\n  } = useChessboard();\n  return /*#__PURE__*/jsx(\"div\", {\n    \"data-boardid\": id,\n    style: {\n      ...boardStyles(boardWidth),\n      ...customBoardStyle\n    },\n    children: [...Array(8)].map((_, r) => {\n      return /*#__PURE__*/jsx(\"div\", {\n        style: rowStyles(boardWidth),\n        children: [...Array(8)].map((_, c) => {\n          // a1, a2 ...\n          const square = boardOrientation === 'black' ? COLUMNS[7 - c] + (r + 1) : COLUMNS[c] + (8 - r);\n          const squareColor = c % 2 === r % 2 ? 'white' : 'black';\n          return children({\n            square,\n            squareColor,\n            col: c,\n            row: r\n          });\n        })\n      }, r.toString());\n    })\n  });\n}\nconst boardStyles = width => ({\n  cursor: 'default',\n  height: width,\n  width\n});\nconst rowStyles = width => ({\n  display: 'flex',\n  flexWrap: 'nowrap',\n  width\n});\nconst errorImage = {\n  whiteKing: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    style: {\n      shapeRendering: 'geometricPrecision',\n      textRendering: 'geometricPrecision',\n      imageRendering: 'optimizeQuality'\n    },\n    viewBox: \"0 0 4210 12970\",\n    x: \"0px\",\n    y: \"0px\",\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    width: \"250\",\n    height: \"250\",\n    children: /*#__PURE__*/jsx(\"g\", {\n      children: /*#__PURE__*/jsx(\"path\", {\n        style: {\n          fill: 'black',\n          fillRule: 'nonzero'\n        },\n        d: \"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z\"\n      })\n    })\n  })\n};\nfunction ErrorBoundary({\n  children\n}) {\n  try {\n    return children;\n  } catch (error) {\n    return /*#__PURE__*/jsx(WhiteKing, {\n      showError: true\n    });\n  }\n}\nfunction WhiteKing({\n  showError = false\n}) {\n  return /*#__PURE__*/jsxs(\"div\", {\n    style: container,\n    children: [/*#__PURE__*/jsx(\"div\", {\n      style: whiteKingStyle,\n      children: errorImage.whiteKing\n    }), showError && /*#__PURE__*/jsx(\"h1\", {\n      children: \"Something went wrong\"\n    })]\n  });\n}\nconst container = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  flexDirection: 'column'\n};\nconst whiteKingStyle = {\n  width: 250,\n  height: 250,\n  transform: 'rotate(90deg)'\n};\nfunction Board() {\n  const boardRef = useRef();\n  const [squares, setSquares] = useState({});\n  const {\n    arrows,\n    boardOrientation,\n    boardWidth,\n    clearCurrentRightClickDown,\n    customArrowColor,\n    showBoardNotation,\n    currentPosition,\n    premoves\n  } = useChessboard();\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (boardRef.current && !boardRef.current.contains(event.target)) {\n        clearCurrentRightClickDown();\n      }\n    }\n    document.addEventListener('mouseup', handleClickOutside);\n    return () => {\n      document.removeEventListener('mouseup', handleClickOutside);\n    };\n  }, []);\n  return boardWidth ? /*#__PURE__*/jsxs(\"div\", {\n    ref: boardRef,\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/jsx(Squares, {\n      children: ({\n        square,\n        squareColor,\n        col,\n        row\n      }) => {\n        const squareHasPremove = premoves.find(p => p.sourceSq === square || p.targetSq === square);\n        const squareHasPremoveTarget = premoves.find(p => p.targetSq === square);\n        return /*#__PURE__*/jsxs(Square, {\n          square: square,\n          squareColor: squareColor,\n          setSquares: setSquares,\n          squareHasPremove: squareHasPremove,\n          children: [currentPosition[square] && /*#__PURE__*/jsx(Piece, {\n            piece: currentPosition[square],\n            square: square,\n            squares: squares\n          }), squareHasPremoveTarget && /*#__PURE__*/jsx(Piece, {\n            isPremovedPiece: true,\n            piece: squareHasPremoveTarget.piece,\n            square: square,\n            squares: squares\n          }), showBoardNotation && /*#__PURE__*/jsx(Notation, {\n            row: row,\n            col: col\n          })]\n        }, `${col}${row}`);\n      }\n    }), /*#__PURE__*/jsx(\"svg\", {\n      width: boardWidth,\n      height: boardWidth,\n      style: {\n        position: 'absolute',\n        top: '0',\n        left: '0',\n        pointerEvents: 'none',\n        zIndex: '10'\n      },\n      children: arrows.map(arrow => {\n        const from = getRelativeCoords(boardOrientation, boardWidth, arrow[0]);\n        const to = getRelativeCoords(boardOrientation, boardWidth, arrow[1]);\n        return /*#__PURE__*/jsxs(Fragment$1, {\n          children: [/*#__PURE__*/jsx(\"defs\", {\n            children: /*#__PURE__*/jsx(\"marker\", {\n              id: \"arrowhead\",\n              markerWidth: \"2\",\n              markerHeight: \"2.5\",\n              refX: \"1.25\",\n              refY: \"1.25\",\n              orient: \"auto\",\n              children: /*#__PURE__*/jsx(\"polygon\", {\n                points: \"0 0, 2 1.25, 0 2.5\",\n                style: {\n                  fill: customArrowColor\n                }\n              })\n            })\n          }), /*#__PURE__*/jsx(\"line\", {\n            x1: from.x,\n            y1: from.y,\n            x2: to.x,\n            y2: to.y,\n            style: {\n              stroke: customArrowColor,\n              strokeWidth: boardWidth / 36\n            },\n            markerEnd: \"url(#arrowhead)\"\n          })]\n        }, `${arrow[0]}-${arrow[1]}`);\n      })\n    })]\n  }) : /*#__PURE__*/jsx(WhiteKing, {});\n}\nfunction CustomDragLayer() {\n  const {\n    boardWidth,\n    chessPieces,\n    id,\n    snapToCursor\n  } = useChessboard();\n  const collectedProps = useDragLayer(monitor => ({\n    item: monitor.getItem(),\n    clientOffset: monitor.getClientOffset(),\n    sourceClientOffset: monitor.getSourceClientOffset(),\n    isDragging: monitor.isDragging()\n  }));\n  const {\n    isDragging,\n    item,\n    clientOffset,\n    sourceClientOffset\n  } = collectedProps;\n  const layerStyles = {\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: 10,\n    left: 0,\n    top: 0\n  };\n  const getItemStyle = useCallback((clientOffset, sourceClientOffset) => {\n    if (!clientOffset || !sourceClientOffset) return {\n      display: 'none'\n    };\n    let {\n      x,\n      y\n    } = snapToCursor ? clientOffset : sourceClientOffset;\n    if (snapToCursor) {\n      const halfSquareWidth = boardWidth / 8 / 2;\n      x -= halfSquareWidth;\n      y -= halfSquareWidth;\n    }\n    const transform = `translate(${x}px, ${y}px)`;\n    return {\n      transform,\n      WebkitTransform: transform,\n      touchAction: 'none'\n    };\n  }, [boardWidth, snapToCursor]);\n  return isDragging && item.id === id ? /*#__PURE__*/jsx(\"div\", {\n    style: layerStyles,\n    children: /*#__PURE__*/jsx(\"div\", {\n      style: getItemStyle(clientOffset, sourceClientOffset),\n      children: typeof chessPieces[item.piece] === 'function' ? chessPieces[item.piece]({\n        squareWidth: boardWidth / 8,\n        isDragging: true\n      }) : /*#__PURE__*/jsx(\"svg\", {\n        viewBox: '1 1 43 43',\n        width: boardWidth / 8,\n        height: boardWidth / 8,\n        children: /*#__PURE__*/jsx(\"g\", {\n          children: chessPieces[item.piece]\n        })\n      })\n    })\n  }) : null;\n}\nconst Chessboard = /*#__PURE__*/forwardRef((props, ref) => {\n  const [clientWindow, setClientWindow] = useState();\n  const [backendSet, setBackendSet] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const {\n    customDndBackend,\n    customDndBackendOptions,\n    ...otherProps\n  } = props;\n  useEffect(() => {\n    setIsMobile('ontouchstart' in window);\n    setBackendSet(true);\n    setClientWindow(window);\n  }, []);\n  const backend = customDndBackend || (isMobile ? TouchBackend : HTML5Backend);\n  return backendSet && clientWindow && /*#__PURE__*/jsx(ErrorBoundary, {\n    children: /*#__PURE__*/jsx(DndProvider, {\n      backend: backend,\n      context: clientWindow,\n      children: /*#__PURE__*/jsxs(ChessboardProvider, {\n        ref: ref,\n        ...otherProps,\n        children: [/*#__PURE__*/jsx(CustomDragLayer, {}), /*#__PURE__*/jsx(Board, {})]\n      })\n    })\n  });\n});\nChessboard.defaultProps = chessboardDefaultProps;\nexport { Chessboard };","map":{"version":3,"names":["React","createContext","memo","useEffect","useLayoutEffect","useState","useCallback","useMemo","isValidElement","cloneElement","useContext","forwardRef","useRef","useImperativeHandle","Fragment","Fragment$1","jsx","jsxs","DndContext","dragDropManager","undefined","formatProdErrorMessage","code","$$observable","Symbol","observable","randomString","Math","random","toString","substring","split","join","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","isPlainObject","obj","proto","Object","getPrototypeOf","miniKindOf","val","type","Array","isArray","isDate","isError","constructorName","ctorName","slice","toLowerCase","replace","constructor","name","Error","message","stackTraceLimit","Date","toDateString","getDate","setDate","kindOf","typeOfVal","process","env","NODE_ENV","createStore","reducer","preloadedState","enhancer","_ref2","arguments","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","getState","subscribe","listener","isSubscribed","push","unsubscribe","index","indexOf","splice","dispatch","action","listeners","i","length","replaceReducer","nextReducer","_ref","outerSubscribe","observer","observeState","next","warning","console","error","e","isCrushed","invariant","condition","format","args","isProduction","argIndex","framesToPop","get","path","defaultValue","reduce","a","c","without$1","items","item","filter","isObject","input","xor","itemsA","itemsB","map","Map","insertItem","set","has","forEach","result","count","key","intersection","t","INIT_COORDS","BEGIN_DRAG","PUBLISH_DRAG_SOURCE","HOVER","DROP","END_DRAG","setClientOffset","clientOffset","sourceClientOffset","payload","ResetCoordinatesAction","createBeginDrag","manager","beginDrag","sourceIds","options","publishSource","getSourceClientOffset","monitor","getMonitor","registry","getRegistry","verifyInvariants$1","sourceId","getDraggableSource","verifyGetSourceClientOffsetIsFunction","source","getSource","verifyItemIsObject","pinSource","itemType","getSourceType","isSourcePublic","isDragging","canDragSource","_defineProperty$4","value","defineProperty","enumerable","configurable","writable","_objectSpread$4","target","ownKeys","keys","getOwnPropertySymbols","concat","sym","getOwnPropertyDescriptor","createDrop","drop","verifyInvariants","targetIds","getDroppableTargets","targetId","dropResult","determineDropResult","didDrop","getTarget","verifyDropResultType","getDropResult","getTargetIds","canDropOnTarget","reverse","createEndDrag","endDrag","verifyIsDragging","getSourceId","unpinSource","matchesType","targetType","draggedItemType","some","createHover","hover","targetIdsArg","verifyTargetIdsIsArray","getItemType","removeNonMatchingTargetIds","checkInvariants","hoverAllTargets","lastIndexOf","getTargetType","createPublishDragSource","publishDragSource","createDragDropActions","DragDropManagerImpl","receiveBackend","backend","getBackend","getActions","store","bindActionCreator","actionCreator","apply","actions","boundActions","isSetUp","handleRefCountChange","shouldSetUp","refCount","setup","teardown","add","b","x","y","subtract","state","initialClientOffset","initialSourceClientOffset","getDifferenceFromInitialOffset","NONE","ALL","__IS_NONE__","__IS_ALL__","areDirty","dirtyIds","handlerIds","commonIds","DragDropMonitorImpl","subscribeToStateChange","prevStateId","stateId","handleChange","currentStateId","canSkipListener","dirtyHandlerIds","subscribeToOffsetChange","previousState","dragOffset","nextState","canDrag","canDrop","Boolean","isDraggingSource","sourceType","isOverTarget","shallow","dragOperation","getItem","getInitialClientOffset","getInitialSourceClientOffset","getClientOffset","scope","global","self","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","makeRequestCallFromTimer","callback","requestCall","timeoutHandle","setTimeout","handleTimer","intervalHandle","setInterval","clearTimeout","clearInterval","makeRequestCallFromMutationObserver","toggle","node","document","createTextNode","observe","characterData","data","makeRequestCall","AsapQueue","enqueueTask","task","queue","q","requestFlush","flushing","pendingErrors","capacity","flush","currentIndex","call","scan","newLength","registerPendingError","err","requestErrorThrow","shift","RawTask","onError","release","TaskFactory","create","tasks","freeTasks","t1","pop","asapQueue","taskFactory","asap","ADD_SOURCE","ADD_TARGET","REMOVE_SOURCE","REMOVE_TARGET","addSource","addTarget","removeSource","removeTarget","validateSourceContract","validateTargetContract","validateType","allowArray","HandlerRole","nextUniqueId","getNextUniqueId","getNextHandlerId","role","id","SOURCE","TARGET","parseRoleFromHandlerId","handlerId","mapContainsValue","searchValue","entries","isDone","done","HandlerRegistryImpl","addHandler","containsHandler","handler","dragSources","dropTargets","includePinned","isSourceId","isPinned","pinnedSourceId","pinnedSource","isTargetId","types","delete","strictEquality","areCoordsEqual","offsetA","offsetB","areArraysEqual","isEqual","reduce$5","_state","prevTargetIds","didChange","prevInnermostTargetId","innermostTargetId","_defineProperty$3","_objectSpread$3","initialState$1","reduce$4","_defineProperty$2","_objectSpread$2","initialState","reduce$3","reduce$2","reduce$1","_defineProperty$1","_objectSpread$1","createDragDropManager","backendFactory","globalContext","backendOptions","debugMode","makeStoreInstance","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","instanceId","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","prototype","propertyIsEnumerable","sourceKeys","INSTANCE_SYM","for","DndProvider","_param","children","props","isGlobalInstance","getDndContextValue","context","getGlobalContext","Provider","createSingletonDndContext","ctx","fastDeepEqual","equal","RegExp","flags","valueOf","hasOwnProperty","useIsomorphicLayoutEffect","useCollector","collect","onUpdate","collected","setCollected","updateCollected","nextValue","useMonitorOutput","onCollect","subscribeToMonitorStateChange","getHandlerId","useCollectedProps","collector","connector","reconnect","useOptionalFactory","arg","deps","memoDeps","useConnectDragSource","hooks","dragSource","useConnectDragPreview","dragPreview","isCallingCanDrag","isCallingIsDragging","DragSourceMonitorImpl","receiveHandlerId","internalMonitor","isCallingCanDrop","DropTargetMonitorImpl","isOver","registerTarget","registerSource","shallowEqual","objA","objB","compare","compareContext","compareResult","keysA","keysB","bHasOwnProperty","bind","idx","valueA","valueB","isRef","throwIfCompositeComponentElement","element","displayName","wrapHookToRecognizeElement","hook","elementOrNode","ref","cloneWithRef","wrapConnectorHooks","wrappedHooks","endsWith","wrappedHook","setRef","current","newRef","previousRef","SourceConnector","newHandlerId","connectTarget","dragSourceOptions","dragSourceOptionsInternal","dragPreviewOptions","dragPreviewOptionsInternal","reconnectDragSource","reconnectDragPreview","didHandlerIdChange","didConnectedDragSourceChange","didDragSourceOptionsChange","disconnectDragSource","lastConnectedDragSource","lastConnectedHandlerId","lastConnectedDragSourceOptions","dragSourceUnsubscribe","connectDragSource","forceDidChange","didConnectedDragPreviewChange","didDragPreviewOptionsChange","disconnectDragPreview","lastConnectedDragPreview","lastConnectedDragPreviewOptions","dragPreviewUnsubscribe","connectDragPreview","dragPreviewNode","dragPreviewRef","dragSourceNode","dragSourceRef","clearDragSource","clearDragPreview","TargetConnector","dropTarget","didDropTargetChange","didOptionsChange","disconnectDropTarget","lastConnectedDropTarget","lastConnectedDropTargetOptions","dropTargetOptions","unsubscribeDropTarget","connectDropTarget","dropTargetOptionsInternal","dropTargetNode","dropTargetRef","clearDropTarget","useDragDropManager","useDragSourceConnector","useDragSourceMonitor","DragSourceImpl","spec","globalMonitor","end","useDragSource","useDragType","useRegisteredDragSource","registerDragSource","unregister","useDrag","specArg","begin","previewOptions","useDragLayer","useConnectDropTarget","useDropTargetConnector","useDropTargetMonitor","useAccept","accept","DropTargetImpl","useDropTarget","useRegisteredDropTarget","registerDropTarget","useDrop","memoize","fn","memoized","without","union","Set","EnterLeaveCounter","enter","enteringNode","previousLength","entered","isNodeEntered","isNodeInDocument","contains","leave","leavingNode","reset","NativeDragSource","initializeExposedProperties","config","exposeProperties","property","warn","loadDataTransfer","dataTransfer","newProperties","propertyFn","matchesTypes","defineProperties","handle","FILE","URL","TEXT","HTML","NativeTypes","freeze","__proto__","getDataFromDataTransfer","typesToTry","resultSoFar","typeToTry","getData","nativeTypesConfig","files","html","urls","text","createNativeDragSource","matchNativeItemType","dataTransferTypes","nativeItemType","typeConfig","isFirefox","test","navigator","userAgent","isSafari","safari","MonotonicInterpolant","interpolate","xs","ys","c1s","c2s","c3s","low","high","mid","floor","xHere","max","diff","diffSq","indexes","sort","dxs","ms","dx","dy","i1","i2","m2","mNext","dxNext","common","m","i3","c1","invDx","ELEMENT_NODE$1","getNodeClientOffset$1","el","nodeType","parentElement","top","left","getBoundingClientRect","getEventClientOffset$1","clientX","clientY","isImageNode","nodeName","documentElement","getDragPreviewSize","isImage","sourceWidth","sourceHeight","dragPreviewWidth","width","dragPreviewHeight","height","devicePixelRatio","getDragPreviewOffset","sourceNode","anchorPoint","offsetPoint","dragPreviewNodeOffsetFromClient","offsetFromDragPreview","offsetWidth","offsetHeight","anchorX","anchorY","calculateYOffset","interpolantY","calculateXOffset","interpolantX","offsetX","offsetY","isManualOffsetX","isManualOffsetY","OptionsReader$1","rootElement","optionsArgs","ownerDocument","_defineProperty","_objectSpread","HTML5BackendImpl","profile","ref1","sourcePreviewNodes","size","sourcePreviewNodeOptions","sourceNodeOptions","sourceNodes","dragStartSourceIds","dropTargetIds","dragEnterTargetIds","dragOverTargetIds","root","__isReactDndBackendSetUp","addEventListeners","removeEventListeners","clearCurrentDragSourceNode","asyncEndDragFrameId","cancelAnimationFrame","handleDragStart","handleSelectStart","setAttribute","addEventListener","removeEventListener","handleDragEnter","handleDragOver","handleDrop","handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture","getCurrentSourceNodeOptions","dropEffect","altKeyPressed","getCurrentDropEffect","isDraggingNativeItem","getCurrentSourcePreviewNodeOptions","captureDraggingState","beginDragNativeItem","currentNativeSource","currentNativeHandle","setCurrentDragSourceNode","currentDragSourceNode","MOUSE_MOVE_TIMEOUT","mouseMoveTimeoutTimer","endDragIfSourceWasRemovedFromDOM","defaultPrevented","unshift","_e","lastClientOffset","hoverRafId","endDragNativeItem","body","cancelHover","scheduleHover","requestAnimationFrame","nativeType","setDragImage","dragPreviewOffset","setData","hasAttribute","preventDefault","isFirstEnter","enterLeaveCounter","altKey","isLastLeave","dragDrop","tagName","isContentEditable","emptyImage","getEmptyImage","Image","src","HTML5Backend","createBackend","ListenerType","OptionsReader","delay","_delay","scrollAngleRanges","getDropTargetElementsAtPoint","ignoreContextMenu","_ignoreContextMenu","enableHoverOutsideTarget","_enableHoverOutsideTarget","enableKeyboardEvents","_enableKeyboardEvents","enableMouseEvents","_enableMouseEvents","enableTouchEvents","_enableTouchEvents","touchSlop","delayTouchStart","ref2","ref3","delayMouseStart","ref4","ref5","ref6","distance","x1","y1","x2","y2","sqrt","pow","abs","inAngleRanges","angleRanges","angle","atan2","PI","ar","start","MouseButtons","Left","Right","Center","MouseButton","eventShouldStartDrag","button","eventShouldEndDrag","buttons","isTouchEvent","targetTouches","ELEMENT_NODE","getNodeClientOffset","getEventClientTouchOffset","lastTargetTouchFallback","getEventClientOffset","touches","supportsPassive","supported","eventNames","mouse","move","contextmenu","touch","keyboard","keydown","TouchBackendImpl","targetNodes","getTopMoveStartHandler","handleTopMoveStartCapture","handleTopMove","handleTopMoveCapture","handleTopMoveEndCapture","handleCancelOnEscape","_mouseClientOffset","handleTopMoveStart","uninstallSourceNodeRemovalObserver","subject","event","capture","passive","listenerTypes","listenerType","evt","handleMoveStart","handleMove","coords","droppedOn","elementFromPoint","childMatch","handleTopMoveStartDelay","installSourceNodeRemovalObserver","draggedSourceNode","draggedSourceNodeRemovalObserver","resurrectSourceNode","childList","style","display","removeAttribute","appendChild","disconnect","moveStartSourceIds","waitingForDelay","timeout","_evt","e1","_isScrolling","cancelable","dragOverTargetNodes","elementsAtPoint","elementsFromPoint","elementsAtPointExtended","nodeId","currentNode","orderedDragOverTargetIds","_getDropTargetId","ids","targetNode","TouchBackend","COLUMNS","chessboardDefaultProps","animationDuration","areArrowsAllowed","arePiecesDraggable","arePremovesAllowed","boardOrientation","boardWidth","clearPremovesOnRightClick","customArrows","customArrowColor","customBoardStyle","customDarkSquareStyle","backgroundColor","customDndBackend","customDndBackendOptions","customDropSquareStyle","boxShadow","customLightSquareStyle","customPieces","customPremoveDarkSquareStyle","customPremoveLightSquareStyle","customSquareStyles","dropOffBoardAction","isDraggablePiece","getPositionObject","onArrowsChange","onDragOverSquare","onMouseOutSquare","onMouseOverSquare","onPieceClick","onPieceDragBegin","onPieceDragEnd","onPieceDrop","onSquareClick","onSquareRightClick","position","showBoardNotation","snapToCursor","startPositionObject","a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","d1","f1","g1","h1","whiteColumnValues","d","f","g","h","blackColumnValues","whiteRows","blackRows","getRelativeCoords","square","squareWidth","columns","rows","isDifferentFromStart","newPosition","isDifferent","getPositionDifferences","currentPosition","difference","removed","added","isString","s","convertPositionToObject","fenToObj","validFen","validPositionObject","fen","currentRow","row","colIdx","j","search","numEmptySquares","parseInt","fenToPieceCode","expandFenEmptySquares","chunks","piece","toUpperCase","validSquare","validPieceCode","pos","defaultPieces","wP","xmlns","version","opacity","fill","fillOpacity","fillRule","stroke","strokeWidth","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeDasharray","strokeOpacity","wR","wN","transform","wB","wQ","cx","cy","r","wK","bP","bR","bN","bB","bQ","bK","ChessboardContext","useChessboard","ChessboardProvider","showSparePieces","setCurrentPosition","positionDifferences","setPositionDifferences","lastPieceColour","setLastPieceColour","premoves","setPremoves","premovesRef","currentRightClickDown","setCurrentRightClickDown","arrows","setArrows","chessPieces","setChessPieces","manualDrop","setManualDrop","previousTimeout","setPreviousTimeout","waitingForAnimation","setWaitingForAnimation","clearPremoves","clearLastPieceColour","_Object$keys","_Object$entries","_Object$entries$","differences","newPieceColour","attemptPremove","newTimeout","clearArrows","handleSetPosition","sourceSq","targetSq","p","oldPremoves","newOnDropPosition","isValidMove","premove","onRightClickDown","onRightClickUp","oldArrows","newArrows","clearCurrentRightClickDown","Notation","col","whiteColor","blackColor","isRow","isColumn","isBottomLeftSquare","getRow","getColumn","renderBottomLeft","notationStyle","color","numericStyle","alphaStyle","renderLetters","renderNumbers","alignSelf","paddingLeft","fontSize","paddingRight","zIndex","Piece","squares","isPremovedPiece","pieceStyle","setPieceStyle","touchAction","cursor","sourceSquare","drag","oldPieceStyle","hidePiece","find","_positionDifferences$","removedPiece","newSquare","getSquareCoordinates","transition","getSingleSquareCoordinates","targetSquare","onClick","droppedPiece","viewBox","Square","squareColor","setSquares","squareHasPremove","squareRef","oldSquares","defaultSquareStyle","borderRadius","onMouseOver","relatedTarget","currentTarget","onMouseOut","onMouseDown","onMouseUp","onDragEnter","onContextMenu","center","justifyContent","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","Squares","boardStyles","_","rowStyles","flexWrap","errorImage","whiteKing","shapeRendering","textRendering","imageRendering","clipRule","ErrorBoundary","WhiteKing","showError","container","whiteKingStyle","alignItems","flexDirection","Board","boardRef","handleClickOutside","squareHasPremoveTarget","pointerEvents","arrow","from","to","markerWidth","markerHeight","refX","refY","orient","points","markerEnd","CustomDragLayer","collectedProps","layerStyles","getItemStyle","halfSquareWidth","WebkitTransform","Chessboard","clientWindow","setClientWindow","backendSet","setBackendSet","isMobile","setIsMobile","otherProps","defaultProps"],"sources":["/Users/ahmedtaha/Visualize3/chess-visualization-app/node_modules/react-chessboard/dist/index.esm.js"],"sourcesContent":["import React, { createContext, memo, useEffect, useLayoutEffect, useState, useCallback, useMemo, isValidElement, cloneElement, useContext, forwardRef, useRef, useImperativeHandle, Fragment as Fragment$1 } from 'react';\nimport { jsx, jsxs, Fragment } from 'react/jsx-runtime';\n\n/**\n * Create the React Context\n */\n\nconst DndContext = /*#__PURE__*/createContext({\n  dragDropManager: undefined\n});\n\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\n\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n} // Inlined version of the `symbol-observable` polyfill\n\n\nvar $$observable = function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\n\n\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\n\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n} // Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\n\n\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\n\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\n\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\n\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\n\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n\n  return typeOfVal;\n}\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\n\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\nfunction invariant(condition, format, ...args) {\n  if (isProduction()) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    let error;\n\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      let argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1 // we don't care about invariant's own frame\n    ;\n    throw error;\n  }\n}\n\nfunction isProduction() {\n  return typeof process !== 'undefined' && process.env['NODE_ENV'] === 'production';\n}\n\n// cheap lodash replacements\n\n/**\n * drop-in replacement for _.get\n * @param obj\n * @param path\n * @param defaultValue\n */\nfunction get(obj, path, defaultValue) {\n  return path.split('.').reduce((a, c) => a && a[c] ? a[c] : defaultValue || null, obj);\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without$1(items, item) {\n  return items.filter(i => i !== item);\n}\n/**\n * drop-in replacement for _.isString\n * @param input\n */\n\nfunction isObject(input) {\n  return typeof input === 'object';\n}\n/**\n * replacement for _.xor\n * @param itemsA\n * @param itemsB\n */\n\nfunction xor(itemsA, itemsB) {\n  const map = new Map();\n\n  const insertItem = item => {\n    map.set(item, map.has(item) ? map.get(item) + 1 : 1);\n  };\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  map.forEach((count, key) => {\n    if (count === 1) {\n      result.push(key);\n    }\n  });\n  return result;\n}\n/**\n * replacement for _.intersection\n * @param itemsA\n * @param itemsB\n */\n\nfunction intersection(itemsA, itemsB) {\n  return itemsA.filter(t => itemsB.indexOf(t) > -1);\n}\n\nconst INIT_COORDS = 'dnd-core/INIT_COORDS';\nconst BEGIN_DRAG = 'dnd-core/BEGIN_DRAG';\nconst PUBLISH_DRAG_SOURCE = 'dnd-core/PUBLISH_DRAG_SOURCE';\nconst HOVER = 'dnd-core/HOVER';\nconst DROP = 'dnd-core/DROP';\nconst END_DRAG = 'dnd-core/END_DRAG';\n\nfunction setClientOffset(clientOffset, sourceClientOffset) {\n  return {\n    type: INIT_COORDS,\n    payload: {\n      sourceClientOffset: sourceClientOffset || null,\n      clientOffset: clientOffset || null\n    }\n  };\n}\n\nconst ResetCoordinatesAction = {\n  type: INIT_COORDS,\n  payload: {\n    clientOffset: null,\n    sourceClientOffset: null\n  }\n};\nfunction createBeginDrag(manager) {\n  return function beginDrag(sourceIds = [], options = {\n    publishSource: true\n  }) {\n    const {\n      publishSource = true,\n      clientOffset,\n      getSourceClientOffset\n    } = options;\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry(); // Initialize the coordinates using the client offset\n\n    manager.dispatch(setClientOffset(clientOffset));\n    verifyInvariants$1(sourceIds, monitor, registry); // Get the draggable source\n\n    const sourceId = getDraggableSource(sourceIds, monitor);\n\n    if (sourceId == null) {\n      manager.dispatch(ResetCoordinatesAction);\n      return;\n    } // Get the source client offset\n\n\n    let sourceClientOffset = null;\n\n    if (clientOffset) {\n      if (!getSourceClientOffset) {\n        throw new Error('getSourceClientOffset must be defined');\n      }\n\n      verifyGetSourceClientOffsetIsFunction(getSourceClientOffset);\n      sourceClientOffset = getSourceClientOffset(sourceId);\n    } // Initialize the full coordinates\n\n\n    manager.dispatch(setClientOffset(clientOffset, sourceClientOffset));\n    const source = registry.getSource(sourceId);\n    const item = source.beginDrag(monitor, sourceId); // If source.beginDrag returns null, this is an indicator to cancel the drag\n\n    if (item == null) {\n      return undefined;\n    }\n\n    verifyItemIsObject(item);\n    registry.pinSource(sourceId);\n    const itemType = registry.getSourceType(sourceId);\n    return {\n      type: BEGIN_DRAG,\n      payload: {\n        itemType,\n        item,\n        sourceId,\n        clientOffset: clientOffset || null,\n        sourceClientOffset: sourceClientOffset || null,\n        isSourcePublic: !!publishSource\n      }\n    };\n  };\n}\n\nfunction verifyInvariants$1(sourceIds, monitor, registry) {\n  invariant(!monitor.isDragging(), 'Cannot call beginDrag while dragging.');\n  sourceIds.forEach(function (sourceId) {\n    invariant(registry.getSource(sourceId), 'Expected sourceIds to be registered.');\n  });\n}\n\nfunction verifyGetSourceClientOffsetIsFunction(getSourceClientOffset) {\n  invariant(typeof getSourceClientOffset === 'function', 'When clientOffset is provided, getSourceClientOffset must be a function.');\n}\n\nfunction verifyItemIsObject(item) {\n  invariant(isObject(item), 'Item must be an object.');\n}\n\nfunction getDraggableSource(sourceIds, monitor) {\n  let sourceId = null;\n\n  for (let i = sourceIds.length - 1; i >= 0; i--) {\n    if (monitor.canDragSource(sourceIds[i])) {\n      sourceId = sourceIds[i];\n      break;\n    }\n  }\n\n  return sourceId;\n}\n\nfunction _defineProperty$4(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$4(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$4(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nfunction createDrop(manager) {\n  return function drop(options = {}) {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyInvariants(monitor);\n    const targetIds = getDroppableTargets(monitor); // Multiple actions are dispatched here, which is why this doesn't return an action\n\n    targetIds.forEach((targetId, index) => {\n      const dropResult = determineDropResult(targetId, index, registry, monitor);\n      const action = {\n        type: DROP,\n        payload: {\n          dropResult: _objectSpread$4({}, options, dropResult)\n        }\n      };\n      manager.dispatch(action);\n    });\n  };\n}\n\nfunction verifyInvariants(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call drop while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call drop twice during one drag operation.');\n}\n\nfunction determineDropResult(targetId, index, registry, monitor) {\n  const target = registry.getTarget(targetId);\n  let dropResult = target ? target.drop(monitor, targetId) : undefined;\n  verifyDropResultType(dropResult);\n\n  if (typeof dropResult === 'undefined') {\n    dropResult = index === 0 ? {} : monitor.getDropResult();\n  }\n\n  return dropResult;\n}\n\nfunction verifyDropResultType(dropResult) {\n  invariant(typeof dropResult === 'undefined' || isObject(dropResult), 'Drop result must either be an object or undefined.');\n}\n\nfunction getDroppableTargets(monitor) {\n  const targetIds = monitor.getTargetIds().filter(monitor.canDropOnTarget, monitor);\n  targetIds.reverse();\n  return targetIds;\n}\n\nfunction createEndDrag(manager) {\n  return function endDrag() {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyIsDragging(monitor);\n    const sourceId = monitor.getSourceId();\n\n    if (sourceId != null) {\n      const source = registry.getSource(sourceId, true);\n      source.endDrag(monitor, sourceId);\n      registry.unpinSource();\n    }\n\n    return {\n      type: END_DRAG\n    };\n  };\n}\n\nfunction verifyIsDragging(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call endDrag while not dragging.');\n}\n\nfunction matchesType(targetType, draggedItemType) {\n  if (draggedItemType === null) {\n    return targetType === null;\n  }\n\n  return Array.isArray(targetType) ? targetType.some(t => t === draggedItemType) : targetType === draggedItemType;\n}\n\nfunction createHover(manager) {\n  return function hover(targetIdsArg, {\n    clientOffset\n  } = {}) {\n    verifyTargetIdsIsArray(targetIdsArg);\n    const targetIds = targetIdsArg.slice(0);\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    const draggedItemType = monitor.getItemType();\n    removeNonMatchingTargetIds(targetIds, registry, draggedItemType);\n    checkInvariants(targetIds, monitor, registry);\n    hoverAllTargets(targetIds, monitor, registry);\n    return {\n      type: HOVER,\n      payload: {\n        targetIds,\n        clientOffset: clientOffset || null\n      }\n    };\n  };\n}\n\nfunction verifyTargetIdsIsArray(targetIdsArg) {\n  invariant(Array.isArray(targetIdsArg), 'Expected targetIds to be an array.');\n}\n\nfunction checkInvariants(targetIds, monitor, registry) {\n  invariant(monitor.isDragging(), 'Cannot call hover while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call hover after drop.');\n\n  for (let i = 0; i < targetIds.length; i++) {\n    const targetId = targetIds[i];\n    invariant(targetIds.lastIndexOf(targetId) === i, 'Expected targetIds to be unique in the passed array.');\n    const target = registry.getTarget(targetId);\n    invariant(target, 'Expected targetIds to be registered.');\n  }\n}\n\nfunction removeNonMatchingTargetIds(targetIds, registry, draggedItemType) {\n  // Remove those targetIds that don't match the targetType.  This\n  // fixes shallow isOver which would only be non-shallow because of\n  // non-matching targets.\n  for (let i = targetIds.length - 1; i >= 0; i--) {\n    const targetId = targetIds[i];\n    const targetType = registry.getTargetType(targetId);\n\n    if (!matchesType(targetType, draggedItemType)) {\n      targetIds.splice(i, 1);\n    }\n  }\n}\n\nfunction hoverAllTargets(targetIds, monitor, registry) {\n  // Finally call hover on all matching targets.\n  targetIds.forEach(function (targetId) {\n    const target = registry.getTarget(targetId);\n    target.hover(monitor, targetId);\n  });\n}\n\nfunction createPublishDragSource(manager) {\n  return function publishDragSource() {\n    const monitor = manager.getMonitor();\n\n    if (monitor.isDragging()) {\n      return {\n        type: PUBLISH_DRAG_SOURCE\n      };\n    }\n\n    return;\n  };\n}\n\nfunction createDragDropActions(manager) {\n  return {\n    beginDrag: createBeginDrag(manager),\n    publishDragSource: createPublishDragSource(manager),\n    hover: createHover(manager),\n    drop: createDrop(manager),\n    endDrag: createEndDrag(manager)\n  };\n}\n\nclass DragDropManagerImpl {\n  receiveBackend(backend) {\n    this.backend = backend;\n  }\n\n  getMonitor() {\n    return this.monitor;\n  }\n\n  getBackend() {\n    return this.backend;\n  }\n\n  getRegistry() {\n    return this.monitor.registry;\n  }\n\n  getActions() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    const manager = this;\n    const {\n      dispatch\n    } = this.store;\n\n    function bindActionCreator(actionCreator) {\n      return (...args) => {\n        const action = actionCreator.apply(manager, args);\n\n        if (typeof action !== 'undefined') {\n          dispatch(action);\n        }\n      };\n    }\n\n    const actions = createDragDropActions(this);\n    return Object.keys(actions).reduce((boundActions, key) => {\n      const action = actions[key];\n      boundActions[key] = bindActionCreator(action);\n      return boundActions;\n    }, {});\n  }\n\n  dispatch(action) {\n    this.store.dispatch(action);\n  }\n\n  constructor(store, monitor) {\n    this.isSetUp = false;\n\n    this.handleRefCountChange = () => {\n      const shouldSetUp = this.store.getState().refCount > 0;\n\n      if (this.backend) {\n        if (shouldSetUp && !this.isSetUp) {\n          this.backend.setup();\n          this.isSetUp = true;\n        } else if (!shouldSetUp && this.isSetUp) {\n          this.backend.teardown();\n          this.isSetUp = false;\n        }\n      }\n    };\n\n    this.store = store;\n    this.monitor = monitor;\n    store.subscribe(this.handleRefCountChange);\n  }\n\n}\n\n/**\n * Coordinate addition\n * @param a The first coordinate\n * @param b The second coordinate\n */\nfunction add(a, b) {\n  return {\n    x: a.x + b.x,\n    y: a.y + b.y\n  };\n}\n/**\n * Coordinate subtraction\n * @param a The first coordinate\n * @param b The second coordinate\n */\n\nfunction subtract(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n/**\n * Returns the cartesian distance of the drag source component's position, based on its position\n * at the time when the current drag operation has started, and the movement difference.\n *\n * Returns null if no item is being dragged.\n *\n * @param state The offset state to compute from\n */\n\nfunction getSourceClientOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset,\n    initialSourceClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset || !initialSourceClientOffset) {\n    return null;\n  }\n\n  return subtract(add(clientOffset, initialSourceClientOffset), initialClientOffset);\n}\n/**\n * Determines the x,y offset between the client offset and the initial client offset\n *\n * @param state The offset state to compute from\n */\n\nfunction getDifferenceFromInitialOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset) {\n    return null;\n  }\n\n  return subtract(clientOffset, initialClientOffset);\n}\n\nconst NONE = [];\nconst ALL = [];\nNONE.__IS_NONE__ = true;\nALL.__IS_ALL__ = true;\n/**\n * Determines if the given handler IDs are dirty or not.\n *\n * @param dirtyIds The set of dirty handler ids\n * @param handlerIds The set of handler ids to check\n */\n\nfunction areDirty(dirtyIds, handlerIds) {\n  if (dirtyIds === NONE) {\n    return false;\n  }\n\n  if (dirtyIds === ALL || typeof handlerIds === 'undefined') {\n    return true;\n  }\n\n  const commonIds = intersection(handlerIds, dirtyIds);\n  return commonIds.length > 0;\n}\n\nclass DragDropMonitorImpl {\n  subscribeToStateChange(listener, options = {}) {\n    const {\n      handlerIds\n    } = options;\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    invariant(typeof handlerIds === 'undefined' || Array.isArray(handlerIds), 'handlerIds, when specified, must be an array of strings.');\n    let prevStateId = this.store.getState().stateId;\n\n    const handleChange = () => {\n      const state = this.store.getState();\n      const currentStateId = state.stateId;\n\n      try {\n        const canSkipListener = currentStateId === prevStateId || currentStateId === prevStateId + 1 && !areDirty(state.dirtyHandlerIds, handlerIds);\n\n        if (!canSkipListener) {\n          listener();\n        }\n      } finally {\n        prevStateId = currentStateId;\n      }\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  subscribeToOffsetChange(listener) {\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    let previousState = this.store.getState().dragOffset;\n\n    const handleChange = () => {\n      const nextState = this.store.getState().dragOffset;\n\n      if (nextState === previousState) {\n        return;\n      }\n\n      previousState = nextState;\n      listener();\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  canDragSource(sourceId) {\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (this.isDragging()) {\n      return false;\n    }\n\n    return source.canDrag(this, sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const target = this.registry.getTarget(targetId);\n    invariant(target, `Expected to find a valid target. targetId=${targetId}`);\n\n    if (!this.isDragging() || this.didDrop()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n    return matchesType(targetType, draggedItemType) && target.canDrop(this, targetId);\n  }\n\n  isDragging() {\n    return Boolean(this.getItemType());\n  }\n\n  isDraggingSource(sourceId) {\n    // undefined on initial render\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId, true);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (!this.isDragging() || !this.isSourcePublic()) {\n      return false;\n    }\n\n    const sourceType = this.registry.getSourceType(sourceId);\n    const draggedItemType = this.getItemType();\n\n    if (sourceType !== draggedItemType) {\n      return false;\n    }\n\n    return source.isDragging(this, sourceId);\n  }\n\n  isOverTarget(targetId, options = {\n    shallow: false\n  }) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const {\n      shallow\n    } = options;\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n\n    if (draggedItemType && !matchesType(targetType, draggedItemType)) {\n      return false;\n    }\n\n    const targetIds = this.getTargetIds();\n\n    if (!targetIds.length) {\n      return false;\n    }\n\n    const index = targetIds.indexOf(targetId);\n\n    if (shallow) {\n      return index === targetIds.length - 1;\n    } else {\n      return index > -1;\n    }\n  }\n\n  getItemType() {\n    return this.store.getState().dragOperation.itemType;\n  }\n\n  getItem() {\n    return this.store.getState().dragOperation.item;\n  }\n\n  getSourceId() {\n    return this.store.getState().dragOperation.sourceId;\n  }\n\n  getTargetIds() {\n    return this.store.getState().dragOperation.targetIds;\n  }\n\n  getDropResult() {\n    return this.store.getState().dragOperation.dropResult;\n  }\n\n  didDrop() {\n    return this.store.getState().dragOperation.didDrop;\n  }\n\n  isSourcePublic() {\n    return Boolean(this.store.getState().dragOperation.isSourcePublic);\n  }\n\n  getInitialClientOffset() {\n    return this.store.getState().dragOffset.initialClientOffset;\n  }\n\n  getInitialSourceClientOffset() {\n    return this.store.getState().dragOffset.initialSourceClientOffset;\n  }\n\n  getClientOffset() {\n    return this.store.getState().dragOffset.clientOffset;\n  }\n\n  getSourceClientOffset() {\n    return getSourceClientOffset(this.store.getState().dragOffset);\n  }\n\n  getDifferenceFromInitialOffset() {\n    return getDifferenceFromInitialOffset(this.store.getState().dragOffset);\n  }\n\n  constructor(store, registry) {\n    this.store = store;\n    this.registry = registry;\n  }\n\n}\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nconst scope = typeof global !== 'undefined' ? global : self;\nconst BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\nfunction makeRequestCallFromTimer(callback) {\n  return function requestCall() {\n    // We dispatch a timeout with a specified delay of 0 for engines that\n    // can reliably accommodate that request. This will usually be snapped\n    // to a 4 milisecond delay, but once we're flushing, there's no delay\n    // between events.\n    const timeoutHandle = setTimeout(handleTimer, 0); // However, since this timer gets frequently dropped in Firefox\n    // workers, we enlist an interval handle that will try to fire\n    // an event 20 times per second until it succeeds.\n\n    const intervalHandle = setInterval(handleTimer, 50);\n\n    function handleTimer() {\n      // Whichever timer succeeds will cancel both timers and\n      // execute the callback.\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      callback();\n    }\n  };\n} // To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\n\nfunction makeRequestCallFromMutationObserver(callback) {\n  let toggle = 1;\n  const observer = new BrowserMutationObserver(callback);\n  const node = document.createTextNode('');\n  observer.observe(node, {\n    characterData: true\n  });\n  return function requestCall() {\n    toggle = -toggle;\n    node.data = toggle;\n  };\n}\nconst makeRequestCall = typeof BrowserMutationObserver === 'function' ? // reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nmakeRequestCallFromMutationObserver : // task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\nmakeRequestCallFromTimer;\n\n/* eslint-disable no-restricted-globals, @typescript-eslint/ban-ts-comment, @typescript-eslint/no-unused-vars, @typescript-eslint/no-non-null-assertion */\nclass AsapQueue {\n  // Use the fastest means possible to execute a task in its own turn, with\n  // priority over other events including IO, animation, reflow, and redraw\n  // events in browsers.\n  //\n  // An exception thrown by a task will permanently interrupt the processing of\n  // subsequent tasks. The higher level `asap` function ensures that if an\n  // exception is thrown by a task, that the task queue will continue flushing as\n  // soon as possible, but if you use `rawAsap` directly, you are responsible to\n  // either ensure that no exceptions are thrown from your task, or to manually\n  // call `rawAsap.requestFlush` if an exception is thrown.\n  enqueueTask(task) {\n    const {\n      queue: q,\n      requestFlush\n    } = this;\n\n    if (!q.length) {\n      requestFlush();\n      this.flushing = true;\n    } // Equivalent to push, but avoids a function call.\n\n\n    q[q.length] = task;\n  }\n\n  constructor() {\n    this.queue = []; // We queue errors to ensure they are thrown in right order (FIFO).\n    // Array-as-queue is good enough here, since we are just dealing with exceptions.\n\n    this.pendingErrors = []; // Once a flush has been requested, no further calls to `requestFlush` are\n    // necessary until the next `flush` completes.\n    // @ts-ignore\n\n    this.flushing = false; // The position of the next task to execute in the task queue. This is\n    // preserved between calls to `flush` so that it can be resumed if\n    // a task throws an exception.\n\n    this.index = 0; // If a task schedules additional tasks recursively, the task queue can grow\n    // unbounded. To prevent memory exhaustion, the task queue will periodically\n    // truncate already-completed tasks.\n\n    this.capacity = 1024; // The flush function processes all tasks that have been scheduled with\n    // `rawAsap` unless and until one of those tasks throws an exception.\n    // If a task throws an exception, `flush` ensures that its state will remain\n    // consistent and will resume where it left off when called again.\n    // However, `flush` does not make any arrangements to be called again if an\n    // exception is thrown.\n\n    this.flush = () => {\n      const {\n        queue: q\n      } = this;\n\n      while (this.index < q.length) {\n        const currentIndex = this.index; // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n\n        this.index++;\n        q[currentIndex].call(); // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n\n        if (this.index > this.capacity) {\n          // Manually shift all values starting at the index back to the\n          // beginning of the queue.\n          for (let scan = 0, newLength = q.length - this.index; scan < newLength; scan++) {\n            q[scan] = q[scan + this.index];\n          }\n\n          q.length -= this.index;\n          this.index = 0;\n        }\n      }\n\n      q.length = 0;\n      this.index = 0;\n      this.flushing = false;\n    }; // In a web browser, exceptions are not fatal. However, to avoid\n    // slowing down the queue of pending tasks, we rethrow the error in a\n    // lower priority turn.\n\n\n    this.registerPendingError = err => {\n      this.pendingErrors.push(err);\n      this.requestErrorThrow();\n    }; // `requestFlush` requests that the high priority event queue be flushed as\n    // soon as possible.\n    // This is useful to prevent an error thrown in a task from stalling the event\n    // queue if the exception handled by Node.js’s\n    // `process.on(\"uncaughtException\")` or by a domain.\n    // `requestFlush` is implemented using a strategy based on data collected from\n    // every available SauceLabs Selenium web driver worker at time of writing.\n    // https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n\n    this.requestFlush = makeRequestCall(this.flush);\n    this.requestErrorThrow = makeRequestCallFromTimer(() => {\n      // Throw first error\n      if (this.pendingErrors.length) {\n        throw this.pendingErrors.shift();\n      }\n    });\n  }\n\n} // The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// // its existence.\n// rawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n\n// `call`, just like a function.\nclass RawTask {\n  call() {\n    try {\n      this.task && this.task();\n    } catch (error) {\n      this.onError(error);\n    } finally {\n      this.task = null;\n      this.release(this);\n    }\n  }\n\n  constructor(onError, release) {\n    this.onError = onError;\n    this.release = release;\n    this.task = null;\n  }\n\n}\n\nclass TaskFactory {\n  create(task) {\n    const tasks = this.freeTasks;\n    const t1 = tasks.length ? tasks.pop() : new RawTask(this.onError, t => tasks[tasks.length] = t);\n    t1.task = task;\n    return t1;\n  }\n\n  constructor(onError) {\n    this.onError = onError;\n    this.freeTasks = [];\n  }\n\n}\n\nconst asapQueue = new AsapQueue();\nconst taskFactory = new TaskFactory(asapQueue.registerPendingError);\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\n\nfunction asap(task) {\n  asapQueue.enqueueTask(taskFactory.create(task));\n}\n\nconst ADD_SOURCE = 'dnd-core/ADD_SOURCE';\nconst ADD_TARGET = 'dnd-core/ADD_TARGET';\nconst REMOVE_SOURCE = 'dnd-core/REMOVE_SOURCE';\nconst REMOVE_TARGET = 'dnd-core/REMOVE_TARGET';\nfunction addSource(sourceId) {\n  return {\n    type: ADD_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction addTarget(targetId) {\n  return {\n    type: ADD_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\nfunction removeSource(sourceId) {\n  return {\n    type: REMOVE_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction removeTarget(targetId) {\n  return {\n    type: REMOVE_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\n\nfunction validateSourceContract(source) {\n  invariant(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n  invariant(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n  invariant(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\nfunction validateTargetContract(target) {\n  invariant(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n  invariant(typeof target.hover === 'function', 'Expected hover to be a function.');\n  invariant(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\nfunction validateType(type, allowArray) {\n  if (allowArray && Array.isArray(type)) {\n    type.forEach(t => validateType(t, false));\n    return;\n  }\n\n  invariant(typeof type === 'string' || typeof type === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\n\nvar HandlerRole;\n\n(function (HandlerRole) {\n  HandlerRole[\"SOURCE\"] = \"SOURCE\";\n  HandlerRole[\"TARGET\"] = \"TARGET\";\n})(HandlerRole || (HandlerRole = {}));\n\nlet nextUniqueId = 0;\nfunction getNextUniqueId() {\n  return nextUniqueId++;\n}\n\nfunction getNextHandlerId(role) {\n  const id = getNextUniqueId().toString();\n\n  switch (role) {\n    case HandlerRole.SOURCE:\n      return `S${id}`;\n\n    case HandlerRole.TARGET:\n      return `T${id}`;\n\n    default:\n      throw new Error(`Unknown Handler Role: ${role}`);\n  }\n}\n\nfunction parseRoleFromHandlerId(handlerId) {\n  switch (handlerId[0]) {\n    case 'S':\n      return HandlerRole.SOURCE;\n\n    case 'T':\n      return HandlerRole.TARGET;\n\n    default:\n      throw new Error(`Cannot parse handler ID: ${handlerId}`);\n  }\n}\n\nfunction mapContainsValue(map, searchValue) {\n  const entries = map.entries();\n  let isDone = false;\n\n  do {\n    const {\n      done,\n      value: [, value]\n    } = entries.next();\n\n    if (value === searchValue) {\n      return true;\n    }\n\n    isDone = !!done;\n  } while (!isDone);\n\n  return false;\n}\n\nclass HandlerRegistryImpl {\n  addSource(type, source) {\n    validateType(type);\n    validateSourceContract(source);\n    const sourceId = this.addHandler(HandlerRole.SOURCE, type, source);\n    this.store.dispatch(addSource(sourceId));\n    return sourceId;\n  }\n\n  addTarget(type, target) {\n    validateType(type, true);\n    validateTargetContract(target);\n    const targetId = this.addHandler(HandlerRole.TARGET, type, target);\n    this.store.dispatch(addTarget(targetId));\n    return targetId;\n  }\n\n  containsHandler(handler) {\n    return mapContainsValue(this.dragSources, handler) || mapContainsValue(this.dropTargets, handler);\n  }\n\n  getSource(sourceId, includePinned = false) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    const isPinned = includePinned && sourceId === this.pinnedSourceId;\n    const source = isPinned ? this.pinnedSource : this.dragSources.get(sourceId);\n    return source;\n  }\n\n  getTarget(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.dropTargets.get(targetId);\n  }\n\n  getSourceType(sourceId) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    return this.types.get(sourceId);\n  }\n\n  getTargetType(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.types.get(targetId);\n  }\n\n  isSourceId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.SOURCE;\n  }\n\n  isTargetId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.TARGET;\n  }\n\n  removeSource(sourceId) {\n    invariant(this.getSource(sourceId), 'Expected an existing source.');\n    this.store.dispatch(removeSource(sourceId));\n    asap(() => {\n      this.dragSources.delete(sourceId);\n      this.types.delete(sourceId);\n    });\n  }\n\n  removeTarget(targetId) {\n    invariant(this.getTarget(targetId), 'Expected an existing target.');\n    this.store.dispatch(removeTarget(targetId));\n    this.dropTargets.delete(targetId);\n    this.types.delete(targetId);\n  }\n\n  pinSource(sourceId) {\n    const source = this.getSource(sourceId);\n    invariant(source, 'Expected an existing source.');\n    this.pinnedSourceId = sourceId;\n    this.pinnedSource = source;\n  }\n\n  unpinSource() {\n    invariant(this.pinnedSource, 'No source is pinned at the time.');\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n  }\n\n  addHandler(role, type, handler) {\n    const id = getNextHandlerId(role);\n    this.types.set(id, type);\n\n    if (role === HandlerRole.SOURCE) {\n      this.dragSources.set(id, handler);\n    } else if (role === HandlerRole.TARGET) {\n      this.dropTargets.set(id, handler);\n    }\n\n    return id;\n  }\n\n  constructor(store) {\n    this.types = new Map();\n    this.dragSources = new Map();\n    this.dropTargets = new Map();\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n    this.store = store;\n  }\n\n}\n\nconst strictEquality = (a, b) => a === b;\n/**\n * Determine if two cartesian coordinate offsets are equal\n * @param offsetA\n * @param offsetB\n */\n\nfunction areCoordsEqual(offsetA, offsetB) {\n  if (!offsetA && !offsetB) {\n    return true;\n  } else if (!offsetA || !offsetB) {\n    return false;\n  } else {\n    return offsetA.x === offsetB.x && offsetA.y === offsetB.y;\n  }\n}\n/**\n * Determines if two arrays of items are equal\n * @param a The first array of items\n * @param b The second array of items\n */\n\nfunction areArraysEqual(a, b, isEqual = strictEquality) {\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (let i = 0; i < a.length; ++i) {\n    if (!isEqual(a[i], b[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction reduce$5( // eslint-disable-next-line @typescript-eslint/no-unused-vars\n_state = NONE, action) {\n  switch (action.type) {\n    case HOVER:\n      break;\n\n    case ADD_SOURCE:\n    case ADD_TARGET:\n    case REMOVE_TARGET:\n    case REMOVE_SOURCE:\n      return NONE;\n\n    case BEGIN_DRAG:\n    case PUBLISH_DRAG_SOURCE:\n    case END_DRAG:\n    case DROP:\n    default:\n      return ALL;\n  }\n\n  const {\n    targetIds = [],\n    prevTargetIds = []\n  } = action.payload;\n  const result = xor(targetIds, prevTargetIds);\n  const didChange = result.length > 0 || !areArraysEqual(targetIds, prevTargetIds);\n\n  if (!didChange) {\n    return NONE;\n  } // Check the target ids at the innermost position. If they are valid, add them\n  // to the result\n\n\n  const prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1];\n  const innermostTargetId = targetIds[targetIds.length - 1];\n\n  if (prevInnermostTargetId !== innermostTargetId) {\n    if (prevInnermostTargetId) {\n      result.push(prevInnermostTargetId);\n    }\n\n    if (innermostTargetId) {\n      result.push(innermostTargetId);\n    }\n  }\n\n  return result;\n}\n\nfunction _defineProperty$3(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$3(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nconst initialState$1 = {\n  initialSourceClientOffset: null,\n  initialClientOffset: null,\n  clientOffset: null\n};\nfunction reduce$4(state = initialState$1, action) {\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case INIT_COORDS:\n    case BEGIN_DRAG:\n      return {\n        initialSourceClientOffset: payload.sourceClientOffset,\n        initialClientOffset: payload.clientOffset,\n        clientOffset: payload.clientOffset\n      };\n\n    case HOVER:\n      if (areCoordsEqual(state.clientOffset, payload.clientOffset)) {\n        return state;\n      }\n\n      return _objectSpread$3({}, state, {\n        clientOffset: payload.clientOffset\n      });\n\n    case END_DRAG:\n    case DROP:\n      return initialState$1;\n\n    default:\n      return state;\n  }\n}\n\nfunction _defineProperty$2(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$2(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nconst initialState = {\n  itemType: null,\n  item: null,\n  sourceId: null,\n  targetIds: [],\n  dropResult: null,\n  didDrop: false,\n  isSourcePublic: null\n};\nfunction reduce$3(state = initialState, action) {\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case BEGIN_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: payload.itemType,\n        item: payload.item,\n        sourceId: payload.sourceId,\n        isSourcePublic: payload.isSourcePublic,\n        dropResult: null,\n        didDrop: false\n      });\n\n    case PUBLISH_DRAG_SOURCE:\n      return _objectSpread$2({}, state, {\n        isSourcePublic: true\n      });\n\n    case HOVER:\n      return _objectSpread$2({}, state, {\n        targetIds: payload.targetIds\n      });\n\n    case REMOVE_TARGET:\n      if (state.targetIds.indexOf(payload.targetId) === -1) {\n        return state;\n      }\n\n      return _objectSpread$2({}, state, {\n        targetIds: without$1(state.targetIds, payload.targetId)\n      });\n\n    case DROP:\n      return _objectSpread$2({}, state, {\n        dropResult: payload.dropResult,\n        didDrop: true,\n        targetIds: []\n      });\n\n    case END_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: null,\n        item: null,\n        sourceId: null,\n        dropResult: null,\n        didDrop: false,\n        isSourcePublic: null,\n        targetIds: []\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$2(state = 0, action) {\n  switch (action.type) {\n    case ADD_SOURCE:\n    case ADD_TARGET:\n      return state + 1;\n\n    case REMOVE_SOURCE:\n    case REMOVE_TARGET:\n      return state - 1;\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$1(state = 0) {\n  return state + 1;\n}\n\nfunction _defineProperty$1(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$1(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nfunction reduce(state = {}, action) {\n  return {\n    dirtyHandlerIds: reduce$5(state.dirtyHandlerIds, {\n      type: action.type,\n      payload: _objectSpread$1({}, action.payload, {\n        prevTargetIds: get(state, 'dragOperation.targetIds', [])\n      })\n    }),\n    dragOffset: reduce$4(state.dragOffset, action),\n    refCount: reduce$2(state.refCount, action),\n    dragOperation: reduce$3(state.dragOperation, action),\n    stateId: reduce$1(state.stateId)\n  };\n}\n\nfunction createDragDropManager(backendFactory, globalContext = undefined, backendOptions = {}, debugMode = false) {\n  const store = makeStoreInstance(debugMode);\n  const monitor = new DragDropMonitorImpl(store, new HandlerRegistryImpl(store));\n  const manager = new DragDropManagerImpl(store, monitor);\n  const backend = backendFactory(manager, globalContext, backendOptions);\n  manager.receiveBackend(backend);\n  return manager;\n}\n\nfunction makeStoreInstance(debugMode) {\n  // TODO: if we ever make a react-native version of this,\n  // we'll need to consider how to pull off dev-tooling\n  const reduxDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n  return createStore(reduce, debugMode && reduxDevTools && reduxDevTools({\n    name: 'dnd-core',\n    instanceId: 'dnd-core'\n  }));\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\nlet refCount = 0;\nconst INSTANCE_SYM = Symbol.for('__REACT_DND_CONTEXT_INSTANCE__');\nvar DndProvider = /*#__PURE__*/memo(function DndProvider(_param) {\n  var {\n    children\n  } = _param,\n      props = _objectWithoutProperties(_param, [\"children\"]);\n\n  const [manager, isGlobalInstance] = getDndContextValue(props) // memoized from props\n  ;\n  /**\n  * If the global context was used to store the DND context\n  * then where theres no more references to it we should\n  * clean it up to avoid memory leaks\n  */\n\n  useEffect(() => {\n    if (isGlobalInstance) {\n      const context = getGlobalContext();\n      ++refCount;\n      return () => {\n        if (--refCount === 0) {\n          context[INSTANCE_SYM] = null;\n        }\n      };\n    }\n\n    return;\n  }, []);\n  return /*#__PURE__*/jsx(DndContext.Provider, {\n    value: manager,\n    children: children\n  });\n});\n\nfunction getDndContextValue(props) {\n  if ('manager' in props) {\n    const manager = {\n      dragDropManager: props.manager\n    };\n    return [manager, false];\n  }\n\n  const manager = createSingletonDndContext(props.backend, props.context, props.options, props.debugMode);\n  const isGlobalInstance = !props.context;\n  return [manager, isGlobalInstance];\n}\n\nfunction createSingletonDndContext(backend, context = getGlobalContext(), options, debugMode) {\n  const ctx = context;\n\n  if (!ctx[INSTANCE_SYM]) {\n    ctx[INSTANCE_SYM] = {\n      dragDropManager: createDragDropManager(backend, context, options, debugMode)\n    };\n  }\n\n  return ctx[INSTANCE_SYM];\n}\n\nfunction getGlobalContext() {\n  return typeof global !== 'undefined' ? global : window;\n}\n\nvar fastDeepEqual = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n    var length, i, keys;\n\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n\n      for (i = length; i-- !== 0;) if (!equal(a[i], b[i])) return false;\n\n      return true;\n    }\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;) if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  } // true if both NaN, false otherwise\n\n\n  return a !== a && b !== b;\n};\n\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\n/**\n *\n * @param monitor The monitor to collect state from\n * @param collect The collecting function\n * @param onUpdate A method to invoke when updates occur\n */\n\nfunction useCollector(monitor, collect, onUpdate) {\n  const [collected, setCollected] = useState(() => collect(monitor));\n  const updateCollected = useCallback(() => {\n    const nextValue = collect(monitor); // This needs to be a deep-equality check because some monitor-collected values\n    // include XYCoord objects that may be equivalent, but do not have instance equality.\n\n    if (!fastDeepEqual(collected, nextValue)) {\n      setCollected(nextValue);\n\n      if (onUpdate) {\n        onUpdate();\n      }\n    }\n  }, [collected, monitor, onUpdate]); // update the collected properties after react renders.\n  // Note that the \"Dustbin Stress Test\" fails if this is not\n  // done when the component updates\n\n  useIsomorphicLayoutEffect(updateCollected);\n  return [collected, updateCollected];\n}\n\nfunction useMonitorOutput(monitor, collect, onCollect) {\n  const [collected, updateCollected] = useCollector(monitor, collect, onCollect);\n  useIsomorphicLayoutEffect(function subscribeToMonitorStateChange() {\n    const handlerId = monitor.getHandlerId();\n\n    if (handlerId == null) {\n      return;\n    }\n\n    return monitor.subscribeToStateChange(updateCollected, {\n      handlerIds: [handlerId]\n    });\n  }, [monitor, updateCollected]);\n  return collected;\n}\n\nfunction useCollectedProps(collector, monitor, connector) {\n  return useMonitorOutput(monitor, collector || (() => ({})), () => connector.reconnect());\n}\n\nfunction useOptionalFactory(arg, deps) {\n  const memoDeps = [...(deps || [])];\n\n  if (deps == null && typeof arg !== 'function') {\n    memoDeps.push(arg);\n  }\n\n  return useMemo(() => {\n    return typeof arg === 'function' ? arg() : arg;\n  }, memoDeps);\n}\n\nfunction useConnectDragSource(connector) {\n  return useMemo(() => connector.hooks.dragSource(), [connector]);\n}\nfunction useConnectDragPreview(connector) {\n  return useMemo(() => connector.hooks.dragPreview(), [connector]);\n}\n\nlet isCallingCanDrag = false;\nlet isCallingIsDragging = false;\nclass DragSourceMonitorImpl {\n  receiveHandlerId(sourceId) {\n    this.sourceId = sourceId;\n  }\n\n  getHandlerId() {\n    return this.sourceId;\n  }\n\n  canDrag() {\n    invariant(!isCallingCanDrag, 'You may not call monitor.canDrag() inside your canDrag() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingCanDrag = true;\n      return this.internalMonitor.canDragSource(this.sourceId);\n    } finally {\n      isCallingCanDrag = false;\n    }\n  }\n\n  isDragging() {\n    if (!this.sourceId) {\n      return false;\n    }\n\n    invariant(!isCallingIsDragging, 'You may not call monitor.isDragging() inside your isDragging() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingIsDragging = true;\n      return this.internalMonitor.isDraggingSource(this.sourceId);\n    } finally {\n      isCallingIsDragging = false;\n    }\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  isDraggingSource(sourceId) {\n    return this.internalMonitor.isDraggingSource(sourceId);\n  }\n\n  isOverTarget(targetId, options) {\n    return this.internalMonitor.isOverTarget(targetId, options);\n  }\n\n  getTargetIds() {\n    return this.internalMonitor.getTargetIds();\n  }\n\n  isSourcePublic() {\n    return this.internalMonitor.isSourcePublic();\n  }\n\n  getSourceId() {\n    return this.internalMonitor.getSourceId();\n  }\n\n  subscribeToOffsetChange(listener) {\n    return this.internalMonitor.subscribeToOffsetChange(listener);\n  }\n\n  canDragSource(sourceId) {\n    return this.internalMonitor.canDragSource(sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    return this.internalMonitor.canDropOnTarget(targetId);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.sourceId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nlet isCallingCanDrop = false;\nclass DropTargetMonitorImpl {\n  receiveHandlerId(targetId) {\n    this.targetId = targetId;\n  }\n\n  getHandlerId() {\n    return this.targetId;\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  canDrop() {\n    // Cut out early if the target id has not been set. This should prevent errors\n    // where the user has an older version of dnd-core like in\n    // https://github.com/react-dnd/react-dnd/issues/1310\n    if (!this.targetId) {\n      return false;\n    }\n\n    invariant(!isCallingCanDrop, 'You may not call monitor.canDrop() inside your canDrop() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor');\n\n    try {\n      isCallingCanDrop = true;\n      return this.internalMonitor.canDropOnTarget(this.targetId);\n    } finally {\n      isCallingCanDrop = false;\n    }\n  }\n\n  isOver(options) {\n    if (!this.targetId) {\n      return false;\n    }\n\n    return this.internalMonitor.isOverTarget(this.targetId, options);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.targetId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nfunction registerTarget(type, target, manager) {\n  const registry = manager.getRegistry();\n  const targetId = registry.addTarget(type, target);\n  return [targetId, () => registry.removeTarget(targetId)];\n}\nfunction registerSource(type, source, manager) {\n  const registry = manager.getRegistry();\n  const sourceId = registry.addSource(type, source);\n  return [sourceId, () => registry.removeSource(sourceId)];\n}\n\nfunction shallowEqual(objA, objB, compare, compareContext) {\n  let compareResult = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (compareResult !== void 0) {\n    return !!compareResult;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== 'object' || !objA || typeof objB !== 'object' || !objB) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  const bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB); // Test for A's keys different from B.\n\n  for (let idx = 0; idx < keysA.length; idx++) {\n    const key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    const valueA = objA[key];\n    const valueB = objB[key];\n    compareResult = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (compareResult === false || compareResult === void 0 && valueA !== valueB) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isRef(obj) {\n  return (// eslint-disable-next-line no-prototype-builtins\n    obj !== null && typeof obj === 'object' && Object.prototype.hasOwnProperty.call(obj, 'current')\n  );\n}\n\nfunction throwIfCompositeComponentElement(element) {\n  // Custom components can no longer be wrapped directly in React DnD 2.0\n  // so that we don't need to depend on findDOMNode() from react-dom.\n  if (typeof element.type === 'string') {\n    return;\n  }\n\n  const displayName = element.type.displayName || element.type.name || 'the component';\n  throw new Error('Only native element nodes can now be passed to React DnD connectors.' + `You can either wrap ${displayName} into a <div>, or turn it into a ` + 'drag source or a drop target itself.');\n}\n\nfunction wrapHookToRecognizeElement(hook) {\n  return (elementOrNode = null, options = null) => {\n    // When passed a node, call the hook straight away.\n    if (! /*#__PURE__*/isValidElement(elementOrNode)) {\n      const node = elementOrNode;\n      hook(node, options); // return the node so it can be chained (e.g. when within callback refs\n      // <div ref={node => connectDragSource(connectDropTarget(node))}/>\n\n      return node;\n    } // If passed a ReactElement, clone it and attach this function as a ref.\n    // This helps us achieve a neat API where user doesn't even know that refs\n    // are being used under the hood.\n\n\n    const element = elementOrNode;\n    throwIfCompositeComponentElement(element); // When no options are passed, use the hook directly\n\n    const ref = options ? node => hook(node, options) : hook;\n    return cloneWithRef(element, ref);\n  };\n}\n\nfunction wrapConnectorHooks(hooks) {\n  const wrappedHooks = {};\n  Object.keys(hooks).forEach(key => {\n    const hook = hooks[key]; // ref objects should be passed straight through without wrapping\n\n    if (key.endsWith('Ref')) {\n      wrappedHooks[key] = hooks[key];\n    } else {\n      const wrappedHook = wrapHookToRecognizeElement(hook);\n\n      wrappedHooks[key] = () => wrappedHook;\n    }\n  });\n  return wrappedHooks;\n}\n\nfunction setRef(ref, node) {\n  if (typeof ref === 'function') {\n    ref(node);\n  } else {\n    ref.current = node;\n  }\n}\n\nfunction cloneWithRef(element, newRef) {\n  const previousRef = element.ref;\n  invariant(typeof previousRef !== 'string', 'Cannot connect React DnD to an element with an existing string ref. ' + 'Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. ' + 'Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs');\n\n  if (!previousRef) {\n    // When there is no ref on the element, use the new ref directly\n    return /*#__PURE__*/cloneElement(element, {\n      ref: newRef\n    });\n  } else {\n    return /*#__PURE__*/cloneElement(element, {\n      ref: node => {\n        setRef(previousRef, node);\n        setRef(newRef, node);\n      }\n    });\n  }\n}\n\nclass SourceConnector {\n  receiveHandlerId(newHandlerId) {\n    if (this.handlerId === newHandlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get connectTarget() {\n    return this.dragSource;\n  }\n\n  get dragSourceOptions() {\n    return this.dragSourceOptionsInternal;\n  }\n\n  set dragSourceOptions(options) {\n    this.dragSourceOptionsInternal = options;\n  }\n\n  get dragPreviewOptions() {\n    return this.dragPreviewOptionsInternal;\n  }\n\n  set dragPreviewOptions(options) {\n    this.dragPreviewOptionsInternal = options;\n  }\n\n  reconnect() {\n    const didChange = this.reconnectDragSource();\n    this.reconnectDragPreview(didChange);\n  }\n\n  reconnectDragSource() {\n    const dragSource = this.dragSource; // if nothing has changed then don't resubscribe\n\n    const didChange = this.didHandlerIdChange() || this.didConnectedDragSourceChange() || this.didDragSourceOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragSource();\n    }\n\n    if (!this.handlerId) {\n      return didChange;\n    }\n\n    if (!dragSource) {\n      this.lastConnectedDragSource = dragSource;\n      return didChange;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragSource = dragSource;\n      this.lastConnectedDragSourceOptions = this.dragSourceOptions;\n      this.dragSourceUnsubscribe = this.backend.connectDragSource(this.handlerId, dragSource, this.dragSourceOptions);\n    }\n\n    return didChange;\n  }\n\n  reconnectDragPreview(forceDidChange = false) {\n    const dragPreview = this.dragPreview; // if nothing has changed then don't resubscribe\n\n    const didChange = forceDidChange || this.didHandlerIdChange() || this.didConnectedDragPreviewChange() || this.didDragPreviewOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragPreview();\n    }\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dragPreview) {\n      this.lastConnectedDragPreview = dragPreview;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragPreview = dragPreview;\n      this.lastConnectedDragPreviewOptions = this.dragPreviewOptions;\n      this.dragPreviewUnsubscribe = this.backend.connectDragPreview(this.handlerId, dragPreview, this.dragPreviewOptions);\n    }\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didConnectedDragSourceChange() {\n    return this.lastConnectedDragSource !== this.dragSource;\n  }\n\n  didConnectedDragPreviewChange() {\n    return this.lastConnectedDragPreview !== this.dragPreview;\n  }\n\n  didDragSourceOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragSourceOptions, this.dragSourceOptions);\n  }\n\n  didDragPreviewOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragPreviewOptions, this.dragPreviewOptions);\n  }\n\n  disconnectDragSource() {\n    if (this.dragSourceUnsubscribe) {\n      this.dragSourceUnsubscribe();\n      this.dragSourceUnsubscribe = undefined;\n    }\n  }\n\n  disconnectDragPreview() {\n    if (this.dragPreviewUnsubscribe) {\n      this.dragPreviewUnsubscribe();\n      this.dragPreviewUnsubscribe = undefined;\n      this.dragPreviewNode = null;\n      this.dragPreviewRef = null;\n    }\n  }\n\n  get dragSource() {\n    return this.dragSourceNode || this.dragSourceRef && this.dragSourceRef.current;\n  }\n\n  get dragPreview() {\n    return this.dragPreviewNode || this.dragPreviewRef && this.dragPreviewRef.current;\n  }\n\n  clearDragSource() {\n    this.dragSourceNode = null;\n    this.dragSourceRef = null;\n  }\n\n  clearDragPreview() {\n    this.dragPreviewNode = null;\n    this.dragPreviewRef = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dragSource: (node, options) => {\n        this.clearDragSource();\n        this.dragSourceOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragSourceRef = node;\n        } else {\n          this.dragSourceNode = node;\n        }\n\n        this.reconnectDragSource();\n      },\n      dragPreview: (node, options) => {\n        this.clearDragPreview();\n        this.dragPreviewOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragPreviewRef = node;\n        } else {\n          this.dragPreviewNode = node;\n        }\n\n        this.reconnectDragPreview();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dragSourceRef = null;\n    this.dragSourceOptionsInternal = null; // The drag preview may either be attached via ref or connect function\n\n    this.dragPreviewRef = null;\n    this.dragPreviewOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDragSource = null;\n    this.lastConnectedDragSourceOptions = null;\n    this.lastConnectedDragPreview = null;\n    this.lastConnectedDragPreviewOptions = null;\n    this.backend = backend;\n  }\n\n}\n\nclass TargetConnector {\n  get connectTarget() {\n    return this.dropTarget;\n  }\n\n  reconnect() {\n    // if nothing has changed then don't resubscribe\n    const didChange = this.didHandlerIdChange() || this.didDropTargetChange() || this.didOptionsChange();\n\n    if (didChange) {\n      this.disconnectDropTarget();\n    }\n\n    const dropTarget = this.dropTarget;\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dropTarget) {\n      this.lastConnectedDropTarget = dropTarget;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDropTarget = dropTarget;\n      this.lastConnectedDropTargetOptions = this.dropTargetOptions;\n      this.unsubscribeDropTarget = this.backend.connectDropTarget(this.handlerId, dropTarget, this.dropTargetOptions);\n    }\n  }\n\n  receiveHandlerId(newHandlerId) {\n    if (newHandlerId === this.handlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get dropTargetOptions() {\n    return this.dropTargetOptionsInternal;\n  }\n\n  set dropTargetOptions(options) {\n    this.dropTargetOptionsInternal = options;\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didDropTargetChange() {\n    return this.lastConnectedDropTarget !== this.dropTarget;\n  }\n\n  didOptionsChange() {\n    return !shallowEqual(this.lastConnectedDropTargetOptions, this.dropTargetOptions);\n  }\n\n  disconnectDropTarget() {\n    if (this.unsubscribeDropTarget) {\n      this.unsubscribeDropTarget();\n      this.unsubscribeDropTarget = undefined;\n    }\n  }\n\n  get dropTarget() {\n    return this.dropTargetNode || this.dropTargetRef && this.dropTargetRef.current;\n  }\n\n  clearDropTarget() {\n    this.dropTargetRef = null;\n    this.dropTargetNode = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dropTarget: (node, options) => {\n        this.clearDropTarget();\n        this.dropTargetOptions = options;\n\n        if (isRef(node)) {\n          this.dropTargetRef = node;\n        } else {\n          this.dropTargetNode = node;\n        }\n\n        this.reconnect();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dropTargetRef = null;\n    this.dropTargetOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDropTarget = null;\n    this.lastConnectedDropTargetOptions = null;\n    this.backend = backend;\n  }\n\n}\n\n/**\n * A hook to retrieve the DragDropManager from Context\n */\n\nfunction useDragDropManager() {\n  const {\n    dragDropManager\n  } = useContext(DndContext);\n  invariant(dragDropManager != null, 'Expected drag drop context');\n  return dragDropManager;\n}\n\nfunction useDragSourceConnector(dragSourceOptions, dragPreviewOptions) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new SourceConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragSourceOptions = dragSourceOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragSource();\n  }, [connector, dragSourceOptions]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragPreviewOptions = dragPreviewOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragPreview();\n  }, [connector, dragPreviewOptions]);\n  return connector;\n}\n\nfunction useDragSourceMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DragSourceMonitorImpl(manager), [manager]);\n}\n\nclass DragSourceImpl {\n  beginDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    let result = null;\n\n    if (typeof spec.item === 'object') {\n      result = spec.item;\n    } else if (typeof spec.item === 'function') {\n      result = spec.item(monitor);\n    } else {\n      result = {};\n    }\n\n    return result !== null && result !== void 0 ? result : null;\n  }\n\n  canDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (typeof spec.canDrag === 'boolean') {\n      return spec.canDrag;\n    } else if (typeof spec.canDrag === 'function') {\n      return spec.canDrag(monitor);\n    } else {\n      return true;\n    }\n  }\n\n  isDragging(globalMonitor, target) {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const {\n      isDragging\n    } = spec;\n    return isDragging ? isDragging(monitor) : target === globalMonitor.getSourceId();\n  }\n\n  endDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const connector = this.connector;\n    const {\n      end\n    } = spec;\n\n    if (end) {\n      end(monitor.getItem(), monitor);\n    }\n\n    connector.reconnect();\n  }\n\n  constructor(spec, monitor, connector) {\n    this.spec = spec;\n    this.monitor = monitor;\n    this.connector = connector;\n  }\n\n}\n\nfunction useDragSource(spec, monitor, connector) {\n  const handler = useMemo(() => new DragSourceImpl(spec, monitor, connector), [monitor, connector]);\n  useEffect(() => {\n    handler.spec = spec;\n  }, [spec]);\n  return handler;\n}\n\nfunction useDragType(spec) {\n  return useMemo(() => {\n    const result = spec.type;\n    invariant(result != null, 'spec.type must be defined');\n    return result;\n  }, [spec]);\n}\n\nfunction useRegisteredDragSource(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const handler = useDragSource(spec, monitor, connector);\n  const itemType = useDragType(spec);\n  useIsomorphicLayoutEffect(function registerDragSource() {\n    if (itemType != null) {\n      const [handlerId, unregister] = registerSource(itemType, handler, manager);\n      monitor.receiveHandlerId(handlerId);\n      connector.receiveHandlerId(handlerId);\n      return unregister;\n    }\n\n    return;\n  }, [manager, monitor, connector, handler, itemType]);\n}\n\n/**\n * useDragSource hook\n * @param sourceSpec The drag source specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrag(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  invariant(!spec.begin, `useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)`);\n  const monitor = useDragSourceMonitor();\n  const connector = useDragSourceConnector(spec.options, spec.previewOptions);\n  useRegisteredDragSource(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDragSource(connector), useConnectDragPreview(connector)];\n}\n\n/**\n * useDragLayer Hook\n * @param collector The property collector\n */\n\nfunction useDragLayer(collect) {\n  const dragDropManager = useDragDropManager();\n  const monitor = dragDropManager.getMonitor();\n  const [collected, updateCollected] = useCollector(monitor, collect);\n  useEffect(() => monitor.subscribeToOffsetChange(updateCollected));\n  useEffect(() => monitor.subscribeToStateChange(updateCollected));\n  return collected;\n}\n\nfunction useConnectDropTarget(connector) {\n  return useMemo(() => connector.hooks.dropTarget(), [connector]);\n}\n\nfunction useDropTargetConnector(options) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new TargetConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dropTargetOptions = options || null;\n    connector.reconnect();\n    return () => connector.disconnectDropTarget();\n  }, [options]);\n  return connector;\n}\n\nfunction useDropTargetMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DropTargetMonitorImpl(manager), [manager]);\n}\n\n/**\n * Internal utility hook to get an array-version of spec.accept.\n * The main utility here is that we aren't creating a new array on every render if a non-array spec.accept is passed in.\n * @param spec\n */\n\nfunction useAccept(spec) {\n  const {\n    accept\n  } = spec;\n  return useMemo(() => {\n    invariant(spec.accept != null, 'accept must be defined');\n    return Array.isArray(accept) ? accept : [accept];\n  }, [accept]);\n}\n\nclass DropTargetImpl {\n  canDrop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    return spec.canDrop ? spec.canDrop(monitor.getItem(), monitor) : true;\n  }\n\n  hover() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.hover) {\n      spec.hover(monitor.getItem(), monitor);\n    }\n  }\n\n  drop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.drop) {\n      return spec.drop(monitor.getItem(), monitor);\n    }\n\n    return;\n  }\n\n  constructor(spec, monitor) {\n    this.spec = spec;\n    this.monitor = monitor;\n  }\n\n}\n\nfunction useDropTarget(spec, monitor) {\n  const dropTarget = useMemo(() => new DropTargetImpl(spec, monitor), [monitor]);\n  useEffect(() => {\n    dropTarget.spec = spec;\n  }, [spec]);\n  return dropTarget;\n}\n\nfunction useRegisteredDropTarget(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const dropTarget = useDropTarget(spec, monitor);\n  const accept = useAccept(spec);\n  useIsomorphicLayoutEffect(function registerDropTarget() {\n    const [handlerId, unregister] = registerTarget(accept, dropTarget, manager);\n    monitor.receiveHandlerId(handlerId);\n    connector.receiveHandlerId(handlerId);\n    return unregister;\n  }, [manager, monitor, dropTarget, connector, accept.map(a => a.toString()).join('|')]);\n}\n\n/**\n * useDropTarget Hook\n * @param spec The drop target specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrop(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  const monitor = useDropTargetMonitor();\n  const connector = useDropTargetConnector(spec.options);\n  useRegisteredDropTarget(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDropTarget(connector)];\n}\n\n// cheap lodash replacements\nfunction memoize(fn) {\n  let result = null;\n\n  const memoized = () => {\n    if (result == null) {\n      result = fn();\n    }\n\n    return result;\n  };\n\n  return memoized;\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without(items, item) {\n  return items.filter(i => i !== item);\n}\nfunction union(itemsA, itemsB) {\n  const set = new Set();\n\n  const insertItem = item => set.add(item);\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  set.forEach(key => result.push(key));\n  return result;\n}\n\nclass EnterLeaveCounter {\n  enter(enteringNode) {\n    const previousLength = this.entered.length;\n\n    const isNodeEntered = node => this.isNodeInDocument(node) && (!node.contains || node.contains(enteringNode));\n\n    this.entered = union(this.entered.filter(isNodeEntered), [enteringNode]);\n    return previousLength === 0 && this.entered.length > 0;\n  }\n\n  leave(leavingNode) {\n    const previousLength = this.entered.length;\n    this.entered = without(this.entered.filter(this.isNodeInDocument), leavingNode);\n    return previousLength > 0 && this.entered.length === 0;\n  }\n\n  reset() {\n    this.entered = [];\n  }\n\n  constructor(isNodeInDocument) {\n    this.entered = [];\n    this.isNodeInDocument = isNodeInDocument;\n  }\n\n}\n\nclass NativeDragSource {\n  initializeExposedProperties() {\n    Object.keys(this.config.exposeProperties).forEach(property => {\n      Object.defineProperty(this.item, property, {\n        configurable: true,\n        enumerable: true,\n\n        get() {\n          // eslint-disable-next-line no-console\n          console.warn(`Browser doesn't allow reading \"${property}\" until the drop event.`);\n          return null;\n        }\n\n      });\n    });\n  }\n\n  loadDataTransfer(dataTransfer) {\n    if (dataTransfer) {\n      const newProperties = {};\n      Object.keys(this.config.exposeProperties).forEach(property => {\n        const propertyFn = this.config.exposeProperties[property];\n\n        if (propertyFn != null) {\n          newProperties[property] = {\n            value: propertyFn(dataTransfer, this.config.matchesTypes),\n            configurable: true,\n            enumerable: true\n          };\n        }\n      });\n      Object.defineProperties(this.item, newProperties);\n    }\n  }\n\n  canDrag() {\n    return true;\n  }\n\n  beginDrag() {\n    return this.item;\n  }\n\n  isDragging(monitor, handle) {\n    return handle === monitor.getSourceId();\n  }\n\n  endDrag() {// empty\n  }\n\n  constructor(config) {\n    this.config = config;\n    this.item = {};\n    this.initializeExposedProperties();\n  }\n\n}\n\nconst FILE = '__NATIVE_FILE__';\nconst URL = '__NATIVE_URL__';\nconst TEXT = '__NATIVE_TEXT__';\nconst HTML = '__NATIVE_HTML__';\n\nvar NativeTypes = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    FILE: FILE,\n    URL: URL,\n    TEXT: TEXT,\n    HTML: HTML\n});\n\nfunction getDataFromDataTransfer(dataTransfer, typesToTry, defaultValue) {\n  const result = typesToTry.reduce((resultSoFar, typeToTry) => resultSoFar || dataTransfer.getData(typeToTry), '');\n  return result != null ? result : defaultValue;\n}\n\nconst nativeTypesConfig = {\n  [FILE]: {\n    exposeProperties: {\n      files: dataTransfer => Array.prototype.slice.call(dataTransfer.files),\n      items: dataTransfer => dataTransfer.items,\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Files']\n  },\n  [HTML]: {\n    exposeProperties: {\n      html: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Html', 'text/html']\n  },\n  [URL]: {\n    exposeProperties: {\n      urls: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, '').split('\\n'),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Url', 'text/uri-list']\n  },\n  [TEXT]: {\n    exposeProperties: {\n      text: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Text', 'text/plain']\n  }\n};\n\nfunction createNativeDragSource(type, dataTransfer) {\n  const config = nativeTypesConfig[type];\n\n  if (!config) {\n    throw new Error(`native type ${type} has no configuration`);\n  }\n\n  const result = new NativeDragSource(config);\n  result.loadDataTransfer(dataTransfer);\n  return result;\n}\nfunction matchNativeItemType(dataTransfer) {\n  if (!dataTransfer) {\n    return null;\n  }\n\n  const dataTransferTypes = Array.prototype.slice.call(dataTransfer.types || []);\n  return Object.keys(nativeTypesConfig).filter(nativeItemType => {\n    const typeConfig = nativeTypesConfig[nativeItemType];\n\n    if (!(typeConfig === null || typeConfig === void 0 ? void 0 : typeConfig.matchesTypes)) {\n      return false;\n    }\n\n    return typeConfig.matchesTypes.some(t => dataTransferTypes.indexOf(t) > -1);\n  })[0] || null;\n}\n\nconst isFirefox = memoize(() => /firefox/i.test(navigator.userAgent));\nconst isSafari = memoize(() => Boolean(window.safari));\n\nclass MonotonicInterpolant {\n  interpolate(x) {\n    const {\n      xs,\n      ys,\n      c1s,\n      c2s,\n      c3s\n    } = this; // The rightmost point in the dataset should give an exact result\n\n    let i = xs.length - 1;\n\n    if (x === xs[i]) {\n      return ys[i];\n    } // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n\n\n    let low = 0;\n    let high = c3s.length - 1;\n    let mid;\n\n    while (low <= high) {\n      mid = Math.floor(0.5 * (low + high));\n      const xHere = xs[mid];\n\n      if (xHere < x) {\n        low = mid + 1;\n      } else if (xHere > x) {\n        high = mid - 1;\n      } else {\n        return ys[mid];\n      }\n    }\n\n    i = Math.max(0, high); // Interpolate\n\n    const diff = x - xs[i];\n    const diffSq = diff * diff;\n    return ys[i] + c1s[i] * diff + c2s[i] * diffSq + c3s[i] * diff * diffSq;\n  }\n\n  constructor(xs, ys) {\n    const {\n      length\n    } = xs; // Rearrange xs and ys so that xs is sorted\n\n    const indexes = [];\n\n    for (let i = 0; i < length; i++) {\n      indexes.push(i);\n    }\n\n    indexes.sort((a, b) => xs[a] < xs[b] ? -1 : 1); // Get consecutive differences and slopes\n    const dxs = [];\n    const ms = [];\n    let dx;\n    let dy;\n\n    for (let i1 = 0; i1 < length - 1; i1++) {\n      dx = xs[i1 + 1] - xs[i1];\n      dy = ys[i1 + 1] - ys[i1];\n      dxs.push(dx);\n      ms.push(dy / dx);\n    } // Get degree-1 coefficients\n\n\n    const c1s = [ms[0]];\n\n    for (let i2 = 0; i2 < dxs.length - 1; i2++) {\n      const m2 = ms[i2];\n      const mNext = ms[i2 + 1];\n\n      if (m2 * mNext <= 0) {\n        c1s.push(0);\n      } else {\n        dx = dxs[i2];\n        const dxNext = dxs[i2 + 1];\n        const common = dx + dxNext;\n        c1s.push(3 * common / ((common + dxNext) / m2 + (common + dx) / mNext));\n      }\n    }\n\n    c1s.push(ms[ms.length - 1]); // Get degree-2 and degree-3 coefficients\n\n    const c2s = [];\n    const c3s = [];\n    let m;\n\n    for (let i3 = 0; i3 < c1s.length - 1; i3++) {\n      m = ms[i3];\n      const c1 = c1s[i3];\n      const invDx = 1 / dxs[i3];\n      const common = c1 + c1s[i3 + 1] - m - m;\n      c2s.push((m - c1 - common) * invDx);\n      c3s.push(common * invDx * invDx);\n    }\n\n    this.xs = xs;\n    this.ys = ys;\n    this.c1s = c1s;\n    this.c2s = c2s;\n    this.c3s = c3s;\n  }\n\n}\n\nconst ELEMENT_NODE$1 = 1;\nfunction getNodeClientOffset$1(node) {\n  const el = node.nodeType === ELEMENT_NODE$1 ? node : node.parentElement;\n\n  if (!el) {\n    return null;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientOffset$1(e) {\n  return {\n    x: e.clientX,\n    y: e.clientY\n  };\n}\n\nfunction isImageNode(node) {\n  var ref;\n  return node.nodeName === 'IMG' && (isFirefox() || !((ref = document.documentElement) === null || ref === void 0 ? void 0 : ref.contains(node)));\n}\n\nfunction getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight) {\n  let dragPreviewWidth = isImage ? dragPreview.width : sourceWidth;\n  let dragPreviewHeight = isImage ? dragPreview.height : sourceHeight; // Work around @2x coordinate discrepancies in browsers\n\n  if (isSafari() && isImage) {\n    dragPreviewHeight /= window.devicePixelRatio;\n    dragPreviewWidth /= window.devicePixelRatio;\n  }\n\n  return {\n    dragPreviewWidth,\n    dragPreviewHeight\n  };\n}\n\nfunction getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint) {\n  // The browsers will use the image intrinsic size under different conditions.\n  // Firefox only cares if it's an image, but WebKit also wants it to be detached.\n  const isImage = isImageNode(dragPreview);\n  const dragPreviewNode = isImage ? sourceNode : dragPreview;\n  const dragPreviewNodeOffsetFromClient = getNodeClientOffset$1(dragPreviewNode);\n  const offsetFromDragPreview = {\n    x: clientOffset.x - dragPreviewNodeOffsetFromClient.x,\n    y: clientOffset.y - dragPreviewNodeOffsetFromClient.y\n  };\n  const {\n    offsetWidth: sourceWidth,\n    offsetHeight: sourceHeight\n  } = sourceNode;\n  const {\n    anchorX,\n    anchorY\n  } = anchorPoint;\n  const {\n    dragPreviewWidth,\n    dragPreviewHeight\n  } = getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight);\n\n  const calculateYOffset = () => {\n    const interpolantY = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the top\n    offsetFromDragPreview.y, // Align at the center\n    offsetFromDragPreview.y / sourceHeight * dragPreviewHeight, // Dock to the bottom\n    offsetFromDragPreview.y + dragPreviewHeight - sourceHeight]);\n    let y = interpolantY.interpolate(anchorY); // Work around Safari 8 positioning bug\n\n    if (isSafari() && isImage) {\n      // We'll have to wait for @3x to see if this is entirely correct\n      y += (window.devicePixelRatio - 1) * dragPreviewHeight;\n    }\n\n    return y;\n  };\n\n  const calculateXOffset = () => {\n    // Interpolate coordinates depending on anchor point\n    // If you know a simpler way to do this, let me know\n    const interpolantX = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the left\n    offsetFromDragPreview.x, // Align at the center\n    offsetFromDragPreview.x / sourceWidth * dragPreviewWidth, // Dock to the right\n    offsetFromDragPreview.x + dragPreviewWidth - sourceWidth]);\n    return interpolantX.interpolate(anchorX);\n  }; // Force offsets if specified in the options.\n\n\n  const {\n    offsetX,\n    offsetY\n  } = offsetPoint;\n  const isManualOffsetX = offsetX === 0 || offsetX;\n  const isManualOffsetY = offsetY === 0 || offsetY;\n  return {\n    x: isManualOffsetX ? offsetX : calculateXOffset(),\n    y: isManualOffsetY ? offsetY : calculateYOffset()\n  };\n}\n\nclass OptionsReader$1 {\n  get window() {\n    if (this.globalContext) {\n      return this.globalContext;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.globalContext) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.globalContext.document;\n    } else if (this.window) {\n      return this.window.document;\n    } else {\n      return undefined;\n    }\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.optionsArgs) === null || ref === void 0 ? void 0 : ref.rootElement) || this.window;\n  }\n\n  constructor(globalContext, options) {\n    this.ownerDocument = null;\n    this.globalContext = globalContext;\n    this.optionsArgs = options;\n  }\n\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nclass HTML5BackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref, ref1;\n    return {\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      sourceNodeOptions: this.sourceNodeOptions.size,\n      sourceNodes: this.sourceNodes.size,\n      dragStartSourceIds: ((ref = this.dragStartSourceIds) === null || ref === void 0 ? void 0 : ref.length) || 0,\n      dropTargetIds: this.dropTargetIds.length,\n      dragEnterTargetIds: this.dragEnterTargetIds.length,\n      dragOverTargetIds: ((ref1 = this.dragOverTargetIds) === null || ref1 === void 0 ? void 0 : ref1.length) || 0\n    };\n  } // public for test\n\n\n  get window() {\n    return this.options.window;\n  }\n\n  get document() {\n    return this.options.document;\n  }\n  /**\n  * Get the root element to use for event subscriptions\n  */\n\n\n  get rootElement() {\n    return this.options.rootElement;\n  }\n\n  setup() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    if (root.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n\n    root.__isReactDndBackendSetUp = true;\n    this.addEventListeners(root);\n  }\n\n  teardown() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    root.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.rootElement);\n    this.clearCurrentDragSourceNode();\n\n    if (this.asyncEndDragFrameId) {\n      var ref;\n      (ref = this.window) === null || ref === void 0 ? void 0 : ref.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDragSource(sourceId, node, options) {\n    this.sourceNodes.set(sourceId, node);\n    this.sourceNodeOptions.set(sourceId, options);\n\n    const handleDragStart = e => this.handleDragStart(e, sourceId);\n\n    const handleSelectStart = e => this.handleSelectStart(e);\n\n    node.setAttribute('draggable', 'true');\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.sourceNodeOptions.delete(sourceId);\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', 'false');\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const handleDragEnter = e => this.handleDragEnter(e, targetId);\n\n    const handleDragOver = e => this.handleDragOver(e, targetId);\n\n    const handleDrop = e => this.handleDrop(e, targetId);\n\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return () => {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  }\n\n  addEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  removeEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  getCurrentSourceNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n    return _objectSpread({\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    }, sourceNodeOptions || {});\n  }\n\n  getCurrentDropEffect() {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  }\n\n  getCurrentSourcePreviewNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n    return _objectSpread({\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    }, sourcePreviewNodeOptions || {});\n  }\n\n  isDraggingNativeItem() {\n    const itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(key => NativeTypes[key] === itemType);\n  }\n\n  beginDragNativeItem(type, dataTransfer) {\n    this.clearCurrentDragSourceNode();\n    this.currentNativeSource = createNativeDragSource(type, dataTransfer);\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  }\n\n  setCurrentDragSourceNode(node) {\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n\n    const MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n\n    this.mouseMoveTimeoutTimer = setTimeout(() => {\n      var ref;\n      return (ref = this.rootElement) === null || ref === void 0 ? void 0 : ref.addEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  }\n\n  clearCurrentDragSourceNode() {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n\n      if (this.rootElement) {\n        var ref;\n        (ref = this.window) === null || ref === void 0 ? void 0 : ref.clearTimeout(this.mouseMoveTimeoutTimer || undefined);\n        this.rootElement.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n\n    return false;\n  }\n\n  handleDragStart(e, sourceId) {\n    if (e.defaultPrevented) {\n      return;\n    }\n\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n\n    this.dragStartSourceIds.unshift(sourceId);\n  }\n\n  handleDragEnter(_e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  }\n\n  handleDragOver(_e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n\n    this.dragOverTargetIds.unshift(targetId);\n  }\n\n  handleDrop(_e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  }\n\n  constructor(manager, globalContext, options) {\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.lastClientOffset = null;\n    this.hoverRafId = null;\n\n    this.getSourceClientOffset = sourceId => {\n      const source = this.sourceNodes.get(sourceId);\n      return source && getNodeClientOffset$1(source) || null;\n    };\n\n    this.endDragNativeItem = () => {\n      if (!this.isDraggingNativeItem()) {\n        return;\n      }\n\n      this.actions.endDrag();\n\n      if (this.currentNativeHandle) {\n        this.registry.removeSource(this.currentNativeHandle);\n      }\n\n      this.currentNativeHandle = null;\n      this.currentNativeSource = null;\n    };\n\n    this.isNodeInDocument = node => {\n      // Check the node either in the main document or in the current context\n      return Boolean(node && this.document && this.document.body && this.document.body.contains(node));\n    };\n\n    this.endDragIfSourceWasRemovedFromDOM = () => {\n      const node = this.currentDragSourceNode;\n\n      if (node == null || this.isNodeInDocument(node)) {\n        return;\n      }\n\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.scheduleHover = dragOverTargetIds => {\n      if (this.hoverRafId === null && typeof requestAnimationFrame !== 'undefined') {\n        this.hoverRafId = requestAnimationFrame(() => {\n          if (this.monitor.isDragging()) {\n            this.actions.hover(dragOverTargetIds || [], {\n              clientOffset: this.lastClientOffset\n            });\n          }\n\n          this.hoverRafId = null;\n        });\n      }\n    };\n\n    this.cancelHover = () => {\n      if (this.hoverRafId !== null && typeof cancelAnimationFrame !== 'undefined') {\n        cancelAnimationFrame(this.hoverRafId);\n        this.hoverRafId = null;\n      }\n    };\n\n    this.handleTopDragStartCapture = () => {\n      this.clearCurrentDragSourceNode();\n      this.dragStartSourceIds = [];\n    };\n\n    this.handleTopDragStart = e => {\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      const {\n        dragStartSourceIds\n      } = this;\n      this.dragStartSourceIds = null;\n      const clientOffset = getEventClientOffset$1(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n        this.cancelHover();\n      } // Don't publish the source just yet (see why below)\n\n\n      this.actions.beginDrag(dragStartSourceIds || [], {\n        publishSource: false,\n        getSourceClientOffset: this.getSourceClientOffset,\n        clientOffset\n      });\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (this.monitor.isDragging()) {\n        if (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          const sourceId = this.monitor.getSourceId();\n          const sourceNode = this.sourceNodes.get(sourceId);\n          const dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n\n          if (dragPreview) {\n            const {\n              anchorX,\n              anchorY,\n              offsetX,\n              offsetY\n            } = this.getCurrentSourcePreviewNodeOptions();\n            const anchorPoint = {\n              anchorX,\n              anchorY\n            };\n            const offsetPoint = {\n              offsetX,\n              offsetY\n            };\n            const dragPreviewOffset = getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n            dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n          }\n        }\n\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer === null || dataTransfer === void 0 ? void 0 : dataTransfer.setData('application/json', {});\n        } catch (err) {// IE doesn't support MIME types in setData\n        } // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n\n        this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n        const {\n          captureDraggingState\n        } = this.getCurrentSourcePreviewNodeOptions();\n\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(() => this.actions.publishDragSource(), 0);\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        this.beginDragNativeItem(nativeType);\n      } else if (dataTransfer && !dataTransfer.types && (e.target && !e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return;\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    };\n\n    this.handleTopDragEndCapture = () => {\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDragEnterCapture = e => {\n      this.dragEnterTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n\n      const isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\n      if (!isFirstEnter || this.monitor.isDragging()) {\n        return;\n      }\n\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        this.beginDragNativeItem(nativeType, dataTransfer);\n      }\n    };\n\n    this.handleTopDragEnter = e => {\n      const {\n        dragEnterTargetIds\n      } = this;\n      this.dragEnterTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n\n      this.altKeyPressed = e.altKey; // If the target changes position as the result of `dragenter`, `dragover` might still\n      // get dispatched despite target being no longer there. The easy solution is to check\n      // whether there actually is a target before firing `hover`.\n\n      if (dragEnterTargetIds.length > 0) {\n        this.actions.hover(dragEnterTargetIds, {\n          clientOffset: getEventClientOffset$1(e)\n        });\n      }\n\n      const canDrop = dragEnterTargetIds.some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      }\n    };\n\n    this.handleTopDragOverCapture = e => {\n      this.dragOverTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n    };\n\n    this.handleTopDragOver = e => {\n      const {\n        dragOverTargetIds\n      } = this;\n      this.dragOverTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n\n        return;\n      }\n\n      this.altKeyPressed = e.altKey;\n      this.lastClientOffset = getEventClientOffset$1(e);\n      this.scheduleHover(dragOverTargetIds);\n      const canDrop = (dragOverTargetIds || []).some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      } else if (this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n      }\n    };\n\n    this.handleTopDragLeaveCapture = e => {\n      if (this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n\n      const isLastLeave = this.enterLeaveCounter.leave(e.target);\n\n      if (!isLastLeave) {\n        return;\n      }\n\n      if (this.isDraggingNativeItem()) {\n        setTimeout(() => this.endDragNativeItem(), 0);\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDropCapture = e => {\n      this.dropTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        e.preventDefault();\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      } else if (matchNativeItemType(e.dataTransfer)) {\n        // Dragging some elements, like <a> and <img> may still behave like a native drag event,\n        // even if the current drag event matches a user-defined type.\n        // Stop the default behavior when we're not expecting a native item to be dropped.\n        e.preventDefault();\n      }\n\n      this.enterLeaveCounter.reset();\n    };\n\n    this.handleTopDrop = e => {\n      const {\n        dropTargetIds\n      } = this;\n      this.dropTargetIds = [];\n      this.actions.hover(dropTargetIds, {\n        clientOffset: getEventClientOffset$1(e)\n      });\n      this.actions.drop({\n        dropEffect: this.getCurrentDropEffect()\n      });\n\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      } else if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleSelectStart = e => {\n      const target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n\n      e.preventDefault();\n      target.dragDrop();\n    };\n\n    this.options = new OptionsReader$1(globalContext, options);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.enterLeaveCounter = new EnterLeaveCounter(this.isNodeInDocument);\n  }\n\n}\n\nlet emptyImage;\nfunction getEmptyImage() {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    emptyImage.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  return emptyImage;\n}\n\nconst HTML5Backend = function createBackend(manager, context, options) {\n  return new HTML5BackendImpl(manager, context, options);\n};\n\nvar ListenerType;\n\n(function (ListenerType) {\n  ListenerType[\"mouse\"] = \"mouse\";\n  ListenerType[\"touch\"] = \"touch\";\n  ListenerType[\"keyboard\"] = \"keyboard\";\n})(ListenerType || (ListenerType = {}));\n\nclass OptionsReader {\n  get delay() {\n    var _delay;\n\n    return (_delay = this.args.delay) !== null && _delay !== void 0 ? _delay : 0;\n  }\n\n  get scrollAngleRanges() {\n    return this.args.scrollAngleRanges;\n  }\n\n  get getDropTargetElementsAtPoint() {\n    return this.args.getDropTargetElementsAtPoint;\n  }\n\n  get ignoreContextMenu() {\n    var _ignoreContextMenu;\n\n    return (_ignoreContextMenu = this.args.ignoreContextMenu) !== null && _ignoreContextMenu !== void 0 ? _ignoreContextMenu : false;\n  }\n\n  get enableHoverOutsideTarget() {\n    var _enableHoverOutsideTarget;\n\n    return (_enableHoverOutsideTarget = this.args.enableHoverOutsideTarget) !== null && _enableHoverOutsideTarget !== void 0 ? _enableHoverOutsideTarget : false;\n  }\n\n  get enableKeyboardEvents() {\n    var _enableKeyboardEvents;\n\n    return (_enableKeyboardEvents = this.args.enableKeyboardEvents) !== null && _enableKeyboardEvents !== void 0 ? _enableKeyboardEvents : false;\n  }\n\n  get enableMouseEvents() {\n    var _enableMouseEvents;\n\n    return (_enableMouseEvents = this.args.enableMouseEvents) !== null && _enableMouseEvents !== void 0 ? _enableMouseEvents : false;\n  }\n\n  get enableTouchEvents() {\n    var _enableTouchEvents;\n\n    return (_enableTouchEvents = this.args.enableTouchEvents) !== null && _enableTouchEvents !== void 0 ? _enableTouchEvents : true;\n  }\n\n  get touchSlop() {\n    return this.args.touchSlop || 0;\n  }\n\n  get delayTouchStart() {\n    var ref, ref1;\n    var ref2, ref3;\n    return (ref3 = (ref2 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayTouchStart) !== null && ref2 !== void 0 ? ref2 : (ref1 = this.args) === null || ref1 === void 0 ? void 0 : ref1.delay) !== null && ref3 !== void 0 ? ref3 : 0;\n  }\n\n  get delayMouseStart() {\n    var ref, ref4;\n    var ref5, ref6;\n    return (ref6 = (ref5 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayMouseStart) !== null && ref5 !== void 0 ? ref5 : (ref4 = this.args) === null || ref4 === void 0 ? void 0 : ref4.delay) !== null && ref6 !== void 0 ? ref6 : 0;\n  }\n\n  get window() {\n    if (this.context && this.context.window) {\n      return this.context.window;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.context) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.context.document;\n    }\n\n    if (this.window) {\n      return this.window.document;\n    }\n\n    return undefined;\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.args) === null || ref === void 0 ? void 0 : ref.rootElement) || this.document;\n  }\n\n  constructor(args, context) {\n    this.args = args;\n    this.context = context;\n  }\n\n}\n\nfunction distance(x1, y1, x2, y2) {\n  return Math.sqrt(Math.pow(Math.abs(x2 - x1), 2) + Math.pow(Math.abs(y2 - y1), 2));\n}\nfunction inAngleRanges(x1, y1, x2, y2, angleRanges) {\n  if (!angleRanges) {\n    return false;\n  }\n\n  const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI + 180;\n\n  for (let i = 0; i < angleRanges.length; ++i) {\n    const ar = angleRanges[i];\n\n    if (ar && (ar.start == null || angle >= ar.start) && (ar.end == null || angle <= ar.end)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Used for MouseEvent.buttons (note the s on the end).\nconst MouseButtons = {\n  Left: 1,\n  Right: 2,\n  Center: 4\n}; // Used for e.button (note the lack of an s on the end).\n\nconst MouseButton = {\n  Left: 0,\n  Center: 1,\n  Right: 2\n};\n/**\n * Only touch events and mouse events where the left button is pressed should initiate a drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldStartDrag(e) {\n  // For touch events, button will be undefined. If e.button is defined,\n  // then it should be MouseButton.Left.\n  return e.button === undefined || e.button === MouseButton.Left;\n}\n/**\n * Only touch events and mouse events where the left mouse button is no longer held should end a drag.\n * It's possible the user mouse downs with the left mouse button, then mouse down and ups with the right mouse button.\n * We don't want releasing the right mouse button to end the drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldEndDrag(e) {\n  // Touch events will have buttons be undefined, while mouse events will have e.buttons's left button\n  // bit field unset if the left mouse button has been released\n  return e.buttons === undefined || (e.buttons & MouseButtons.Left) === 0;\n}\nfunction isTouchEvent(e) {\n  return !!e.targetTouches;\n}\n\nconst ELEMENT_NODE = 1;\nfunction getNodeClientOffset(node) {\n  const el = node.nodeType === ELEMENT_NODE ? node : node.parentElement;\n\n  if (!el) {\n    return undefined;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientTouchOffset(e, lastTargetTouchFallback) {\n  if (e.targetTouches.length === 1) {\n    return getEventClientOffset(e.targetTouches[0]);\n  } else if (lastTargetTouchFallback && e.touches.length === 1) {\n    if (e.touches[0].target === lastTargetTouchFallback.target) {\n      return getEventClientOffset(e.touches[0]);\n    }\n  }\n\n  return;\n}\nfunction getEventClientOffset(e, lastTargetTouchFallback) {\n  if (isTouchEvent(e)) {\n    return getEventClientTouchOffset(e, lastTargetTouchFallback);\n  } else {\n    return {\n      x: e.clientX,\n      y: e.clientY\n    };\n  }\n}\n\nconst supportsPassive = (() => {\n  // simular to jQuery's test\n  let supported = false;\n\n  try {\n    addEventListener('test', () => {// do nothing\n    }, Object.defineProperty({}, 'passive', {\n      get() {\n        supported = true;\n        return true;\n      }\n\n    }));\n  } catch (e) {// do nothing\n  }\n\n  return supported;\n})();\n\nconst eventNames = {\n  [ListenerType.mouse]: {\n    start: 'mousedown',\n    move: 'mousemove',\n    end: 'mouseup',\n    contextmenu: 'contextmenu'\n  },\n  [ListenerType.touch]: {\n    start: 'touchstart',\n    move: 'touchmove',\n    end: 'touchend'\n  },\n  [ListenerType.keyboard]: {\n    keydown: 'keydown'\n  }\n};\nclass TouchBackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref;\n    return {\n      sourceNodes: this.sourceNodes.size,\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      targetNodes: this.targetNodes.size,\n      dragOverTargetIds: ((ref = this.dragOverTargetIds) === null || ref === void 0 ? void 0 : ref.length) || 0\n    };\n  } // public for test\n\n\n  get document() {\n    return this.options.document;\n  }\n\n  setup() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    invariant(!TouchBackendImpl.isSetUp, 'Cannot have two Touch backends at the same time.');\n    TouchBackendImpl.isSetUp = true;\n    this.addEventListener(root, 'start', this.getTopMoveStartHandler());\n    this.addEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.addEventListener(root, 'move', this.handleTopMove);\n    this.addEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.addEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.addEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.addEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n  }\n\n  teardown() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    TouchBackendImpl.isSetUp = false;\n    this._mouseClientOffset = {};\n    this.removeEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.removeEventListener(root, 'start', this.handleTopMoveStart);\n    this.removeEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.removeEventListener(root, 'move', this.handleTopMove);\n    this.removeEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.removeEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.removeEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n\n    this.uninstallSourceNodeRemovalObserver();\n  }\n\n  addEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.addEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  removeEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.removeEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  connectDragSource(sourceId, node) {\n    const handleMoveStart = this.handleMoveStart.bind(this, sourceId);\n    this.sourceNodes.set(sourceId, node);\n    this.addEventListener(node, 'start', handleMoveStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.removeEventListener(node, 'start', handleMoveStart);\n    };\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const root = this.options.rootElement;\n\n    if (!this.document || !root) {\n      return () => {\n        /* noop */\n      };\n    }\n\n    const handleMove = e => {\n      if (!this.document || !root || !this.monitor.isDragging()) {\n        return;\n      }\n\n      let coords;\n      /**\n      * Grab the coordinates for the current mouse/touch position\n      */\n\n      switch (e.type) {\n        case eventNames.mouse.move:\n          coords = {\n            x: e.clientX,\n            y: e.clientY\n          };\n          break;\n\n        case eventNames.touch.move:\n          var ref, ref1;\n          coords = {\n            x: ((ref = e.touches[0]) === null || ref === void 0 ? void 0 : ref.clientX) || 0,\n            y: ((ref1 = e.touches[0]) === null || ref1 === void 0 ? void 0 : ref1.clientY) || 0\n          };\n          break;\n      }\n      /**\n      * Use the coordinates to grab the element the drag ended on.\n      * If the element is the same as the target node (or any of it's children) then we have hit a drop target and can handle the move.\n      */\n\n\n      const droppedOn = coords != null ? this.document.elementFromPoint(coords.x, coords.y) : undefined;\n      const childMatch = droppedOn && node.contains(droppedOn);\n\n      if (droppedOn === node || childMatch) {\n        return this.handleMove(e, targetId);\n      }\n    };\n    /**\n    * Attaching the event listener to the body so that touchmove will work while dragging over multiple target elements.\n    */\n\n\n    this.addEventListener(this.document.body, 'move', handleMove);\n    this.targetNodes.set(targetId, node);\n    return () => {\n      if (this.document) {\n        this.targetNodes.delete(targetId);\n        this.removeEventListener(this.document.body, 'move', handleMove);\n      }\n    };\n  }\n\n  getTopMoveStartHandler() {\n    if (!this.options.delayTouchStart && !this.options.delayMouseStart) {\n      return this.handleTopMoveStart;\n    }\n\n    return this.handleTopMoveStartDelay;\n  }\n\n  installSourceNodeRemovalObserver(node) {\n    this.uninstallSourceNodeRemovalObserver();\n    this.draggedSourceNode = node;\n    this.draggedSourceNodeRemovalObserver = new MutationObserver(() => {\n      if (node && !node.parentElement) {\n        this.resurrectSourceNode();\n        this.uninstallSourceNodeRemovalObserver();\n      }\n    });\n\n    if (!node || !node.parentElement) {\n      return;\n    }\n\n    this.draggedSourceNodeRemovalObserver.observe(node.parentElement, {\n      childList: true\n    });\n  }\n\n  resurrectSourceNode() {\n    if (this.document && this.draggedSourceNode) {\n      this.draggedSourceNode.style.display = 'none';\n      this.draggedSourceNode.removeAttribute('data-reactid');\n      this.document.body.appendChild(this.draggedSourceNode);\n    }\n  }\n\n  uninstallSourceNodeRemovalObserver() {\n    if (this.draggedSourceNodeRemovalObserver) {\n      this.draggedSourceNodeRemovalObserver.disconnect();\n    }\n\n    this.draggedSourceNodeRemovalObserver = undefined;\n    this.draggedSourceNode = undefined;\n  }\n\n  constructor(manager, context, options) {\n    this.getSourceClientOffset = sourceId => {\n      const element = this.sourceNodes.get(sourceId);\n      return element && getNodeClientOffset(element);\n    };\n\n    this.handleTopMoveStartCapture = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      this.moveStartSourceIds = [];\n    };\n\n    this.handleMoveStart = sourceId => {\n      // Just because we received an event doesn't necessarily mean we need to collect drag sources.\n      // We only collect start collecting drag sources on touch and left mouse events.\n      if (Array.isArray(this.moveStartSourceIds)) {\n        this.moveStartSourceIds.unshift(sourceId);\n      }\n    };\n\n    this.handleTopMoveStart = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      } // Don't prematurely preventDefault() here since it might:\n      // 1. Mess up scrolling\n      // 2. Mess up long tap (which brings up context menu)\n      // 3. If there's an anchor link as a child, tap won't be triggered on link\n\n\n      const clientOffset = getEventClientOffset(e);\n\n      if (clientOffset) {\n        if (isTouchEvent(e)) {\n          this.lastTargetTouchFallback = e.targetTouches[0];\n        }\n\n        this._mouseClientOffset = clientOffset;\n      }\n\n      this.waitingForDelay = false;\n    };\n\n    this.handleTopMoveStartDelay = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      const delay = e.type === eventNames.touch.start ? this.options.delayTouchStart : this.options.delayMouseStart;\n      this.timeout = setTimeout(this.handleTopMoveStart.bind(this, e), delay);\n      this.waitingForDelay = true;\n    };\n\n    this.handleTopMoveCapture = () => {\n      this.dragOverTargetIds = [];\n    };\n\n    this.handleMove = (_evt, targetId) => {\n      if (this.dragOverTargetIds) {\n        this.dragOverTargetIds.unshift(targetId);\n      }\n    };\n\n    this.handleTopMove = e1 => {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n\n      if (!this.document || this.waitingForDelay) {\n        return;\n      }\n\n      const {\n        moveStartSourceIds,\n        dragOverTargetIds\n      } = this;\n      const enableHoverOutsideTarget = this.options.enableHoverOutsideTarget;\n      const clientOffset = getEventClientOffset(e1, this.lastTargetTouchFallback);\n\n      if (!clientOffset) {\n        return;\n      } // If the touch move started as a scroll, or is is between the scroll angles\n\n\n      if (this._isScrolling || !this.monitor.isDragging() && inAngleRanges(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y, this.options.scrollAngleRanges)) {\n        this._isScrolling = true;\n        return;\n      } // If we're not dragging and we've moved a little, that counts as a drag start\n\n\n      if (!this.monitor.isDragging() && // eslint-disable-next-line no-prototype-builtins\n      this._mouseClientOffset.hasOwnProperty('x') && moveStartSourceIds && distance(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y) > (this.options.touchSlop ? this.options.touchSlop : 0)) {\n        this.moveStartSourceIds = undefined;\n        this.actions.beginDrag(moveStartSourceIds, {\n          clientOffset: this._mouseClientOffset,\n          getSourceClientOffset: this.getSourceClientOffset,\n          publishSource: false\n        });\n      }\n\n      if (!this.monitor.isDragging()) {\n        return;\n      }\n\n      const sourceNode = this.sourceNodes.get(this.monitor.getSourceId());\n      this.installSourceNodeRemovalObserver(sourceNode);\n      this.actions.publishDragSource();\n      if (e1.cancelable) e1.preventDefault(); // Get the node elements of the hovered DropTargets\n\n      const dragOverTargetNodes = (dragOverTargetIds || []).map(key => this.targetNodes.get(key)).filter(e => !!e); // Get the a ordered list of nodes that are touched by\n\n      const elementsAtPoint = this.options.getDropTargetElementsAtPoint ? this.options.getDropTargetElementsAtPoint(clientOffset.x, clientOffset.y, dragOverTargetNodes) : this.document.elementsFromPoint(clientOffset.x, clientOffset.y); // Extend list with parents that are not receiving elementsFromPoint events (size 0 elements and svg groups)\n\n      const elementsAtPointExtended = [];\n\n      for (const nodeId in elementsAtPoint) {\n        // eslint-disable-next-line no-prototype-builtins\n        if (!elementsAtPoint.hasOwnProperty(nodeId)) {\n          continue;\n        }\n\n        let currentNode = elementsAtPoint[nodeId];\n\n        if (currentNode != null) {\n          elementsAtPointExtended.push(currentNode);\n        }\n\n        while (currentNode) {\n          currentNode = currentNode.parentElement;\n\n          if (currentNode && elementsAtPointExtended.indexOf(currentNode) === -1) {\n            elementsAtPointExtended.push(currentNode);\n          }\n        }\n      }\n\n      const orderedDragOverTargetIds = elementsAtPointExtended // Filter off nodes that arent a hovered DropTargets nodes\n      .filter(node => dragOverTargetNodes.indexOf(node) > -1) // Map back the nodes elements to targetIds\n      .map(node => this._getDropTargetId(node)) // Filter off possible null rows\n      .filter(node => !!node).filter((id, index, ids) => ids.indexOf(id) === index); // Invoke hover for drop targets when source node is still over and pointer is outside\n\n      if (enableHoverOutsideTarget) {\n        for (const targetId in this.targetNodes) {\n          const targetNode = this.targetNodes.get(targetId);\n\n          if (sourceNode && targetNode && targetNode.contains(sourceNode) && orderedDragOverTargetIds.indexOf(targetId) === -1) {\n            orderedDragOverTargetIds.unshift(targetId);\n            break;\n          }\n        }\n      } // Reverse order because dnd-core reverse it before calling the DropTarget drop methods\n\n\n      orderedDragOverTargetIds.reverse();\n      this.actions.hover(orderedDragOverTargetIds, {\n        clientOffset: clientOffset\n      });\n    };\n    /**\n    *\n    * visible for testing\n    */\n\n\n    this._getDropTargetId = node => {\n      const keys = this.targetNodes.keys();\n      let next = keys.next();\n\n      while (next.done === false) {\n        const targetId = next.value;\n\n        if (node === this.targetNodes.get(targetId)) {\n          return targetId;\n        } else {\n          next = keys.next();\n        }\n      }\n\n      return undefined;\n    };\n\n    this.handleTopMoveEndCapture = e => {\n      this._isScrolling = false;\n      this.lastTargetTouchFallback = undefined;\n\n      if (!eventShouldEndDrag(e)) {\n        return;\n      }\n\n      if (!this.monitor.isDragging() || this.monitor.didDrop()) {\n        this.moveStartSourceIds = undefined;\n        return;\n      }\n\n      if (e.cancelable) e.preventDefault();\n      this._mouseClientOffset = {};\n      this.uninstallSourceNodeRemovalObserver();\n      this.actions.drop();\n      this.actions.endDrag();\n    };\n\n    this.handleCancelOnEscape = e => {\n      if (e.key === 'Escape' && this.monitor.isDragging()) {\n        this._mouseClientOffset = {};\n        this.uninstallSourceNodeRemovalObserver();\n        this.actions.endDrag();\n      }\n    };\n\n    this.options = new OptionsReader(options, context);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.sourceNodes = new Map();\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.targetNodes = new Map();\n    this.listenerTypes = [];\n    this._mouseClientOffset = {};\n    this._isScrolling = false;\n\n    if (this.options.enableMouseEvents) {\n      this.listenerTypes.push(ListenerType.mouse);\n    }\n\n    if (this.options.enableTouchEvents) {\n      this.listenerTypes.push(ListenerType.touch);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.listenerTypes.push(ListenerType.keyboard);\n    }\n  }\n\n}\n\nconst TouchBackend = function createBackend(manager, context = {}, options = {}) {\n  return new TouchBackendImpl(manager, context, options);\n};\n\nconst COLUMNS = 'abcdefgh'.split('');\nconst chessboardDefaultProps = {\n  animationDuration: 300,\n  areArrowsAllowed: true,\n  arePiecesDraggable: true,\n  arePremovesAllowed: false,\n  boardOrientation: 'white',\n  boardWidth: 560,\n  clearPremovesOnRightClick: true,\n  customArrows: [],\n  customArrowColor: 'rgb(255,170,0)',\n  customBoardStyle: {},\n  customDarkSquareStyle: {\n    backgroundColor: '#B58863'\n  },\n  customDndBackend: undefined,\n  customDndBackendOptions: undefined,\n  customDropSquareStyle: {\n    boxShadow: 'inset 0 0 1px 6px rgba(255,255,255,0.75)'\n  },\n  customLightSquareStyle: {\n    backgroundColor: '#F0D9B5'\n  },\n  customPieces: {},\n  customPremoveDarkSquareStyle: {\n    backgroundColor: '#A42323'\n  },\n  customPremoveLightSquareStyle: {\n    backgroundColor: '#BD2828'\n  },\n  customSquareStyles: {},\n  dropOffBoardAction: 'snapback',\n  id: 0,\n  isDraggablePiece: () => true,\n  getPositionObject: () => {},\n  onArrowsChange: () => {},\n  onDragOverSquare: () => {},\n  onMouseOutSquare: () => {},\n  onMouseOverSquare: () => {},\n  onPieceClick: () => {},\n  onPieceDragBegin: () => {},\n  onPieceDragEnd: () => {},\n  onPieceDrop: () => true,\n  onSquareClick: () => {},\n  onSquareRightClick: () => {},\n  position: 'start',\n  showBoardNotation: true,\n  // showSparePieces: false,\n  snapToCursor: true\n};\n\nconst startPositionObject = {\n  a8: 'bR',\n  b8: 'bN',\n  c8: 'bB',\n  d8: 'bQ',\n  e8: 'bK',\n  f8: 'bB',\n  g8: 'bN',\n  h8: 'bR',\n  a7: 'bP',\n  b7: 'bP',\n  c7: 'bP',\n  d7: 'bP',\n  e7: 'bP',\n  f7: 'bP',\n  g7: 'bP',\n  h7: 'bP',\n  a2: 'wP',\n  b2: 'wP',\n  c2: 'wP',\n  d2: 'wP',\n  e2: 'wP',\n  f2: 'wP',\n  g2: 'wP',\n  h2: 'wP',\n  a1: 'wR',\n  b1: 'wN',\n  c1: 'wB',\n  d1: 'wQ',\n  e1: 'wK',\n  f1: 'wB',\n  g1: 'wN',\n  h1: 'wR'\n};\nconst whiteColumnValues = {\n  a: 0,\n  b: 1,\n  c: 2,\n  d: 3,\n  e: 4,\n  f: 5,\n  g: 6,\n  h: 7\n};\nconst blackColumnValues = {\n  a: 7,\n  b: 6,\n  c: 5,\n  d: 4,\n  e: 3,\n  f: 2,\n  g: 1,\n  h: 0\n};\nconst whiteRows = [7, 6, 5, 4, 3, 2, 1, 0];\nconst blackRows = [0, 1, 2, 3, 4, 5, 6, 7];\nconst getRelativeCoords = (boardOrientation, boardWidth, square) => {\n  const squareWidth = boardWidth / 8;\n  const columns = boardOrientation === 'white' ? whiteColumnValues : blackColumnValues;\n  const rows = boardOrientation === 'white' ? whiteRows : blackRows;\n  const x = columns[square[0]] * squareWidth + squareWidth / 2;\n  const y = rows[square[1] - 1] * squareWidth + squareWidth / 2;\n  return {\n    x,\n    y\n  };\n};\nconst isDifferentFromStart = newPosition => {\n  let isDifferent = false;\n  Object.keys(startPositionObject).forEach(square => {\n    if (newPosition[square] !== startPositionObject[square]) isDifferent = true;\n  });\n  Object.keys(newPosition).forEach(square => {\n    if (startPositionObject[square] !== newPosition[square]) isDifferent = true;\n  });\n  return isDifferent;\n};\nconst getPositionDifferences = (currentPosition, newPosition) => {\n  const difference = {\n    removed: {},\n    added: {}\n  }; // removed from current\n\n  Object.keys(currentPosition).forEach(square => {\n    if (newPosition[square] !== currentPosition[square]) difference.removed[square] = currentPosition[square];\n  }); // added from new\n\n  Object.keys(newPosition).forEach(square => {\n    if (currentPosition[square] !== newPosition[square]) difference.added[square] = newPosition[square];\n  });\n  return difference;\n};\n\nfunction isString(s) {\n  return typeof s === 'string';\n}\n\nfunction convertPositionToObject(position) {\n  if (position === 'start') return fenToObj('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR');\n  if (validFen(position)) return fenToObj(position);\n  if (validPositionObject(position)) return position;\n  return {};\n}\nfunction fenToObj(fen) {\n  if (!validFen(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, '');\n  const rows = fen.split('/');\n  const position = {};\n  let currentRow = 8;\n\n  for (let i = 0; i < 8; i++) {\n    const row = rows[i].split('');\n    let colIdx = 0; // loop through each character in the FEN section\n\n    for (let j = 0; j < row.length; j++) {\n      // number / empty squares\n      if (row[j].search(/[1-8]/) !== -1) {\n        const numEmptySquares = parseInt(row[j], 10);\n        colIdx = colIdx + numEmptySquares;\n      } else {\n        // piece\n        const square = COLUMNS[colIdx] + currentRow;\n        position[square] = fenToPieceCode(row[j]);\n        colIdx = colIdx + 1;\n      }\n    }\n\n    currentRow = currentRow - 1;\n  }\n\n  return position;\n}\n\nfunction expandFenEmptySquares(fen) {\n  return fen.replace(/8/g, '11111111').replace(/7/g, '1111111').replace(/6/g, '111111').replace(/5/g, '11111').replace(/4/g, '1111').replace(/3/g, '111').replace(/2/g, '11');\n}\n\nfunction validFen(fen) {\n  if (!isString(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, ''); // expand the empty square numbers to just 1s\n\n  fen = expandFenEmptySquares(fen); // FEN should be 8 sections separated by slashes\n\n  const chunks = fen.split('/');\n  if (chunks.length !== 8) return false; // check each section\n\n  for (let i = 0; i < 8; i++) {\n    if (chunks[i].length !== 8 || chunks[i].search(/[^kqrnbpKQRNBP1]/) !== -1) {\n      return false;\n    }\n  }\n\n  return true;\n} // convert FEN piece code to bP, wK, etc\n\nfunction fenToPieceCode(piece) {\n  // black piece\n  if (piece.toLowerCase() === piece) {\n    return 'b' + piece.toUpperCase();\n  } // white piece\n\n\n  return 'w' + piece.toUpperCase();\n}\n\nfunction validSquare(square) {\n  return isString(square) && square.search(/^[a-h][1-8]$/) !== -1;\n}\n\nfunction validPieceCode(code) {\n  return isString(code) && code.search(/^[bw][KQRNBP]$/) !== -1;\n}\n\nfunction validPositionObject(pos) {\n  if (pos === null || typeof pos !== 'object') return false;\n\n  for (const i in pos) {\n    if (!pos[i]) continue;\n\n    if (!validSquare(i) || !validPieceCode(pos[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nconst defaultPieces = {\n  wP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  wR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 34,14 L 31,17 L 14,17 L 11,14\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,17 L 31,29.5 L 14,29.5 L 14,17\",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  wB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#ffffff',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,33.5 C 18,32.5 27,32.5 33,33.5\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      })]\n    })\n  }),\n  wK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  bP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  bR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,35.5 L 33,35.5 L 33,35.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 13,31.5 L 32,31.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 31,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 31,16.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \",\n        style: {\n          fill: '#ffffff',\n          stroke: 'none'\n        }\n      })]\n    })\n  }),\n  bB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#000000',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#000000',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\",\n        style: {\n          strokeLinecap: 'butt',\n          fill: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 12,33.5 c 6,-1 15,-1 21,0\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,38.5 A 35,35 1 0 0 34,38.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 11,29 A 35,35 1 0 1 34,29\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 12.5,31.5 L 32.5,31.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"\n        })]\n      })]\n    })\n  }),\n  bK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        },\n        id: \"path6570\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#000000',\n          fillOpacity: '1',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      })]\n    })\n  })\n};\n\nconst ChessboardContext = /*#__PURE__*/React.createContext();\nconst useChessboard = () => useContext(ChessboardContext);\nconst ChessboardProvider = /*#__PURE__*/forwardRef(({\n  animationDuration,\n  areArrowsAllowed,\n  arePiecesDraggable,\n  arePremovesAllowed,\n  boardOrientation,\n  boardWidth,\n  clearPremovesOnRightClick,\n  customArrows,\n  customArrowColor,\n  customBoardStyle,\n  customDarkSquareStyle,\n  customDropSquareStyle,\n  customLightSquareStyle,\n  customPieces,\n  customPremoveDarkSquareStyle,\n  customPremoveLightSquareStyle,\n  customSquareStyles,\n  dropOffBoardAction,\n  id,\n  isDraggablePiece,\n  getPositionObject,\n  onArrowsChange,\n  onDragOverSquare,\n  onMouseOutSquare,\n  onMouseOverSquare,\n  onPieceClick,\n  onPieceDragBegin,\n  onPieceDragEnd,\n  onPieceDrop,\n  onSquareClick,\n  onSquareRightClick,\n  position,\n  showBoardNotation,\n  showSparePieces,\n  snapToCursor,\n  children\n}, ref) => {\n  // position stored and displayed on board\n  const [currentPosition, setCurrentPosition] = useState(convertPositionToObject(position)); // calculated differences between current and incoming positions\n\n  const [positionDifferences, setPositionDifferences] = useState({}); // colour of last piece moved to determine if premoving\n\n  const [lastPieceColour, setLastPieceColour] = useState(undefined); // current premoves\n\n  const [premoves, setPremoves] = useState([]); // ref used to access current value during timeouts (closures)\n\n  const premovesRef = useRef(premoves); // current right mouse down square\n\n  const [currentRightClickDown, setCurrentRightClickDown] = useState(); // current arrows\n\n  const [arrows, setArrows] = useState([]); // chess pieces/styling\n\n  const [chessPieces, setChessPieces] = useState({ ...defaultPieces,\n    ...customPieces\n  }); // whether the last move was a manual drop or not\n\n  const [manualDrop, setManualDrop] = useState(false); // the most recent timeout whilst waiting for animation to complete\n\n  const [previousTimeout, setPreviousTimeout] = useState(undefined); // if currently waiting for an animation to finish\n\n  const [waitingForAnimation, setWaitingForAnimation] = useState(false); // open clearPremoves() to allow user to call on undo/reset/whenever\n\n  useImperativeHandle(ref, () => ({\n    clearPremoves(clearLastPieceColour = true) {\n      clearPremoves(clearLastPieceColour);\n    }\n\n  })); // handle custom pieces change\n\n  useEffect(() => {\n    setChessPieces({ ...defaultPieces,\n      ...customPieces\n    });\n  }, [customPieces]); // handle external position change\n\n  useEffect(() => {\n    var _Object$keys, _Object$entries, _Object$entries$;\n\n    const newPosition = convertPositionToObject(position);\n    const differences = getPositionDifferences(currentPosition, newPosition);\n    const newPieceColour = ((_Object$keys = Object.keys(differences.added)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.length) <= 2 ? (_Object$entries = Object.entries(differences.added)) === null || _Object$entries === void 0 ? void 0 : (_Object$entries$ = _Object$entries[0]) === null || _Object$entries$ === void 0 ? void 0 : _Object$entries$[1][0] : undefined; // external move has come in before animation is over\n    // cancel animation and immediately update position\n\n    if (waitingForAnimation) {\n      setCurrentPosition(newPosition);\n      setWaitingForAnimation(false);\n      arePremovesAllowed && attemptPremove(newPieceColour);\n\n      if (previousTimeout) {\n        clearTimeout(previousTimeout);\n      }\n    } else {\n      // move was made using drag and drop\n      if (manualDrop) {\n        setCurrentPosition(newPosition);\n        setWaitingForAnimation(false);\n        arePremovesAllowed && attemptPremove(newPieceColour);\n      } else {\n        // move was made by external position change\n        // if position === start then don't override newPieceColour\n        // needs isDifferentFromStart in scenario where premoves have been cleared upon board reset but first move is made by computer, the last move colour would need to be updated\n        if (isDifferentFromStart(newPosition) && lastPieceColour !== undefined) {\n          setLastPieceColour(newPieceColour);\n        } else {\n          // position === start, likely a board reset\n          setLastPieceColour(undefined);\n        }\n\n        setPositionDifferences(differences); // animate external move\n\n        setWaitingForAnimation(true);\n        const newTimeout = setTimeout(() => {\n          setCurrentPosition(newPosition);\n          setWaitingForAnimation(false);\n          arePremovesAllowed && attemptPremove(newPieceColour);\n        }, animationDuration);\n        setPreviousTimeout(newTimeout);\n      }\n    } // reset manual drop, ready for next move to be made by user or external\n\n\n    setManualDrop(false); // inform latest position information\n\n    getPositionObject(newPosition); // clear arrows\n\n    clearArrows(); // clear timeout on unmount\n\n    return () => {\n      clearTimeout(previousTimeout);\n    };\n  }, [position]); // handle external arrows change\n\n  useEffect(() => {\n    setArrows(customArrows);\n  }, [customArrows]); // callback when new arrows are set\n\n  useEffect(() => {\n    onArrowsChange(arrows);\n  }, [arrows]); // handle drop position change\n\n  function handleSetPosition(sourceSq, targetSq, piece) {\n    // if dropped back down, don't do anything\n    if (sourceSq === targetSq) {\n      return;\n    }\n\n    clearArrows(); // if second move is made for same colour, or there are still premoves queued, then this move needs to be added to premove queue instead of played\n    // premoves length check for colour is added in because white could make 3 premoves, and then black responds to the first move (changing the last piece colour) and then white pre-moves again\n\n    if (arePremovesAllowed && waitingForAnimation || arePremovesAllowed && (lastPieceColour === piece[0] || premovesRef.current.filter(p => p.piece[0] === piece[0]).length > 0)) {\n      const oldPremoves = [...premovesRef.current];\n      oldPremoves.push({\n        sourceSq,\n        targetSq,\n        piece\n      });\n      premovesRef.current = oldPremoves;\n      setPremoves([...oldPremoves]);\n      return;\n    } // if transitioning, don't allow new drop\n\n\n    if (!arePremovesAllowed && waitingForAnimation) return;\n    const newOnDropPosition = { ...currentPosition\n    };\n    setManualDrop(true);\n    setLastPieceColour(piece[0]); // if onPieceDrop function provided, execute it, position must be updated externally and captured by useEffect above for this move to show on board\n\n    if (onPieceDrop.length) {\n      const isValidMove = onPieceDrop(sourceSq, targetSq, piece);\n      if (!isValidMove) clearPremoves();\n    } else {\n      // delete if dropping off board\n      if (dropOffBoardAction === 'trash' && !targetSq) {\n        delete newOnDropPosition[sourceSq];\n      } // delete source piece if not dropping from spare piece\n\n\n      if (sourceSq !== 'spare') {\n        delete newOnDropPosition[sourceSq];\n      } // add piece in new position\n\n\n      newOnDropPosition[targetSq] = piece;\n      setCurrentPosition(newOnDropPosition);\n    } // inform latest position information\n\n\n    getPositionObject(newOnDropPosition);\n  }\n\n  function attemptPremove(newPieceColour) {\n    if (premovesRef.current.length === 0) return; // get current value of premove as this is called in a timeout so value may have changed since timeout was set\n\n    const premove = premovesRef.current[0]; // if premove is a differing colour to last move made, then this move can be made\n\n    if (premove.piece[0] !== undefined && premove.piece[0] !== newPieceColour && onPieceDrop.length) {\n      setLastPieceColour(premove.piece[0]);\n      setManualDrop(true); // pre-move doesn't need animation\n\n      const isValidMove = onPieceDrop(premove.sourceSq, premove.targetSq, premove.piece); // premove was successful and can be removed from queue\n\n      if (isValidMove) {\n        const oldPremoves = [...premovesRef.current];\n        oldPremoves.shift();\n        premovesRef.current = oldPremoves;\n        setPremoves([...oldPremoves]);\n      } else {\n        // premove wasn't successful, clear premove queue\n        clearPremoves();\n      }\n    }\n  }\n\n  function clearPremoves(clearLastPieceColour = true) {\n    // don't clear when right clicking to clear, otherwise you won't be able to premove again before next go\n    if (clearLastPieceColour) setLastPieceColour(undefined);\n    premovesRef.current = [];\n    setPremoves([]);\n  }\n\n  function onRightClickDown(square) {\n    setCurrentRightClickDown(square);\n  }\n\n  function onRightClickUp(square) {\n    if (!areArrowsAllowed) return;\n\n    if (currentRightClickDown) {\n      // same square, don't draw an arrow, but do clear premoves and run onSquareRightClick\n      if (currentRightClickDown === square) {\n        setCurrentRightClickDown(null);\n        clearPremovesOnRightClick && clearPremoves(false);\n        onSquareRightClick(square);\n        return;\n      } // if arrow already exists then it needs to be removed\n\n\n      for (const i in arrows) {\n        if (arrows[i][0] === currentRightClickDown && arrows[i][1] === square) {\n          setArrows(oldArrows => {\n            const newArrows = [...oldArrows];\n            newArrows.splice(i, 1);\n            return newArrows;\n          });\n          return;\n        }\n      } // different square, draw an arrow\n\n\n      setArrows(oldArrows => [...oldArrows, [currentRightClickDown, square]]);\n    } else setCurrentRightClickDown(null);\n  }\n\n  function clearCurrentRightClickDown() {\n    setCurrentRightClickDown(null);\n  }\n\n  function clearArrows() {\n    setArrows([]);\n  }\n\n  return /*#__PURE__*/jsx(ChessboardContext.Provider, {\n    value: {\n      animationDuration,\n      arePiecesDraggable,\n      arePremovesAllowed,\n      boardOrientation,\n      boardWidth,\n      customArrowColor,\n      customBoardStyle,\n      customDarkSquareStyle,\n      customDropSquareStyle,\n      customLightSquareStyle,\n      customPremoveDarkSquareStyle,\n      customPremoveLightSquareStyle,\n      customSquareStyles,\n      dropOffBoardAction,\n      id,\n      isDraggablePiece,\n      getPositionObject,\n      onDragOverSquare,\n      onMouseOutSquare,\n      onMouseOverSquare,\n      onPieceClick,\n      onPieceDragBegin,\n      onPieceDragEnd,\n      onPieceDrop,\n      onSquareClick,\n      onSquareRightClick,\n      showBoardNotation,\n      showSparePieces,\n      snapToCursor,\n      arrows,\n      chessPieces,\n      clearArrows,\n      clearCurrentRightClickDown,\n      clearPremoves,\n      currentPosition,\n      handleSetPosition,\n      lastPieceColour,\n      manualDrop,\n      onRightClickDown,\n      onRightClickUp,\n      positionDifferences,\n      premoves,\n      setChessPieces,\n      setCurrentPosition,\n      setManualDrop,\n      waitingForAnimation\n    },\n    children: children\n  });\n});\n\nfunction Notation({\n  row,\n  col\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customDarkSquareStyle,\n    customLightSquareStyle\n  } = useChessboard();\n  const whiteColor = customLightSquareStyle.backgroundColor;\n  const blackColor = customDarkSquareStyle.backgroundColor;\n  const isRow = col === 0;\n  const isColumn = row === 7;\n  const isBottomLeftSquare = isRow && isColumn;\n\n  function getRow() {\n    return boardOrientation === 'white' ? 8 - row : row + 1;\n  }\n\n  function getColumn() {\n    return boardOrientation === 'black' ? COLUMNS[7 - col] : COLUMNS[col];\n  }\n\n  function renderBottomLeft() {\n    return /*#__PURE__*/jsxs(Fragment, {\n      children: [/*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...numericStyle(boardWidth)\n        },\n        children: getRow()\n      }), /*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...alphaStyle(boardWidth)\n        },\n        children: getColumn()\n      })]\n    });\n  }\n\n  function renderLetters() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...{\n          color: col % 2 !== 0 ? blackColor : whiteColor\n        },\n        ...alphaStyle(boardWidth)\n      },\n      children: getColumn()\n    });\n  }\n\n  function renderNumbers() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...(boardOrientation === 'black' ? {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        } : {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        }),\n        ...numericStyle(boardWidth)\n      },\n      children: getRow()\n    });\n  }\n\n  if (isBottomLeftSquare) {\n    return renderBottomLeft();\n  }\n\n  if (isColumn) {\n    return renderLetters();\n  }\n\n  if (isRow) {\n    return renderNumbers();\n  }\n\n  return null;\n}\n\nconst alphaStyle = width => ({\n  alignSelf: 'flex-end',\n  paddingLeft: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst numericStyle = width => ({\n  alignSelf: 'flex-start',\n  paddingRight: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst notationStyle = {\n  zIndex: 3,\n  position: 'absolute'\n};\n\nfunction Piece({\n  piece,\n  square,\n  squares,\n  isPremovedPiece = false\n}) {\n  const {\n    animationDuration,\n    arePiecesDraggable,\n    arePremovesAllowed,\n    boardWidth,\n    id,\n    isDraggablePiece,\n    onPieceClick,\n    onPieceDragBegin,\n    onPieceDragEnd,\n    premoves,\n    chessPieces,\n    dropTarget,\n    positionDifferences,\n    waitingForAnimation,\n    currentPosition\n  } = useChessboard();\n  const [pieceStyle, setPieceStyle] = useState({\n    opacity: 1,\n    zIndex: 5,\n    touchAction: 'none',\n    cursor: arePiecesDraggable && isDraggablePiece({\n      piece,\n      sourceSquare: square\n    }) ? '-webkit-grab' : 'default'\n  });\n  const [{\n    canDrag,\n    isDragging\n  }, drag, dragPreview] = useDrag(() => ({\n    type: 'piece',\n    item: () => {\n      onPieceDragBegin(piece, square);\n      return {\n        piece,\n        square,\n        id\n      };\n    },\n    end: () => onPieceDragEnd(piece, square),\n    collect: monitor => ({\n      canDrag: isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }),\n      isDragging: !!monitor.isDragging()\n    })\n  }), [piece, square, currentPosition, id]); // hide the default preview\n\n  dragPreview(getEmptyImage(), {\n    captureDraggingState: true\n  }); // hide piece on drag\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      opacity: isDragging ? 0 : 1\n    }));\n  }, [isDragging]); // hide piece on matching premoves\n\n  useEffect(() => {\n    // if premoves aren't allowed, don't waste time on calculations\n    if (!arePremovesAllowed) return;\n    let hidePiece = false; // side effect: if piece moves into pre-moved square, its hidden\n    // if there are any premove targets on this square, hide the piece underneath\n\n    if (!isPremovedPiece && premoves.find(p => p.targetSq === square)) hidePiece = true; // if sourceSq === sq and piece matches then this piece has been pre-moved elsewhere?\n\n    if (premoves.find(p => p.sourceSq === square && p.piece === piece)) hidePiece = true; // TODO: If a premoved piece returns to a premoved square, it will hide (e1, e2, e1)\n\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      display: hidePiece ? 'none' : 'unset'\n    }));\n  }, [currentPosition, premoves]); // new move has come in\n  // if waiting for animation, then animation has started and we can perform animation\n  // we need to head towards where we need to go, we are the source, we are heading towards the target\n\n  useEffect(() => {\n    var _positionDifferences$;\n\n    const removedPiece = (_positionDifferences$ = positionDifferences.removed) === null || _positionDifferences$ === void 0 ? void 0 : _positionDifferences$[square]; // return as null and not loaded yet\n\n    if (!positionDifferences.added) return; // check if piece matches or if removed piece was a pawn and new square is on 1st or 8th rank (promotion)\n\n    const newSquare = Object.entries(positionDifferences.added).find(([s, p]) => p === removedPiece || (removedPiece === null || removedPiece === void 0 ? void 0 : removedPiece[1]) === 'P' && (s[1] === '1' || s[1] === '8')); // we can perform animation if our square was in removed, AND the matching piece is in added AND this isn't a premoved piece\n\n    if (waitingForAnimation && removedPiece && newSquare && !isPremovedPiece) {\n      const {\n        sourceSq,\n        targetSq\n      } = getSquareCoordinates(square, newSquare[0]);\n\n      if (sourceSq && targetSq) {\n        setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n          transform: `translate(${targetSq.x - sourceSq.x}px, ${targetSq.y - sourceSq.y}px)`,\n          transition: `transform ${animationDuration}ms`,\n          zIndex: 6\n        }));\n      }\n    }\n  }, [positionDifferences]); // translate to their own positions (repaint on undo)\n\n  useEffect(() => {\n    const {\n      sourceSq\n    } = getSingleSquareCoordinates(square);\n\n    if (sourceSq) {\n      setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n        transform: `translate(${0}px, ${0}px)`,\n        transition: `transform ${0}ms`\n      }));\n    }\n  }, [currentPosition]); // update is piece draggable\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      cursor: arePiecesDraggable && isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }) ? '-webkit-grab' : 'default'\n    }));\n  }, [square, currentPosition, arePiecesDraggable]);\n\n  function getSingleSquareCoordinates(square) {\n    return {\n      sourceSq: squares[square]\n    };\n  }\n\n  function getSquareCoordinates(sourceSquare, targetSquare) {\n    return {\n      sourceSq: squares[sourceSquare],\n      targetSq: squares[targetSquare]\n    };\n  }\n\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: arePiecesDraggable ? canDrag ? drag : null : null,\n    onClick: () => onPieceClick(piece),\n    style: pieceStyle,\n    children: typeof chessPieces[piece] === 'function' ? chessPieces[piece]({\n      squareWidth: boardWidth / 8,\n      isDragging,\n      droppedPiece: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.piece,\n      targetSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.target,\n      sourceSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.source\n    }) : /*#__PURE__*/jsx(\"svg\", {\n      viewBox: '1 1 43 43',\n      width: boardWidth / 8,\n      height: boardWidth / 8,\n      children: /*#__PURE__*/jsx(\"g\", {\n        children: chessPieces[piece]\n      })\n    })\n  });\n}\n\nfunction Square({\n  square,\n  squareColor,\n  setSquares,\n  squareHasPremove,\n  children\n}) {\n  const squareRef = useRef();\n  const {\n    boardWidth,\n    boardOrientation,\n    clearArrows,\n    currentPosition,\n    customBoardStyle,\n    customDarkSquareStyle,\n    customDropSquareStyle,\n    customLightSquareStyle,\n    customPremoveDarkSquareStyle,\n    customPremoveLightSquareStyle,\n    customSquareStyles,\n    handleSetPosition,\n    lastPieceColour,\n    onDragOverSquare,\n    onMouseOutSquare,\n    onMouseOverSquare,\n    onPieceDrop,\n    onRightClickDown,\n    onRightClickUp,\n    onSquareClick,\n    waitingForAnimation\n  } = useChessboard();\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: 'piece',\n    drop: item => handleSetPosition(item.square, square, item.piece),\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }), [square, currentPosition, onPieceDrop, waitingForAnimation, lastPieceColour]);\n  useEffect(() => {\n    const {\n      x,\n      y\n    } = squareRef.current.getBoundingClientRect();\n    setSquares(oldSquares => ({ ...oldSquares,\n      [square]: {\n        x,\n        y\n      }\n    }));\n  }, [boardWidth, boardOrientation]);\n  const defaultSquareStyle = { ...borderRadius(customBoardStyle, square, boardOrientation),\n    ...(squareColor === 'black' ? customDarkSquareStyle : customLightSquareStyle),\n    ...(squareHasPremove && (squareColor === 'black' ? customPremoveDarkSquareStyle : customPremoveLightSquareStyle)),\n    ...(isOver && customDropSquareStyle)\n  };\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: drop,\n    style: defaultSquareStyle,\n    \"data-square-color\": squareColor,\n    \"data-square\": square,\n    onMouseOver: e => {\n      // noop if moving from child of square into square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOverSquare(square);\n    },\n    onMouseOut: e => {\n      // noop if moving from square into a child of square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOutSquare(square);\n    },\n    onMouseDown: e => {\n      if (e.button === 2) onRightClickDown(square);\n    },\n    onMouseUp: e => {\n      if (e.button === 2) onRightClickUp(square);\n    },\n    onDragEnter: () => onDragOverSquare(square),\n    onClick: () => {\n      onSquareClick(square);\n      clearArrows();\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n    },\n    children: /*#__PURE__*/jsx(\"div\", {\n      ref: squareRef,\n      style: { ...size(boardWidth),\n        ...center,\n        ...(!squareHasPremove && (customSquareStyles === null || customSquareStyles === void 0 ? void 0 : customSquareStyles[square]))\n      },\n      children: children\n    })\n  });\n}\nconst center = {\n  display: 'flex',\n  justifyContent: 'center'\n};\n\nconst size = width => ({\n  width: width / 8,\n  height: width / 8\n});\n\nconst borderRadius = (customBoardStyle, square, boardOrientation) => {\n  if (!customBoardStyle.borderRadius) return {};\n\n  if (square === 'a1') {\n    return boardOrientation === 'white' ? {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'a8') {\n    return boardOrientation === 'white' ? {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h1') {\n    return boardOrientation === 'white' ? {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h8') {\n    return boardOrientation === 'white' ? {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  return {};\n};\n\nfunction Squares({\n  children\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customBoardStyle,\n    id\n  } = useChessboard();\n  return /*#__PURE__*/jsx(\"div\", {\n    \"data-boardid\": id,\n    style: { ...boardStyles(boardWidth),\n      ...customBoardStyle\n    },\n    children: [...Array(8)].map((_, r) => {\n      return /*#__PURE__*/jsx(\"div\", {\n        style: rowStyles(boardWidth),\n        children: [...Array(8)].map((_, c) => {\n          // a1, a2 ...\n          const square = boardOrientation === 'black' ? COLUMNS[7 - c] + (r + 1) : COLUMNS[c] + (8 - r);\n          const squareColor = c % 2 === r % 2 ? 'white' : 'black';\n          return children({\n            square,\n            squareColor,\n            col: c,\n            row: r\n          });\n        })\n      }, r.toString());\n    })\n  });\n}\n\nconst boardStyles = width => ({\n  cursor: 'default',\n  height: width,\n  width\n});\n\nconst rowStyles = width => ({\n  display: 'flex',\n  flexWrap: 'nowrap',\n  width\n});\n\nconst errorImage = {\n  whiteKing: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    style: {\n      shapeRendering: 'geometricPrecision',\n      textRendering: 'geometricPrecision',\n      imageRendering: 'optimizeQuality'\n    },\n    viewBox: \"0 0 4210 12970\",\n    x: \"0px\",\n    y: \"0px\",\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    width: \"250\",\n    height: \"250\",\n    children: /*#__PURE__*/jsx(\"g\", {\n      children: /*#__PURE__*/jsx(\"path\", {\n        style: {\n          fill: 'black',\n          fillRule: 'nonzero'\n        },\n        d: \"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z\"\n      })\n    })\n  })\n};\n\nfunction ErrorBoundary({\n  children\n}) {\n  try {\n    return children;\n  } catch (error) {\n    return /*#__PURE__*/jsx(WhiteKing, {\n      showError: true\n    });\n  }\n}\nfunction WhiteKing({\n  showError = false\n}) {\n  return /*#__PURE__*/jsxs(\"div\", {\n    style: container,\n    children: [/*#__PURE__*/jsx(\"div\", {\n      style: whiteKingStyle,\n      children: errorImage.whiteKing\n    }), showError && /*#__PURE__*/jsx(\"h1\", {\n      children: \"Something went wrong\"\n    })]\n  });\n}\nconst container = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  flexDirection: 'column'\n};\nconst whiteKingStyle = {\n  width: 250,\n  height: 250,\n  transform: 'rotate(90deg)'\n};\n\nfunction Board() {\n  const boardRef = useRef();\n  const [squares, setSquares] = useState({});\n  const {\n    arrows,\n    boardOrientation,\n    boardWidth,\n    clearCurrentRightClickDown,\n    customArrowColor,\n    showBoardNotation,\n    currentPosition,\n    premoves\n  } = useChessboard();\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (boardRef.current && !boardRef.current.contains(event.target)) {\n        clearCurrentRightClickDown();\n      }\n    }\n\n    document.addEventListener('mouseup', handleClickOutside);\n    return () => {\n      document.removeEventListener('mouseup', handleClickOutside);\n    };\n  }, []);\n  return boardWidth ? /*#__PURE__*/jsxs(\"div\", {\n    ref: boardRef,\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/jsx(Squares, {\n      children: ({\n        square,\n        squareColor,\n        col,\n        row\n      }) => {\n        const squareHasPremove = premoves.find(p => p.sourceSq === square || p.targetSq === square);\n        const squareHasPremoveTarget = premoves.find(p => p.targetSq === square);\n        return /*#__PURE__*/jsxs(Square, {\n          square: square,\n          squareColor: squareColor,\n          setSquares: setSquares,\n          squareHasPremove: squareHasPremove,\n          children: [currentPosition[square] && /*#__PURE__*/jsx(Piece, {\n            piece: currentPosition[square],\n            square: square,\n            squares: squares\n          }), squareHasPremoveTarget && /*#__PURE__*/jsx(Piece, {\n            isPremovedPiece: true,\n            piece: squareHasPremoveTarget.piece,\n            square: square,\n            squares: squares\n          }), showBoardNotation && /*#__PURE__*/jsx(Notation, {\n            row: row,\n            col: col\n          })]\n        }, `${col}${row}`);\n      }\n    }), /*#__PURE__*/jsx(\"svg\", {\n      width: boardWidth,\n      height: boardWidth,\n      style: {\n        position: 'absolute',\n        top: '0',\n        left: '0',\n        pointerEvents: 'none',\n        zIndex: '10'\n      },\n      children: arrows.map(arrow => {\n        const from = getRelativeCoords(boardOrientation, boardWidth, arrow[0]);\n        const to = getRelativeCoords(boardOrientation, boardWidth, arrow[1]);\n        return /*#__PURE__*/jsxs(Fragment$1, {\n          children: [/*#__PURE__*/jsx(\"defs\", {\n            children: /*#__PURE__*/jsx(\"marker\", {\n              id: \"arrowhead\",\n              markerWidth: \"2\",\n              markerHeight: \"2.5\",\n              refX: \"1.25\",\n              refY: \"1.25\",\n              orient: \"auto\",\n              children: /*#__PURE__*/jsx(\"polygon\", {\n                points: \"0 0, 2 1.25, 0 2.5\",\n                style: {\n                  fill: customArrowColor\n                }\n              })\n            })\n          }), /*#__PURE__*/jsx(\"line\", {\n            x1: from.x,\n            y1: from.y,\n            x2: to.x,\n            y2: to.y,\n            style: {\n              stroke: customArrowColor,\n              strokeWidth: boardWidth / 36\n            },\n            markerEnd: \"url(#arrowhead)\"\n          })]\n        }, `${arrow[0]}-${arrow[1]}`);\n      })\n    })]\n  }) : /*#__PURE__*/jsx(WhiteKing, {});\n}\n\nfunction CustomDragLayer() {\n  const {\n    boardWidth,\n    chessPieces,\n    id,\n    snapToCursor\n  } = useChessboard();\n  const collectedProps = useDragLayer(monitor => ({\n    item: monitor.getItem(),\n    clientOffset: monitor.getClientOffset(),\n    sourceClientOffset: monitor.getSourceClientOffset(),\n    isDragging: monitor.isDragging()\n  }));\n  const {\n    isDragging,\n    item,\n    clientOffset,\n    sourceClientOffset\n  } = collectedProps;\n  const layerStyles = {\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: 10,\n    left: 0,\n    top: 0\n  };\n  const getItemStyle = useCallback((clientOffset, sourceClientOffset) => {\n    if (!clientOffset || !sourceClientOffset) return {\n      display: 'none'\n    };\n    let {\n      x,\n      y\n    } = snapToCursor ? clientOffset : sourceClientOffset;\n\n    if (snapToCursor) {\n      const halfSquareWidth = boardWidth / 8 / 2;\n      x -= halfSquareWidth;\n      y -= halfSquareWidth;\n    }\n\n    const transform = `translate(${x}px, ${y}px)`;\n    return {\n      transform,\n      WebkitTransform: transform,\n      touchAction: 'none'\n    };\n  }, [boardWidth, snapToCursor]);\n  return isDragging && item.id === id ? /*#__PURE__*/jsx(\"div\", {\n    style: layerStyles,\n    children: /*#__PURE__*/jsx(\"div\", {\n      style: getItemStyle(clientOffset, sourceClientOffset),\n      children: typeof chessPieces[item.piece] === 'function' ? chessPieces[item.piece]({\n        squareWidth: boardWidth / 8,\n        isDragging: true\n      }) : /*#__PURE__*/jsx(\"svg\", {\n        viewBox: '1 1 43 43',\n        width: boardWidth / 8,\n        height: boardWidth / 8,\n        children: /*#__PURE__*/jsx(\"g\", {\n          children: chessPieces[item.piece]\n        })\n      })\n    })\n  }) : null;\n}\n\nconst Chessboard = /*#__PURE__*/forwardRef((props, ref) => {\n  const [clientWindow, setClientWindow] = useState();\n  const [backendSet, setBackendSet] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const {\n    customDndBackend,\n    customDndBackendOptions,\n    ...otherProps\n  } = props;\n  useEffect(() => {\n    setIsMobile('ontouchstart' in window);\n    setBackendSet(true);\n    setClientWindow(window);\n  }, []);\n  const backend = customDndBackend || (isMobile ? TouchBackend : HTML5Backend);\n  return backendSet && clientWindow && /*#__PURE__*/jsx(ErrorBoundary, {\n    children: /*#__PURE__*/jsx(DndProvider, {\n      backend: backend,\n      context: clientWindow,\n      children: /*#__PURE__*/jsxs(ChessboardProvider, {\n        ref: ref,\n        ...otherProps,\n        children: [/*#__PURE__*/jsx(CustomDragLayer, {}), /*#__PURE__*/jsx(Board, {})]\n      })\n    })\n  });\n});\nChessboard.defaultProps = chessboardDefaultProps;\n\nexport { Chessboard };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}